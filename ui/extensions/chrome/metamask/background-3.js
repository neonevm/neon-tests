LavaPack.loadBundle([[2352,{"./keys":2353,"./utf8":2354,after:1676,"arraybuffer.slice":1682,"base64-arraybuffer":1953,blob:2036,"has-binary2":4355},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=e("./keys"),s=e("has-binary2"),o=e("arraybuffer.slice"),a=e("after"),u=e("./utf8");"undefined"!=typeof ArrayBuffer&&(n=e("base64-arraybuffer"));var c="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),h="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=c||h;r.protocol=3;var f=r.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=i(f),p={type:"error",data:"parser error"},m=e("blob");function g(e,t,r){for(var n=new Array(e.length),i=a(e.length,r),s=function(e,r,i){t(r,(function(t,r){n[e]=r,i(t,n)}))},o=0;o<e.length;o++)s(o,e[o],i)}r.encodePacket=function(e,t,n,i){"function"==typeof t&&(i=t,t=!1),"function"==typeof n&&(i=n,n=null);var s=e.data===undefined?undefined:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&s instanceof ArrayBuffer)return function(e,t,n){if(!t)return r.encodeBase64Packet(e,n);var i=e.data,s=new Uint8Array(i),o=new Uint8Array(1+i.byteLength);o[0]=f[e.type];for(var a=0;a<s.length;a++)o[a+1]=s[a];return n(o.buffer)}(e,t,i);if(void 0!==m&&s instanceof m)return function(e,t,n){if(!t)return r.encodeBase64Packet(e,n);if(l)return function(e,t,n){if(!t)return r.encodeBase64Packet(e,n);var i=new FileReader;return i.onload=function(){r.encodePacket({type:e.type,data:i.result},t,!0,n)},i.readAsArrayBuffer(e.data)}(e,t,n);var i=new Uint8Array(1);i[0]=f[e.type];var s=new m([i.buffer,e.data]);return n(s)}(e,t,i);if(s&&s.base64)return function(e,t){var n="b"+r.packets[e.type]+e.data.data;return t(n)}(e,i);var o=f[e.type];return undefined!==e.data&&(o+=n?u.encode(String(e.data),{strict:!1}):String(e.data)),i(""+o)},r.encodeBase64Packet=function(e,t){var n,i="b"+r.packets[e.type];if(void 0!==m&&e.data instanceof m){var s=new FileReader;return s.onload=function(){var e=s.result.split(",")[1];t(i+e)},s.readAsDataURL(e.data)}try{n=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var o=new Uint8Array(e.data),a=new Array(o.length),u=0;u<o.length;u++)a[u]=o[u];n=String.fromCharCode.apply(null,a)}return i+=btoa(n),t(i)},r.decodePacket=function(e,t,n){if(e===undefined)return p;if("string"==typeof e){if("b"===e.charAt(0))return r.decodeBase64Packet(e.substr(1),t);if(n&&!1===(e=function(e){try{e=u.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return p;var i=e.charAt(0);return Number(i)==i&&d[i]?e.length>1?{type:d[i],data:e.substring(1)}:{type:d[i]}:p}i=new Uint8Array(e)[0];var s=o(e,1);return m&&"blob"===t&&(s=new m([s])),{type:d[i],data:s}},r.decodeBase64Packet=function(e,t){var r=d[e.charAt(0)];if(!n)return{type:r,data:{base64:!0,data:e.substr(1)}};var i=n.decode(e.substr(1));return"blob"===t&&m&&(i=new m([i])),{type:r,data:i}},r.encodePayload=function(e,t,n){"function"==typeof t&&(n=t,t=null);var i=s(e);if(t&&i)return m&&!l?r.encodePayloadAsBlob(e,n):r.encodePayloadAsArrayBuffer(e,n);if(!e.length)return n("0:");g(e,(function(e,n){r.encodePacket(e,!!i&&t,!1,(function(e){n(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return n(t.join(""))}))},r.decodePayload=function(e,t,n){if("string"!=typeof e)return r.decodePayloadAsBinary(e,t,n);var i;if("function"==typeof t&&(n=t,t=null),""===e)return n(p,0,1);for(var s,o,a="",u=0,c=e.length;u<c;u++){var h=e.charAt(u);if(":"===h){if(""===a||a!=(s=Number(a)))return n(p,0,1);if(a!=(o=e.substr(u+1,s)).length)return n(p,0,1);if(o.length){if(i=r.decodePacket(o,t,!1),p.type===i.type&&p.data===i.data)return n(p,0,1);if(!1===n(i,u+s,c))return}u+=s,a=""}else a+=h}return""!==a?n(p,0,1):void 0},r.encodePayloadAsArrayBuffer=function(e,t){if(!e.length)return t(new ArrayBuffer(0));g(e,(function(e,t){r.encodePacket(e,!0,!0,(function(e){return t(null,e)}))}),(function(e,r){var n=r.reduce((function(e,t){var r;return e+(r="string"==typeof t?t.length:t.byteLength).toString().length+r+2}),0),i=new Uint8Array(n),s=0;return r.forEach((function(e){var t="string"==typeof e,r=e;if(t){for(var n=new Uint8Array(e.length),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);r=n.buffer}i[s++]=t?0:1;var a=r.byteLength.toString();for(o=0;o<a.length;o++)i[s++]=parseInt(a[o]);i[s++]=255;for(n=new Uint8Array(r),o=0;o<n.length;o++)i[s++]=n[o]})),t(i.buffer)}))},r.encodePayloadAsBlob=function(e,t){g(e,(function(e,t){r.encodePacket(e,!0,!0,(function(e){var r=new Uint8Array(1);if(r[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);e=n.buffer,r[0]=0}var s=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),o=new Uint8Array(s.length+1);for(i=0;i<s.length;i++)o[i]=parseInt(s[i]);if(o[s.length]=255,m){var a=new m([r.buffer,o.buffer,e]);t(null,a)}}))}),(function(e,r){return t(new m(r))}))},r.decodePayloadAsBinary=function(e,t,n){"function"==typeof t&&(n=t,t=null);for(var i=e,s=[];i.byteLength>0;){for(var a=new Uint8Array(i),u=0===a[0],c="",h=1;255!==a[h];h++){if(c.length>310)return n(p,0,1);c+=a[h]}i=o(i,2+c.length),c=parseInt(c);var l=o(i,0,c);if(u)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(e){var f=new Uint8Array(l);l="";for(h=0;h<f.length;h++)l+=String.fromCharCode(f[h])}s.push(l),i=o(i,c)}var d=s.length;s.forEach((function(e,i){n(r.decodePacket(e,t,!0),i,d)}))}}}},{package:"engine.io-parser",file:"/home/gudahtt/projects/metamask-extension/node_modules/engine.io-parser/lib/browser.js"}],[2353,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=Object.keys||function(e){var t=[],r=Object.prototype.hasOwnProperty;for(var n in e)r.call(e,n)&&t.push(n);return t}}}},{package:"engine.io-parser",file:"/home/gudahtt/projects/metamask-extension/node_modules/engine.io-parser/lib/keys.js"}],[2354,{},function(){with(this)return function(){"use strict";return function(e,t,r){
/*! https://mths.be/utf8js v2.1.2 by @mathias */
var n,i,s,o=String.fromCharCode;function a(e){for(var t,r,n=[],i=0,s=e.length;i<s;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<s?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function u(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(e,t){return o(e>>t&63|128)}function h(e,t){if(0==(4294967168&e))return o(e);var r="";return 0==(4294965248&e)?r=o(e>>6&31|192):0==(4294901760&e)?(u(e,t)||(e=65533),r=o(e>>12&15|224),r+=c(e,6)):0==(4292870144&e)&&(r=o(e>>18&7|240),r+=c(e,12),r+=c(e,6)),r+=o(63&e|128)}function l(){if(s>=i)throw Error("Invalid byte index");var e=255&n[s];if(s++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function f(e){var t,r;if(s>i)throw Error("Invalid byte index");if(s==i)return!1;if(t=255&n[s],s++,0==(128&t))return t;if(192==(224&t)){if((r=(31&t)<<6|l())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if((r=(15&t)<<12|l()<<6|l())>=2048)return u(r,e)?r:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(r=(7&t)<<18|l()<<12|l()<<6|l())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}t.exports={version:"2.1.2",encode:function(e,t){for(var r=!1!==(t=t||{}).strict,n=a(e),i=n.length,s=-1,o="";++s<i;)o+=h(n[s],r);return o},decode:function(e,t){var r=!1!==(t=t||{}).strict;n=a(e),i=n.length,s=0;for(var u,c=[];!1!==(u=f(r));)c.push(u);return function(e){for(var t,r=e.length,n=-1,i="";++n<r;)(t=e[n])>65535&&(i+=o((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=o(t);return i}(c)}}}}},{package:"engine.io-parser",file:"/home/gudahtt/projects/metamask-extension/node_modules/engine.io-parser/lib/utf8.js"}],[2355,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n,i=e instanceof Error?e:new Error(e);if("object"==typeof t?r=t:null!=t&&(i.code=t),r)for(n in r)i[n]=r[n];return i}}}},{package:"err-code",file:"/home/gudahtt/projects/metamask-extension/node_modules/err-code/index.js"}],[2356,{prr:5441},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("prr");function i(e,t,r){t&&"string"!=typeof t&&(t=t.message||t.name),n(this,{type:e,name:e,cause:"string"!=typeof t?t:r,message:t},"ewr")}function s(e,t){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),i.call(this,"CustomError",e,t)}s.prototype=new Error,t.exports=function(e){var t=function(t,r){return function(e,t,r){var n=function(r,s){i.call(this,t,r,s),"FilesystemError"==t&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(e.errno[this.cause.errno]?e.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,n)};return n.prototype=r?new r:new s,n}(e,t,r)};return{CustomError:s,FilesystemError:t("FilesystemError"),createError:t}}}}},{package:"errno",file:"/home/gudahtt/projects/metamask-extension/node_modules/errno/custom.js"}],[2357,{"./custom":2356},function(){with(this)return function(){"use strict";return function(e,t,r){var n=t.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];t.exports.errno={},t.exports.code={},n.forEach((function(e){t.exports.errno[e.errno]=e,t.exports.code[e.code]=e})),t.exports.custom=e("./custom")(t.exports),t.exports.create=t.exports.custom.createError}}},{package:"errno",file:"/home/gudahtt/projects/metamask-extension/node_modules/errno/errno.js"}],[2358,{"@metamask/safe-event-emitter":1315},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseBlockTracker=void 0;const i=n(e("@metamask/safe-event-emitter")),s=(e,t)=>e+t,o=["sync","latest"];class a extends i.default{constructor(e={}){super(),this._blockResetDuration=e.blockResetDuration||2e4,this._currentBlock=null,this._isRunning=!1,this._onNewListener=this._onNewListener.bind(this),this._onRemoveListener=this._onRemoveListener.bind(this),this._resetCurrentBlock=this._resetCurrentBlock.bind(this),this._setupInternalEvents()}isRunning(){return this._isRunning}getCurrentBlock(){return this._currentBlock}async getLatestBlock(){if(this._currentBlock)return this._currentBlock;return await new Promise((e=>this.once("latest",e)))}removeAllListeners(e){return e?super.removeAllListeners(e):super.removeAllListeners(),this._setupInternalEvents(),this._onRemoveListener(),this}_start(){}_end(){}_setupInternalEvents(){this.removeListener("newListener",this._onNewListener),this.removeListener("removeListener",this._onRemoveListener),this.on("newListener",this._onNewListener),this.on("removeListener",this._onRemoveListener)}_onNewListener(e){o.includes(e)&&this._maybeStart()}_onRemoveListener(){this._getBlockTrackerEventCount()>0||this._maybeEnd()}_maybeStart(){this._isRunning||(this._isRunning=!0,this._cancelBlockResetTimeout(),this._start())}_maybeEnd(){this._isRunning&&(this._isRunning=!1,this._setupBlockResetTimeout(),this._end())}_getBlockTrackerEventCount(){return o.map((e=>this.listenerCount(e))).reduce(s)}_newPotentialLatest(e){const t=this._currentBlock;t&&u(e)<=u(t)||this._setCurrentBlock(e)}_setCurrentBlock(e){const t=this._currentBlock;this._currentBlock=e,this.emit("latest",e),this.emit("sync",{oldBlock:t,newBlock:e})}_setupBlockResetTimeout(){this._cancelBlockResetTimeout(),this._blockResetTimeout=setTimeout(this._resetCurrentBlock,this._blockResetDuration),this._blockResetTimeout.unref&&this._blockResetTimeout.unref()}_cancelBlockResetTimeout(){this._blockResetTimeout&&clearTimeout(this._blockResetTimeout)}_resetCurrentBlock(){this._currentBlock=null}}function u(e){return Number.parseInt(e,16)}r.BaseBlockTracker=a}}},{package:"eth-block-tracker",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-block-tracker/dist/BaseBlockTracker.js"}],[2359,{"./BaseBlockTracker":2358,"json-rpc-random-id":4730,pify:2362},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.PollingBlockTracker=void 0;const i=n(e("json-rpc-random-id")),s=n(e("pify")),o=e("./BaseBlockTracker"),a=i.default();class u extends o.BaseBlockTracker{constructor(e={}){if(!e.provider)throw new Error("PollingBlockTracker - no provider specified.");super({blockResetDuration:e.pollingInterval}),this._provider=e.provider,this._pollingInterval=e.pollingInterval||2e4,this._retryTimeout=e.retryTimeout||this._pollingInterval/10,this._keepEventLoopActive=e.keepEventLoopActive===undefined||e.keepEventLoopActive,this._setSkipCacheFlag=e.setSkipCacheFlag||!1}async checkForLatestBlock(){return await this._updateLatestBlock(),await this.getLatestBlock()}_start(){this._synchronize().catch((e=>this.emit("error",e)))}async _synchronize(){for(;this._isRunning;)try{await this._updateLatestBlock(),await c(this._pollingInterval,!this._keepEventLoopActive)}catch(e){const t=new Error(`PollingBlockTracker - encountered an error while attempting to update latest block:\n${e.stack}`);try{this.emit("error",t)}catch(e){console.error(t)}await c(this._retryTimeout,!this._keepEventLoopActive)}}async _updateLatestBlock(){const e=await this._fetchLatestBlock();this._newPotentialLatest(e)}async _fetchLatestBlock(){const e={jsonrpc:"2.0",id:a(),method:"eth_blockNumber",params:[]};this._setSkipCacheFlag&&(e.skipCache=!0);const t=await s.default((t=>this._provider.sendAsync(e,t)))();if(t.error)throw new Error(`PollingBlockTracker - encountered error fetching block:\n${t.error}`);return t.result}}function c(e,t){return new Promise((r=>{const n=setTimeout(r,e);n.unref&&t&&n.unref()}))}r.PollingBlockTracker=u}}},{package:"eth-block-tracker",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-block-tracker/dist/PollingBlockTracker.js"}],[236,{multihashes:231},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multihashes"),i={checkCIDComponents:function(e){if(null==e)return"null values are not valid CIDs";if(0!==e.version&&1!==e.version)return"Invalid version, must be a number equal to 1 or 0";if("string"!=typeof e.codec)return"codec must be string";if(0===e.version){if("dag-pb"!==e.codec)return"codec must be 'dag-pb' for CIDv0";if("base58btc"!==e.multibaseName)return"multibaseName must be 'base58btc' for CIDv0"}if(!(e.multihash instanceof Uint8Array))return"multihash must be a Uint8Array";try{n.validate(e.multihash)}catch(e){let t=e.message;return t||(t="Multihash validation failed"),t}}};t.exports=i}}},{package:"cids",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/cids/src/cid-util.js"}],[2360,{"./BaseBlockTracker":2358,"json-rpc-random-id":4730},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.SubscribeBlockTracker=void 0;const i=n(e("json-rpc-random-id")),s=e("./BaseBlockTracker"),o=i.default();class a extends s.BaseBlockTracker{constructor(e={}){if(!e.provider)throw new Error("SubscribeBlockTracker - no provider specified.");super(e),this._provider=e.provider,this._subscriptionId=null}async checkForLatestBlock(){return await this.getLatestBlock()}async _start(){if(this._subscriptionId===undefined||null===this._subscriptionId)try{const e=await this._call("eth_blockNumber");this._subscriptionId=await this._call("eth_subscribe","newHeads",{}),this._provider.on("data",this._handleSubData.bind(this)),this._newPotentialLatest(e)}catch(e){this.emit("error",e)}}async _end(){if(null!==this._subscriptionId&&this._subscriptionId!==undefined)try{await this._call("eth_unsubscribe",this._subscriptionId),this._subscriptionId=null}catch(e){this.emit("error",e)}}_call(e,...t){return new Promise(((r,n)=>{this._provider.sendAsync({id:o(),method:e,params:t,jsonrpc:"2.0"},((e,t)=>{e?n(e):r(t.result)}))}))}_handleSubData(e,t){var r;"eth_subscription"===t.method&&(null===(r=t.params)||void 0===r?void 0:r.subscription)===this._subscriptionId&&this._newPotentialLatest(t.params.result.number)}}r.SubscribeBlockTracker=a}}},{package:"eth-block-tracker",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-block-tracker/dist/SubscribeBlockTracker.js"}],[2361,{"./BaseBlockTracker":2358,"./PollingBlockTracker":2359,"./SubscribeBlockTracker":2360},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./BaseBlockTracker"),r),i(e("./PollingBlockTracker"),r),i(e("./SubscribeBlockTracker"),r)}}},{package:"eth-block-tracker",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-block-tracker/dist/index.js"}],[2362,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=(e,t)=>function(){const r=t.promiseModule,n=new Array(arguments.length);for(let e=0;e<arguments.length;e++)n[e]=arguments[e];return new r(((r,i)=>{t.errorFirst?n.push((function(e,n){if(t.multiArgs){const t=new Array(arguments.length-1);for(let e=1;e<arguments.length;e++)t[e-1]=arguments[e];e?(t.unshift(e),i(t)):r(t)}else e?i(e):r(n)})):n.push((function(e){if(t.multiArgs){const e=new Array(arguments.length-1);for(let t=0;t<arguments.length;t++)e[t]=arguments[t];r(e)}else r(e)})),e.apply(this,n)}))};t.exports=(e,t)=>{t=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},t);const r=e=>{const r=t=>"string"==typeof t?e===t:t.test(e);return t.include?t.include.some(r):!t.exclude.some(r)};let i;i="function"==typeof e?function(){return t.excludeMain?e.apply(this,arguments):n(e,t).apply(this,arguments)}:Object.create(Object.getPrototypeOf(e));for(const s in e){const o=e[s];i[s]="function"==typeof o&&r(s)?n(o,t):o}return i}}}},{package:"pify",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-block-tracker/node_modules/pify/index.js"}],[2363,{"./util":2367,"bn.js":2365,"buffer/":2366},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./util"),i=e("bn.js"),s=e("buffer/").Buffer;function o(e){return e.startsWith("int[")?"int256"+e.slice(3):"int"===e?"int256":e.startsWith("uint[")?"uint256"+e.slice(4):"uint"===e?"uint256":e.startsWith("fixed[")?"fixed128x128"+e.slice(5):"fixed"===e?"fixed128x128":e.startsWith("ufixed[")?"ufixed128x128"+e.slice(6):"ufixed"===e?"ufixed128x128":e}function a(e){return parseInt(/^\D+(\d+)$/.exec(e)[1],10)}function u(e){var t=/^\D+(\d+)x(\d+)$/.exec(e);return[parseInt(t[1],10),parseInt(t[2],10)]}function c(e){var t=e.match(/(.*)\[(.*?)\]$/);return t?""===t[2]?"dynamic":parseInt(t[2],10):null}function h(e){var t=typeof e;if("string"===t)return n.isHexString(e)?new i(n.stripHexPrefix(e),16):new i(e,10);if("number"===t)return new i(e);if(e.toArray)return e;throw new Error("Argument is not a number")}function l(e,t){var r,o,f,d;if("address"===e)return l("uint160",h(t));if("bool"===e)return l("uint8",t?1:0);if("string"===e)return l("bytes",new s(t,"utf8"));if(function(e){return e.lastIndexOf("]")===e.length-1}(e)){if(void 0===t.length)throw new Error("Not an array?");if("dynamic"!==(r=c(e))&&0!==r&&t.length>r)throw new Error("Elements exceed array size: "+r);for(d in f=[],e=e.slice(0,e.lastIndexOf("[")),"string"==typeof t&&(t=JSON.parse(t)),t)f.push(l(e,t[d]));if("dynamic"===r){var p=l("uint256",t.length);f.unshift(p)}return s.concat(f)}if("bytes"===e)return t=new s(t),f=s.concat([l("uint256",t.length),t]),t.length%32!=0&&(f=s.concat([f,n.zeros(32-t.length%32)])),f;if(e.startsWith("bytes")){if((r=a(e))<1||r>32)throw new Error("Invalid bytes<N> width: "+r);return n.setLengthRight(t,32)}if(e.startsWith("uint")){if((r=a(e))%8||r<8||r>256)throw new Error("Invalid uint<N> width: "+r);if((o=h(t)).bitLength()>r)throw new Error("Supplied uint exceeds width: "+r+" vs "+o.bitLength());if(o<0)throw new Error("Supplied uint is negative");return o.toArrayLike(s,"be",32)}if(e.startsWith("int")){if((r=a(e))%8||r<8||r>256)throw new Error("Invalid int<N> width: "+r);if((o=h(t)).bitLength()>r)throw new Error("Supplied int exceeds width: "+r+" vs "+o.bitLength());return o.toTwos(256).toArrayLike(s,"be",32)}if(e.startsWith("ufixed")){if(r=u(e),(o=h(t))<0)throw new Error("Supplied ufixed is negative");return l("uint256",o.mul(new i(2).pow(new i(r[1]))))}if(e.startsWith("fixed"))return r=u(e),l("int256",h(t).mul(new i(2).pow(new i(r[1]))));throw new Error("Unsupported or invalid type: "+e)}function f(e){return"string"===e||"bytes"===e||"dynamic"===c(e)}function d(e,t){if(e.length!==t.length)throw new Error("Number of types are not matching the values");for(var r,i,u=[],c=0;c<e.length;c++){var l=o(e[c]),f=t[c];if("bytes"===l)u.push(f);else if("string"===l)u.push(new s(f,"utf8"));else if("bool"===l)u.push(new s(f?"01":"00","hex"));else if("address"===l)u.push(n.setLength(f,20));else if(l.startsWith("bytes")){if((r=a(l))<1||r>32)throw new Error("Invalid bytes<N> width: "+r);u.push(n.setLengthRight(f,r))}else if(l.startsWith("uint")){if((r=a(l))%8||r<8||r>256)throw new Error("Invalid uint<N> width: "+r);if((i=h(f)).bitLength()>r)throw new Error("Supplied uint exceeds width: "+r+" vs "+i.bitLength());u.push(i.toArrayLike(s,"be",r/8))}else{if(!l.startsWith("int"))throw new Error("Unsupported or invalid type: "+l);if((r=a(l))%8||r<8||r>256)throw new Error("Invalid int<N> width: "+r);if((i=h(f)).bitLength()>r)throw new Error("Supplied int exceeds width: "+r+" vs "+i.bitLength());u.push(i.toTwos(r).toArrayLike(s,"be",r/8))}}return s.concat(u)}t.exports={rawEncode:function(e,t){var r=[],n=[],i=32*e.length;for(var a in e){var u=o(e[a]),c=l(u,t[a]);f(u)?(r.push(l("uint256",i)),n.push(c),i+=c.length):r.push(c)}return s.concat(r.concat(n))},solidityPack:d,soliditySHA3:function(e,t){return n.keccak(d(e,t))}}}}},{package:"eth-eip712-util-browser",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-eip712-util-browser/abi.js"}],[2364,{"./abi":2363,"./util":2367,"buffer/":2366},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./util"),i=e("./abi"),s=e("buffer/").Buffer,o={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},a={encodeData(e,t,r,o=!0){const a=["bytes32"],u=[this.hashType(e,r)];if(o){const c=(e,t,a)=>{if(r[t]!==undefined)return["bytes32",null==a?"0x0000000000000000000000000000000000000000000000000000000000000000":n.keccak(this.encodeData(t,a,r,o))];if(a===undefined)throw new Error(`missing value for field ${e} of type ${t}`);if("bytes"===t)return["bytes32",n.keccak(a)];if("string"===t)return"string"==typeof a&&(a=s.from(a,"utf8")),["bytes32",n.keccak(a)];if(t.lastIndexOf("]")===t.length-1){const r=t.slice(0,t.lastIndexOf("[")),s=a.map((t=>c(e,r,t)));return["bytes32",n.keccak(i.rawEncode(s.map((([e])=>e)),s.map((([,e])=>e))))]}return[t,a]};for(const n of r[e]){const[e,r]=c(n.name,n.type,t[n.name]);a.push(e),u.push(r)}}else for(const i of r[e]){let e=t[i.name];if(e!==undefined)if("bytes"===i.type)a.push("bytes32"),e=n.keccak(e),u.push(e);else if("string"===i.type)a.push("bytes32"),"string"==typeof e&&(e=s.from(e,"utf8")),e=n.keccak(e),u.push(e);else if(r[i.type]!==undefined)a.push("bytes32"),e=n.keccak(this.encodeData(i.type,e,r,o)),u.push(e);else{if(i.type.lastIndexOf("]")===i.type.length-1)throw new Error("Arrays currently unimplemented in encodeData");a.push(i.type),u.push(e)}}return i.rawEncode(a,u)},encodeType(e,t){let r="",n=this.findTypeDependencies(e,t).filter((t=>t!==e));n=[e].concat(n.sort());for(const e of n){if(!t[e])throw new Error("No type definition specified: "+e);r+=e+"("+t[e].map((({name:e,type:t})=>t+" "+e)).join(",")+")"}return r},findTypeDependencies(e,t,r=[]){if(e=e.match(/^\w*/)[0],r.includes(e)||t[e]===undefined)return r;r.push(e);for(const n of t[e])for(const e of this.findTypeDependencies(n.type,t,r))!r.includes(e)&&r.push(e);return r},hashStruct(e,t,r,i=!0){return n.keccak(this.encodeData(e,t,r,i))},hashType(e,t){return n.keccak(this.encodeType(e,t))},sanitizeData(e){const t={};for(const r in o.properties)e[r]&&(t[r]=e[r]);return t.types&&(t.types=Object.assign({EIP712Domain:[]},t.types)),t},hash(e,t=!0){const r=this.sanitizeData(e),i=[s.from("1901","hex")];return i.push(this.hashStruct("EIP712Domain",r.domain,r.types,t)),"EIP712Domain"!==r.primaryType&&i.push(this.hashStruct(r.primaryType,r.message,r.types,t)),n.keccak(s.concat(i))}};t.exports={TYPED_MESSAGE_SCHEMA:o,TypedDataUtils:a,hashForSignTypedDataLegacy:function(e){return function(e){const t=new Error("Expect argument to be non-empty array");if("object"!=typeof e||!e.length)throw t;const r=e.map((function(e){return"bytes"===e.type?n.toBuffer(e.value):e.value})),s=e.map((function(e){return e.type})),o=e.map((function(e){if(!e.name)throw t;return e.type+" "+e.name}));return i.soliditySHA3(["bytes32","bytes32"],[i.soliditySHA3(new Array(e.length).fill("string"),o),i.soliditySHA3(s,r)])}(e.data)},hashForSignTypedData_v3:function(e){return a.hash(e.data,!1)},hashForSignTypedData_v4:function(e){return a.hash(e.data)}}}}},{package:"eth-eip712-util-browser",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-eip712-util-browser/index.js"}],[2365,{buffer:2080},function(){with(this)return function(){"use strict";return function(e,t,r){!function(t,r){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function s(e,t,r){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var o;"object"==typeof t?t.exports=s:r.BN=s,s.BN=s,s.wordSize=26;try{o="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:e("buffer").Buffer}catch(e){}function a(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+e)}function u(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function c(e,t,r,i){for(var s=0,o=0,a=Math.min(e.length,r),u=t;u<a;u++){var c=e.charCodeAt(u)-48;s*=i,o=c>=49?c-49+10:c>=17?c-17+10:c,n(c>=0&&o<i,"Invalid character"),s+=o}return s}function h(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return e.cmp(t)<0?e:t},s.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},s.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},s.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,o,a=0;if("be"===r)for(i=e.length-1,s=0;i>=0;i-=3)o=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);else if("le"===r)for(i=0,s=0;i<e.length;i+=3)o=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);return this._strip()},s.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,s=0,o=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=u(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=u(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;this._strip()},s.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var s=e.length-r,o=s%n,a=Math.min(s,s-o)+r,u=0,h=r;h<a;h+=n)u=c(e,h,h+n,t),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==o){var l=1;for(u=c(e,h,e.length,t),h=0;h<o;h++)l*=t;this.imuln(l),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this._strip()},s.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype._move=function(e){h(e,this)},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=l}catch(e){s.prototype.inspect=l}else s.prototype.inspect=l;function l(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,s=0,o=0;o<this.length;o++){var a=this.words[o],u=(16777215&(a<<i|s)).toString(16);r=0!==(s=a>>>24-i&16777215)||o!==this.length-1?f[6-u.length]+u+r:u+r,(i+=2)>=26&&(i-=26,o--)}for(0!==s&&(r=s.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=d[e],h=p[e];r="";var l=this.clone();for(l.negative=0;!l.isZero();){var m=l.modrn(h).toString(e);r=(l=l.idivn(h)).isZero()?m+r:f[c-m.length]+m+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16,2)},o&&(s.prototype.toBuffer=function(e,t){return this.toArrayLike(o,e,t)}),s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)};function m(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],s=0|t.words[0],o=i*s,a=67108863&o,u=o/67108864|0;r.words[0]=a;for(var c=1;c<n;c++){for(var h=u>>>26,l=67108863&u,f=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=f;d++){var p=c-d|0;h+=(o=(i=0|e.words[p])*(s=0|t.words[d])+l)/67108864|0,l=67108863&o}r.words[c]=0|l,u=0|h}return 0!==u?r.words[c]=0|u:r.length--,r._strip()}s.prototype.toArrayLike=function(e,t,r){this._strip();var i=this.byteLength(),s=r||Math.max(1,i);n(i<=s,"byte array longer than desired length"),n(s>0,"Requested array length <= 0");var o=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,s);return this["_toArrayLike"+("le"===t?"LE":"BE")](o,i),o},s.prototype._toArrayLikeLE=function(e,t){for(var r=0,n=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|n;e[r++]=255&o,r<e.length&&(e[r++]=o>>8&255),r<e.length&&(e[r++]=o>>16&255),6===s?(r<e.length&&(e[r++]=o>>24&255),n=0,s=0):(n=o>>>24,s+=2)}if(r<e.length)for(e[r++]=n;r<e.length;)e[r++]=0},s.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,n=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|n;e[r--]=255&o,r>=0&&(e[r--]=o>>8&255),r>=0&&(e[r--]=o>>16&255),6===s?(r>=0&&(e[r--]=o>>24&255),n=0,s=0):(n=o>>>24,s+=2)}if(r>=0)for(e[r--]=n;r>=0;)e[r--]=0},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0==(8191&t)&&(r+=13,t>>>=13),0==(127&t)&&(r+=7,t>>>=7),0==(15&t)&&(r+=4,t>>>=4),0==(3&t)&&(r+=2,t>>>=2),0==(1&t)&&r++,r},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},s.prototype.ior=function(e){return n(0==(this.negative|e.negative)),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},s.prototype.iand=function(e){return n(0==(this.negative|e.negative)),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},s.prototype.ixor=function(e){return n(0==(this.negative|e.negative)),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},s.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,s=0;s<n.length;s++)t=(0|r.words[s])+(0|n.words[s])+i,this.words[s]=67108863&t,i=t>>>26;for(;0!==i&&s<r.length;s++)t=(0|r.words[s])+i,this.words[s]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var s=0,o=0;o<n.length;o++)s=(t=(0|r.words[o])-(0|n.words[o])+s)>>26,this.words[o]=67108863&t;for(;0!==s&&o<r.length;o++)s=(t=(0|r.words[o])+s)>>26,this.words[o]=67108863&t;if(0===s&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var g=function(e,t,r){var n,i,s,o=e.words,a=t.words,u=r.words,c=0,h=0|o[0],l=8191&h,f=h>>>13,d=0|o[1],p=8191&d,m=d>>>13,g=0|o[2],y=8191&g,v=g>>>13,w=0|o[3],b=8191&w,_=w>>>13,E=0|o[4],k=8191&E,A=E>>>13,T=0|o[5],S=8191&T,x=T>>>13,P=0|o[6],I=8191&P,M=P>>>13,C=0|o[7],L=8191&C,N=C>>>13,B=0|o[8],R=8191&B,O=B>>>13,j=0|o[9],D=8191&j,U=j>>>13,F=0|a[0],K=8191&F,V=F>>>13,G=0|a[1],H=8191&G,Y=G>>>13,q=0|a[2],z=8191&q,W=q>>>13,$=0|a[3],Z=8191&$,J=$>>>13,Q=0|a[4],X=8191&Q,ee=Q>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],se=8191&ie,oe=ie>>>13,ae=0|a[7],ue=8191&ae,ce=ae>>>13,he=0|a[8],le=8191&he,fe=he>>>13,de=0|a[9],pe=8191&de,me=de>>>13;r.negative=e.negative^t.negative,r.length=19;var ge=(c+(n=Math.imul(l,K))|0)+((8191&(i=(i=Math.imul(l,V))+Math.imul(f,K)|0))<<13)|0;c=((s=Math.imul(f,V))+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(p,K),i=(i=Math.imul(p,V))+Math.imul(m,K)|0,s=Math.imul(m,V);var ye=(c+(n=n+Math.imul(l,H)|0)|0)+((8191&(i=(i=i+Math.imul(l,Y)|0)+Math.imul(f,H)|0))<<13)|0;c=((s=s+Math.imul(f,Y)|0)+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(y,K),i=(i=Math.imul(y,V))+Math.imul(v,K)|0,s=Math.imul(v,V),n=n+Math.imul(p,H)|0,i=(i=i+Math.imul(p,Y)|0)+Math.imul(m,H)|0,s=s+Math.imul(m,Y)|0;var ve=(c+(n=n+Math.imul(l,z)|0)|0)+((8191&(i=(i=i+Math.imul(l,W)|0)+Math.imul(f,z)|0))<<13)|0;c=((s=s+Math.imul(f,W)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(b,K),i=(i=Math.imul(b,V))+Math.imul(_,K)|0,s=Math.imul(_,V),n=n+Math.imul(y,H)|0,i=(i=i+Math.imul(y,Y)|0)+Math.imul(v,H)|0,s=s+Math.imul(v,Y)|0,n=n+Math.imul(p,z)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(m,z)|0,s=s+Math.imul(m,W)|0;var we=(c+(n=n+Math.imul(l,Z)|0)|0)+((8191&(i=(i=i+Math.imul(l,J)|0)+Math.imul(f,Z)|0))<<13)|0;c=((s=s+Math.imul(f,J)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(k,K),i=(i=Math.imul(k,V))+Math.imul(A,K)|0,s=Math.imul(A,V),n=n+Math.imul(b,H)|0,i=(i=i+Math.imul(b,Y)|0)+Math.imul(_,H)|0,s=s+Math.imul(_,Y)|0,n=n+Math.imul(y,z)|0,i=(i=i+Math.imul(y,W)|0)+Math.imul(v,z)|0,s=s+Math.imul(v,W)|0,n=n+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,J)|0)+Math.imul(m,Z)|0,s=s+Math.imul(m,J)|0;var be=(c+(n=n+Math.imul(l,X)|0)|0)+((8191&(i=(i=i+Math.imul(l,ee)|0)+Math.imul(f,X)|0))<<13)|0;c=((s=s+Math.imul(f,ee)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(S,K),i=(i=Math.imul(S,V))+Math.imul(x,K)|0,s=Math.imul(x,V),n=n+Math.imul(k,H)|0,i=(i=i+Math.imul(k,Y)|0)+Math.imul(A,H)|0,s=s+Math.imul(A,Y)|0,n=n+Math.imul(b,z)|0,i=(i=i+Math.imul(b,W)|0)+Math.imul(_,z)|0,s=s+Math.imul(_,W)|0,n=n+Math.imul(y,Z)|0,i=(i=i+Math.imul(y,J)|0)+Math.imul(v,Z)|0,s=s+Math.imul(v,J)|0,n=n+Math.imul(p,X)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(m,X)|0,s=s+Math.imul(m,ee)|0;var _e=(c+(n=n+Math.imul(l,re)|0)|0)+((8191&(i=(i=i+Math.imul(l,ne)|0)+Math.imul(f,re)|0))<<13)|0;c=((s=s+Math.imul(f,ne)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(I,K),i=(i=Math.imul(I,V))+Math.imul(M,K)|0,s=Math.imul(M,V),n=n+Math.imul(S,H)|0,i=(i=i+Math.imul(S,Y)|0)+Math.imul(x,H)|0,s=s+Math.imul(x,Y)|0,n=n+Math.imul(k,z)|0,i=(i=i+Math.imul(k,W)|0)+Math.imul(A,z)|0,s=s+Math.imul(A,W)|0,n=n+Math.imul(b,Z)|0,i=(i=i+Math.imul(b,J)|0)+Math.imul(_,Z)|0,s=s+Math.imul(_,J)|0,n=n+Math.imul(y,X)|0,i=(i=i+Math.imul(y,ee)|0)+Math.imul(v,X)|0,s=s+Math.imul(v,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(m,re)|0,s=s+Math.imul(m,ne)|0;var Ee=(c+(n=n+Math.imul(l,se)|0)|0)+((8191&(i=(i=i+Math.imul(l,oe)|0)+Math.imul(f,se)|0))<<13)|0;c=((s=s+Math.imul(f,oe)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(L,K),i=(i=Math.imul(L,V))+Math.imul(N,K)|0,s=Math.imul(N,V),n=n+Math.imul(I,H)|0,i=(i=i+Math.imul(I,Y)|0)+Math.imul(M,H)|0,s=s+Math.imul(M,Y)|0,n=n+Math.imul(S,z)|0,i=(i=i+Math.imul(S,W)|0)+Math.imul(x,z)|0,s=s+Math.imul(x,W)|0,n=n+Math.imul(k,Z)|0,i=(i=i+Math.imul(k,J)|0)+Math.imul(A,Z)|0,s=s+Math.imul(A,J)|0,n=n+Math.imul(b,X)|0,i=(i=i+Math.imul(b,ee)|0)+Math.imul(_,X)|0,s=s+Math.imul(_,ee)|0,n=n+Math.imul(y,re)|0,i=(i=i+Math.imul(y,ne)|0)+Math.imul(v,re)|0,s=s+Math.imul(v,ne)|0,n=n+Math.imul(p,se)|0,i=(i=i+Math.imul(p,oe)|0)+Math.imul(m,se)|0,s=s+Math.imul(m,oe)|0;var ke=(c+(n=n+Math.imul(l,ue)|0)|0)+((8191&(i=(i=i+Math.imul(l,ce)|0)+Math.imul(f,ue)|0))<<13)|0;c=((s=s+Math.imul(f,ce)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(R,K),i=(i=Math.imul(R,V))+Math.imul(O,K)|0,s=Math.imul(O,V),n=n+Math.imul(L,H)|0,i=(i=i+Math.imul(L,Y)|0)+Math.imul(N,H)|0,s=s+Math.imul(N,Y)|0,n=n+Math.imul(I,z)|0,i=(i=i+Math.imul(I,W)|0)+Math.imul(M,z)|0,s=s+Math.imul(M,W)|0,n=n+Math.imul(S,Z)|0,i=(i=i+Math.imul(S,J)|0)+Math.imul(x,Z)|0,s=s+Math.imul(x,J)|0,n=n+Math.imul(k,X)|0,i=(i=i+Math.imul(k,ee)|0)+Math.imul(A,X)|0,s=s+Math.imul(A,ee)|0,n=n+Math.imul(b,re)|0,i=(i=i+Math.imul(b,ne)|0)+Math.imul(_,re)|0,s=s+Math.imul(_,ne)|0,n=n+Math.imul(y,se)|0,i=(i=i+Math.imul(y,oe)|0)+Math.imul(v,se)|0,s=s+Math.imul(v,oe)|0,n=n+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(m,ue)|0,s=s+Math.imul(m,ce)|0;var Ae=(c+(n=n+Math.imul(l,le)|0)|0)+((8191&(i=(i=i+Math.imul(l,fe)|0)+Math.imul(f,le)|0))<<13)|0;c=((s=s+Math.imul(f,fe)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(D,K),i=(i=Math.imul(D,V))+Math.imul(U,K)|0,s=Math.imul(U,V),n=n+Math.imul(R,H)|0,i=(i=i+Math.imul(R,Y)|0)+Math.imul(O,H)|0,s=s+Math.imul(O,Y)|0,n=n+Math.imul(L,z)|0,i=(i=i+Math.imul(L,W)|0)+Math.imul(N,z)|0,s=s+Math.imul(N,W)|0,n=n+Math.imul(I,Z)|0,i=(i=i+Math.imul(I,J)|0)+Math.imul(M,Z)|0,s=s+Math.imul(M,J)|0,n=n+Math.imul(S,X)|0,i=(i=i+Math.imul(S,ee)|0)+Math.imul(x,X)|0,s=s+Math.imul(x,ee)|0,n=n+Math.imul(k,re)|0,i=(i=i+Math.imul(k,ne)|0)+Math.imul(A,re)|0,s=s+Math.imul(A,ne)|0,n=n+Math.imul(b,se)|0,i=(i=i+Math.imul(b,oe)|0)+Math.imul(_,se)|0,s=s+Math.imul(_,oe)|0,n=n+Math.imul(y,ue)|0,i=(i=i+Math.imul(y,ce)|0)+Math.imul(v,ue)|0,s=s+Math.imul(v,ce)|0,n=n+Math.imul(p,le)|0,i=(i=i+Math.imul(p,fe)|0)+Math.imul(m,le)|0,s=s+Math.imul(m,fe)|0;var Te=(c+(n=n+Math.imul(l,pe)|0)|0)+((8191&(i=(i=i+Math.imul(l,me)|0)+Math.imul(f,pe)|0))<<13)|0;c=((s=s+Math.imul(f,me)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(D,H),i=(i=Math.imul(D,Y))+Math.imul(U,H)|0,s=Math.imul(U,Y),n=n+Math.imul(R,z)|0,i=(i=i+Math.imul(R,W)|0)+Math.imul(O,z)|0,s=s+Math.imul(O,W)|0,n=n+Math.imul(L,Z)|0,i=(i=i+Math.imul(L,J)|0)+Math.imul(N,Z)|0,s=s+Math.imul(N,J)|0,n=n+Math.imul(I,X)|0,i=(i=i+Math.imul(I,ee)|0)+Math.imul(M,X)|0,s=s+Math.imul(M,ee)|0,n=n+Math.imul(S,re)|0,i=(i=i+Math.imul(S,ne)|0)+Math.imul(x,re)|0,s=s+Math.imul(x,ne)|0,n=n+Math.imul(k,se)|0,i=(i=i+Math.imul(k,oe)|0)+Math.imul(A,se)|0,s=s+Math.imul(A,oe)|0,n=n+Math.imul(b,ue)|0,i=(i=i+Math.imul(b,ce)|0)+Math.imul(_,ue)|0,s=s+Math.imul(_,ce)|0,n=n+Math.imul(y,le)|0,i=(i=i+Math.imul(y,fe)|0)+Math.imul(v,le)|0,s=s+Math.imul(v,fe)|0;var Se=(c+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;c=((s=s+Math.imul(m,me)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(D,z),i=(i=Math.imul(D,W))+Math.imul(U,z)|0,s=Math.imul(U,W),n=n+Math.imul(R,Z)|0,i=(i=i+Math.imul(R,J)|0)+Math.imul(O,Z)|0,s=s+Math.imul(O,J)|0,n=n+Math.imul(L,X)|0,i=(i=i+Math.imul(L,ee)|0)+Math.imul(N,X)|0,s=s+Math.imul(N,ee)|0,n=n+Math.imul(I,re)|0,i=(i=i+Math.imul(I,ne)|0)+Math.imul(M,re)|0,s=s+Math.imul(M,ne)|0,n=n+Math.imul(S,se)|0,i=(i=i+Math.imul(S,oe)|0)+Math.imul(x,se)|0,s=s+Math.imul(x,oe)|0,n=n+Math.imul(k,ue)|0,i=(i=i+Math.imul(k,ce)|0)+Math.imul(A,ue)|0,s=s+Math.imul(A,ce)|0,n=n+Math.imul(b,le)|0,i=(i=i+Math.imul(b,fe)|0)+Math.imul(_,le)|0,s=s+Math.imul(_,fe)|0;var xe=(c+(n=n+Math.imul(y,pe)|0)|0)+((8191&(i=(i=i+Math.imul(y,me)|0)+Math.imul(v,pe)|0))<<13)|0;c=((s=s+Math.imul(v,me)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(D,Z),i=(i=Math.imul(D,J))+Math.imul(U,Z)|0,s=Math.imul(U,J),n=n+Math.imul(R,X)|0,i=(i=i+Math.imul(R,ee)|0)+Math.imul(O,X)|0,s=s+Math.imul(O,ee)|0,n=n+Math.imul(L,re)|0,i=(i=i+Math.imul(L,ne)|0)+Math.imul(N,re)|0,s=s+Math.imul(N,ne)|0,n=n+Math.imul(I,se)|0,i=(i=i+Math.imul(I,oe)|0)+Math.imul(M,se)|0,s=s+Math.imul(M,oe)|0,n=n+Math.imul(S,ue)|0,i=(i=i+Math.imul(S,ce)|0)+Math.imul(x,ue)|0,s=s+Math.imul(x,ce)|0,n=n+Math.imul(k,le)|0,i=(i=i+Math.imul(k,fe)|0)+Math.imul(A,le)|0,s=s+Math.imul(A,fe)|0;var Pe=(c+(n=n+Math.imul(b,pe)|0)|0)+((8191&(i=(i=i+Math.imul(b,me)|0)+Math.imul(_,pe)|0))<<13)|0;c=((s=s+Math.imul(_,me)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(D,X),i=(i=Math.imul(D,ee))+Math.imul(U,X)|0,s=Math.imul(U,ee),n=n+Math.imul(R,re)|0,i=(i=i+Math.imul(R,ne)|0)+Math.imul(O,re)|0,s=s+Math.imul(O,ne)|0,n=n+Math.imul(L,se)|0,i=(i=i+Math.imul(L,oe)|0)+Math.imul(N,se)|0,s=s+Math.imul(N,oe)|0,n=n+Math.imul(I,ue)|0,i=(i=i+Math.imul(I,ce)|0)+Math.imul(M,ue)|0,s=s+Math.imul(M,ce)|0,n=n+Math.imul(S,le)|0,i=(i=i+Math.imul(S,fe)|0)+Math.imul(x,le)|0,s=s+Math.imul(x,fe)|0;var Ie=(c+(n=n+Math.imul(k,pe)|0)|0)+((8191&(i=(i=i+Math.imul(k,me)|0)+Math.imul(A,pe)|0))<<13)|0;c=((s=s+Math.imul(A,me)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(D,re),i=(i=Math.imul(D,ne))+Math.imul(U,re)|0,s=Math.imul(U,ne),n=n+Math.imul(R,se)|0,i=(i=i+Math.imul(R,oe)|0)+Math.imul(O,se)|0,s=s+Math.imul(O,oe)|0,n=n+Math.imul(L,ue)|0,i=(i=i+Math.imul(L,ce)|0)+Math.imul(N,ue)|0,s=s+Math.imul(N,ce)|0,n=n+Math.imul(I,le)|0,i=(i=i+Math.imul(I,fe)|0)+Math.imul(M,le)|0,s=s+Math.imul(M,fe)|0;var Me=(c+(n=n+Math.imul(S,pe)|0)|0)+((8191&(i=(i=i+Math.imul(S,me)|0)+Math.imul(x,pe)|0))<<13)|0;c=((s=s+Math.imul(x,me)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(D,se),i=(i=Math.imul(D,oe))+Math.imul(U,se)|0,s=Math.imul(U,oe),n=n+Math.imul(R,ue)|0,i=(i=i+Math.imul(R,ce)|0)+Math.imul(O,ue)|0,s=s+Math.imul(O,ce)|0,n=n+Math.imul(L,le)|0,i=(i=i+Math.imul(L,fe)|0)+Math.imul(N,le)|0,s=s+Math.imul(N,fe)|0;var Ce=(c+(n=n+Math.imul(I,pe)|0)|0)+((8191&(i=(i=i+Math.imul(I,me)|0)+Math.imul(M,pe)|0))<<13)|0;c=((s=s+Math.imul(M,me)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(D,ue),i=(i=Math.imul(D,ce))+Math.imul(U,ue)|0,s=Math.imul(U,ce),n=n+Math.imul(R,le)|0,i=(i=i+Math.imul(R,fe)|0)+Math.imul(O,le)|0,s=s+Math.imul(O,fe)|0;var Le=(c+(n=n+Math.imul(L,pe)|0)|0)+((8191&(i=(i=i+Math.imul(L,me)|0)+Math.imul(N,pe)|0))<<13)|0;c=((s=s+Math.imul(N,me)|0)+(i>>>13)|0)+(Le>>>26)|0,Le&=67108863,n=Math.imul(D,le),i=(i=Math.imul(D,fe))+Math.imul(U,le)|0,s=Math.imul(U,fe);var Ne=(c+(n=n+Math.imul(R,pe)|0)|0)+((8191&(i=(i=i+Math.imul(R,me)|0)+Math.imul(O,pe)|0))<<13)|0;c=((s=s+Math.imul(O,me)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863;var Be=(c+(n=Math.imul(D,pe))|0)+((8191&(i=(i=Math.imul(D,me))+Math.imul(U,pe)|0))<<13)|0;return c=((s=Math.imul(U,me))+(i>>>13)|0)+(Be>>>26)|0,Be&=67108863,u[0]=ge,u[1]=ye,u[2]=ve,u[3]=we,u[4]=be,u[5]=_e,u[6]=Ee,u[7]=ke,u[8]=Ae,u[9]=Te,u[10]=Se,u[11]=xe,u[12]=Pe,u[13]=Ie,u[14]=Me,u[15]=Ce,u[16]=Le,u[17]=Ne,u[18]=Be,0!==c&&(u[19]=c,r.length++),r};function y(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,s=0;s<r.length-1;s++){var o=i;i=0;for(var a=67108863&n,u=Math.min(s,t.length-1),c=Math.max(0,s-e.length+1);c<=u;c++){var h=s-c,l=(0|e.words[h])*(0|t.words[c]),f=67108863&l;a=67108863&(f=f+a|0),i+=(o=(o=o+(l/67108864|0)|0)+(f>>>26)|0)>>>26,o&=67108863}r.words[s]=a,n=o,o=i}return 0!==n?r.words[s]=n:r.length--,r._strip()}function v(e,t,r){return y(e,t,r)}function w(e,t){this.x=e,this.y=t}Math.imul||(g=m),s.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?g(this,e,t):r<63?m(this,e,t):r<1024?y(this,e,t):v(this,e,t)},w.prototype.makeRBT=function(e){for(var t=new Array(e),r=s.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},w.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},w.prototype.permute=function(e,t,r,n,i,s){for(var o=0;o<s;o++)n[o]=t[e[o]],i[o]=r[e[o]]},w.prototype.transform=function(e,t,r,n,i,s){this.permute(s,e,t,r,n,i);for(var o=1;o<i;o<<=1)for(var a=o<<1,u=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),h=0;h<i;h+=a)for(var l=u,f=c,d=0;d<o;d++){var p=r[h+d],m=n[h+d],g=r[h+d+o],y=n[h+d+o],v=l*g-f*y;y=l*y+f*g,g=v,r[h+d]=p+g,n[h+d]=m+y,r[h+d+o]=p-g,n[h+d+o]=m-y,d!==a&&(v=u*l-c*f,f=u*f+c*l,l=v)}},w.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},w.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},w.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},w.prototype.convert13b=function(e,t,r,i){for(var s=0,o=0;o<t;o++)s+=0|e[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*t;o<i;++o)r[o]=0;n(0===s),n(0==(-8192&s))},w.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},w.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),s=this.stub(n),o=new Array(n),a=new Array(n),u=new Array(n),c=new Array(n),h=new Array(n),l=new Array(n),f=r.words;f.length=n,this.convert13b(e.words,e.length,o,n),this.convert13b(t.words,t.length,c,n),this.transform(o,s,a,u,n,i),this.transform(c,s,h,l,n,i);for(var d=0;d<n;d++){var p=a[d]*h[d]-u[d]*l[d];u[d]=a[d]*l[d]+u[d]*h[d],a[d]=p}return this.conjugate(a,u,n),this.transform(a,u,f,s,n,i),this.conjugate(f,s,n),this.normalize13b(f,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),v(this,e,t)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"==typeof e),n(e<67108864);for(var r=0,i=0;i<this.length;i++){var s=(0|this.words[i])*e,o=(67108863&s)+(67108863&r);r>>=26,r+=s/67108864|0,r+=o>>>26,this.words[i]=67108863&o}return 0!==r&&(this.words[i]=r,this.length++),t?this.ineg():this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=e.words[n]>>>i&1}return t}(e);if(0===t.length)return new s(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},s.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,s=67108863>>>26-r<<26-r;if(0!==r){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&s,u=(0|this.words[t])-a<<r;this.words[t]=u|o,o=a>>>26-r}o&&(this.words[t]=o,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},s.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var s=e%26,o=Math.min((e-s)/26,this.length),a=67108863^67108863>>>s<<s,u=r;if(i-=o,i=Math.max(0,i),u){for(var c=0;c<o;c++)u.words[c]=this.words[c];u.length=o}if(0===o);else if(this.length>o)for(this.length-=o,c=0;c<this.length;c++)this.words[c]=this.words[c+o];else this.words[0]=0,this.length=1;var h=0;for(c=this.length-1;c>=0&&(0!==h||c>=i);c--){var l=0|this.words[c];this.words[c]=h<<26-s|l>>>s,h=l&a}return u&&0!==h&&(u.words[u.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r)&&!!(this.words[r]&i)},s.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,r){var i,s,o=e.length+r;this._expand(o);var a=0;for(i=0;i<e.length;i++){s=(0|this.words[i+r])+a;var u=(0|e.words[i])*t;a=((s-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&s}for(;i<this.length-r;i++)a=(s=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&s;if(0===a)return this._strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(s=-(0|this.words[i])+a)>>26,this.words[i]=67108863&s;return this.negative=1,this._strip()},s.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,o=0|i.words[i.length-1];0!==(r=26-this._countBits(o))&&(i=i.ushln(r),n.iushln(r),o=0|i.words[i.length-1]);var a,u=n.length-i.length;if("mod"!==t){(a=new s(null)).length=u+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var h=n.clone()._ishlnsubmul(i,1,u);0===h.negative&&(n=h,a&&(a.words[u]=1));for(var l=u-1;l>=0;l--){var f=67108864*(0|n.words[i.length+l])+(0|n.words[i.length+l-1]);for(f=Math.min(f/o|0,67108863),n._ishlnsubmul(i,f,l);0!==n.negative;)f--,n.negative=0,n._ishlnsubmul(i,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=f)}return a&&a._strip(),n._strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},s.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.iadd(e)),{div:i,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):0!=(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||this.cmp(e)<0?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modrn(e.words[0]))}:this._wordDiv(e,t);var i,o,a},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),s=r.cmp(n);return s<0||1===i&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=(1<<26)%e,i=0,s=this.length-1;s>=0;s--)i=(r*i+(0|this.words[s]))%e;return t?-i:i},s.prototype.modn=function(e){return this.modrn(e)},s.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var s=(0|this.words[i])+67108864*r;this.words[i]=s/e|0,r=s%e}return this._strip(),t?this.ineg():this},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new s(1),o=new s(0),a=new s(0),u=new s(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var h=r.clone(),l=t.clone();!t.isZero();){for(var f=0,d=1;0==(t.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(t.iushrn(f);f-- >0;)(i.isOdd()||o.isOdd())&&(i.iadd(h),o.isub(l)),i.iushrn(1),o.iushrn(1);for(var p=0,m=1;0==(r.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||u.isOdd())&&(a.iadd(h),u.isub(l)),a.iushrn(1),u.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),o.isub(u)):(r.isub(t),a.isub(i),u.isub(o))}return{a:a,b:u,gcd:r.iushln(c)}},s.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,o=new s(1),a=new s(0),u=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,h=1;0==(t.words[0]&h)&&c<26;++c,h<<=1);if(c>0)for(t.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(u),o.iushrn(1);for(var l=0,f=1;0==(r.words[0]&f)&&l<26;++l,f<<=1);if(l>0)for(r.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(a)):(r.isub(t),a.isub(o))}return(i=0===t.cmpn(1)?o:a).cmpn(0)<0&&i.iadd(e),i},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var s=t;t=r,r=s}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return 0==(1&this.words[0])},s.prototype.isOdd=function(){return 1==(1&this.words[0])},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var s=i,o=r;0!==s&&o<this.length;o++){var a=0|this.words[o];s=(a+=s)>>>26,a&=67108863,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return-1===this.cmpn(e)},s.prototype.lt=function(e){return-1===this.cmp(e)},s.prototype.lten=function(e){return this.cmpn(e)<=0},s.prototype.lte=function(e){return this.cmp(e)<=0},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new S(e)},s.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var b={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function k(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function A(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function T(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function x(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new s(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):r.strip!==undefined?r.strip():r._strip(),r},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},i(E,_),E.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var s=e.words[9];for(t.words[t.length++]=s&r,i=10;i<e.length;i++){var o=0|e.words[i];e.words[i-10]=(o&r)<<4|s>>>22,s=o}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(k,_),i(A,_),i(T,_),T.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){if(b[e])return b[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new k;else if("p192"===e)t=new A;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new T}return b[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0==(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(h(e,e.umod(this.m)._forceRed(this)),e)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},S.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new s(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),o=0;!i.isZero()&&0===i.andln(1);)o++,i.iushrn(1);n(!i.isZero());var a=new s(1).toRed(this),u=a.redNeg(),c=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new s(2*h*h).toRed(this);0!==this.pow(h,c).cmp(u);)h.redIAdd(u);for(var l=this.pow(h,i),f=this.pow(e,i.addn(1).iushrn(1)),d=this.pow(e,i),p=o;0!==d.cmp(a);){for(var m=d,g=0;0!==m.cmp(a);g++)m=m.redSqr();n(g<p);var y=this.pow(l,new s(1).iushln(p-g-1));f=f.redMul(y),l=y.redSqr(),d=d.redMul(l),p=g}return f},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new s(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],o=0,a=0,u=t.bitLength()%26;for(0===u&&(u=26),n=t.length-1;n>=0;n--){for(var c=t.words[n],h=u-1;h>=0;h--){var l=c>>h&1;i!==r[0]&&(i=this.sqr(i)),0!==l||0!==o?(o<<=1,o|=l,(4===++a||0===n&&0===h)&&(i=this.mul(i,r[o]),a=0,o=0)):a=0}u=26}return i},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new x(e)},i(x,S),x.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},x.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},x.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},x.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},x.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t,this)}}},{package:"bn.js",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-eip712-util-browser/node_modules/bn.js/lib/bn.js"}],[2366,{"base64-js":1954,ieee754:4393},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("base64-js"),i=e("ieee754"),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=u,r.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},r.INSPECT_MAX_BYTES=50;const o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,u.prototype),t}function u(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return l(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|m(e,t);let n=a(r);const i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if($(e,Uint8Array)){const t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e);if($(e,ArrayBuffer)||e&&$(e.buffer,ArrayBuffer))return d(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&($(e,SharedArrayBuffer)||e&&$(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return u.from(n,t,r);const i=function(e){if(u.isBuffer(e)){const t=0|p(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}if(e.length!==undefined)return"number"!=typeof e.length||Z(e.length)?a(0):f(e);if("Buffer"===e.type&&Array.isArray(e.data))return f(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function l(e){return h(e),a(e<0?0:0|p(e))}function f(e){const t=e.length<0?0:0|p(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=t===undefined&&r===undefined?new Uint8Array(e):r===undefined?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,u.prototype),n}function p(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+o.toString(16)+" bytes");return 0|e}function m(e,t){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||$(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(e).length;default:if(i)return n?-1:q(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,r){let n=!1;if((t===undefined||t<0)&&(t=0),t>this.length)return"";if((r===undefined||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return P(this,t,r);case"latin1":case"binary":return I(this,t,r);case"base64":return T(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,i){let s,o=1,a=e.length,u=t.length;if(n!==undefined&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,u/=2,r/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let n=-1;for(s=r;s<a;s++)if(c(e,s)===c(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===u)return n*o}else-1!==n&&(s-=s-n),n=-1}else for(r+u>a&&(r=a-u),s=r;s>=0;s--){let r=!0;for(let n=0;n<u;n++)if(c(e,s+n)!==c(t,n)){r=!1;break}if(r)return s}return-1}function b(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=t.length;let o;for(n>s/2&&(n=s/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(Z(n))return o;e[r+o]=n}return o}function _(e,t,r,n){return W(q(t,e.length-r),e,r,n)}function E(e,t,r,n){return W(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function k(e,t,r,n){return W(z(t),e,r,n)}function A(e,t,r,n){return W(function(e,t){let r,n,i;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function T(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function S(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=r){let r,n,a,u;switch(o){case 1:t<128&&(s=t);break;case 2:r=e[i+1],128==(192&r)&&(u=(31&t)<<6|63&r,u>127&&(s=u));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(u=(15&t)<<12|(63&r)<<6|63&n,u>2047&&(u<55296||u>57343)&&(s=u));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(u=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,u>65535&&u<1114112&&(s=u))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return function(e){const t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=x));return r}(n)}r.kMaxLength=o,u.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){return u.isBuffer(this)?this.buffer:undefined}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){return u.isBuffer(this)?this.byteOffset:undefined}}),u.poolSize=8192,u.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,t,r){return function(e,t,r){return h(e),e<=0?a(e):t!==undefined?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},u.allocUnsafe=function(e){return l(e)},u.allocUnsafeSlow=function(e){return l(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,t){if($(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),$(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);let r;if(t===undefined)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=u.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if($(t,Uint8Array))i+t.length>n.length?(u.isBuffer(t)||(t=u.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!u.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},u.byteLength=m,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},u.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},u.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},u.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):g.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){let e="";const t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},s&&(u.prototype[s]=u.prototype.inspect),u.prototype.compare=function(e,t,r,n,i){if($(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof e);if(t===undefined&&(t=0),r===undefined&&(r=e?e.length:0),n===undefined&&(n=0),i===undefined&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0);const a=Math.min(s,o),c=this.slice(n,i),h=e.slice(t,r);for(let e=0;e<a;++e)if(c[e]!==h[e]){s=c[e],o=h[e];break}return s<o?-1:o<s?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(t===undefined)n="utf8",r=this.length,t=0;else if(r===undefined&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,n===undefined&&(n="utf8")):(n=r,r=undefined)}const i=this.length-t;if((r===undefined||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return _(this,e,t,r);case"ascii":case"latin1":case"binary":return E(this,e,t,r);case"base64":return k(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const x=4096;function P(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function I(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function M(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=J[e[n]];return i}function C(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function L(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,r,n,i,s){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function B(e,t,r,n,i){V(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function R(e,t,r,n,i){V(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function O(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,n,s){return t=+t,r>>>=0,s||O(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function D(e,t,r,n,s){return t=+t,r>>>=0,s||O(e,0,r,8),i.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=t===undefined?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,u.prototype),n},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readBigUInt64LE=Q((function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];t!==undefined&&r!==undefined||H(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),u.prototype.readBigUInt64BE=Q((function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];t!==undefined&&r!==undefined||H(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),u.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=t,i=1,s=this[e+--n];for(;n>0&&(i*=256);)s+=this[e+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},u.prototype.readInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){e>>>=0,t||L(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){e>>>=0,t||L(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readBigInt64LE=Q((function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];t!==undefined&&r!==undefined||H(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),u.prototype.readBigInt64BE=Q((function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];t!==undefined&&r!==undefined||H(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),u.prototype.readFloatLE=function(e,t){return e>>>=0,t||L(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||L(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||L(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||L(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){N(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){N(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,255,0),this[t]=255&e,t+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigUInt64LE=Q((function(e,t=0){return B(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=Q((function(e,t=0){return R(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);N(this,e,t,r,n-1,-n)}let i=0,s=1,o=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);N(this,e,t,r,n-1,-n)}let i=r-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigInt64LE=Q((function(e,t=0){return B(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=Q((function(e,t=0){return R(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return D(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return D(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),n!==undefined&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=r===undefined?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const s=u.isBuffer(e)?e:u.from(e,n),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%o]}return this};const U={};function F(e,t,r){U[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function K(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function V(e,t,r,n,i,s){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new U.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){G(t,"offset"),e[t]!==undefined&&e[t+r]!==undefined||H(t,e.length-(r+1))}(n,i,s)}function G(e,t){if("number"!=typeof e)throw new U.ERR_INVALID_ARG_TYPE(t,"number",e)}function H(e,t,r){if(Math.floor(e)!==e)throw G(e,r),new U.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new U.ERR_BUFFER_OUT_OF_BOUNDS;throw new U.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}F("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),F("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),F("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=K(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=K(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const Y=/[^+/0-9A-Za-z-_]/g;function q(e,t){let r;t=t||Infinity;const n=e.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function z(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(Y,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function $(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Z(e){return e!=e}const J=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function Q(e){return"undefined"==typeof BigInt?X:e}function X(){throw new Error("BigInt not supported")}}}},{package:"buffer",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-eip712-util-browser/node_modules/buffer/index.js"}],[2367,{"bn.js":2365,"buffer/":2366,"js-sha3":4719},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("bn.js"),i=e("buffer/").Buffer,s=e("js-sha3").keccak256;function o(e){return i.allocUnsafe(e).fill(0)}function a(e,t,r){const n=o(t);return e=u(e),r?e.length<t?(e.copy(n),n):e.slice(0,t):e.length<t?(e.copy(n,t-e.length),n):e.slice(-t)}function u(e){if(!i.isBuffer(e))if(Array.isArray(e))e=i.from(e);else if("string"==typeof e)e=c(e)?i.from((t=h(e)).length%2?"0"+t:t,"hex"):i.from(e);else if("number"==typeof e)e=intToBuffer(e);else if(null===e||e===undefined)e=i.allocUnsafe(0);else if(n.isBN(e))e=e.toArrayLike(i);else{if(!e.toArray)throw new Error("invalid type");e=i.from(e.toArray())}var t;return e}function c(e){return"string"==typeof e&&e.match(/^0x[0-9A-Fa-f]*$/)}function h(e){return"string"==typeof e&&e.startsWith("0x")?e.slice(2):e}t.exports={zeros:o,setLength:a,setLengthRight:function(e,t){return a(e,t,!0)},isHexString:c,stripHexPrefix:h,toBuffer:u,bufferToHex:function(e){return"0x"+(e=u(e)).toString("hex")},keccak:function(e){return e=u(e),i.from(s(e),"hex")}}}}},{package:"eth-eip712-util-browser",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-eip712-util-browser/util.js"}],[237,{"./cid-util":236,multibase:219,multicodec:227,multihashes:231,"uint8arrays/concat":232,"uint8arrays/equals":233,"uint8arrays/to-string":235},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multihashes"),i=e("multibase"),s=e("multicodec"),o=e("./cid-util"),a=e("uint8arrays/concat"),u=e("uint8arrays/to-string"),c=e("uint8arrays/equals"),h=s.nameToCode,l=Object.keys(h).reduce(((e,t)=>(e[h[t]]=t,e)),{}),f=Symbol.for("@ipld/js-cid/CID");class d{constructor(e,t,r,o){if(this.version,this.codec,this.multihash,Object.defineProperty(this,f,{value:!0}),d.isCID(e)){const t=e;return this.version=t.version,this.codec=t.codec,this.multihash=t.multihash,void(this.multibaseName=t.multibaseName||(0===t.version?"base58btc":"base32"))}if("string"==typeof e){const t=i.isEncoded(e);if(t){const r=i.decode(e);this.version=parseInt(r[0].toString(),16),this.codec=s.getCodec(r.slice(1)),this.multihash=s.rmPrefix(r.slice(1)),this.multibaseName=t}else this.version=0,this.codec="dag-pb",this.multihash=n.fromB58String(e),this.multibaseName="base58btc";return d.validateCID(this),void Object.defineProperty(this,"string",{value:e})}if(e instanceof Uint8Array){const t=parseInt(e[0].toString(),16);if(1===t){const r=e;this.version=t,this.codec=s.getCodec(r.slice(1)),this.multihash=s.rmPrefix(r.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=e,this.multibaseName="base58btc";d.validateCID(this)}else this.version=e,"number"==typeof t&&(t=l[t]),this.codec=t,this.multihash=r,this.multibaseName=o||(0===e?"base58btc":"base32"),d.validateCID(this)}get bytes(){let e=this._bytes;if(!e){if(0===this.version)e=this.multihash;else{if(1!==this.version)throw new Error("unsupported version");{const t=s.getCodeVarint(this.codec);e=a([[1],t,this.multihash],1+t.byteLength+this.multihash.byteLength)}}Object.defineProperty(this,"_bytes",{value:e})}return e}get prefix(){const e=s.getCodeVarint(this.codec),t=n.prefix(this.multihash);return a([[this.version],e,t],1+e.byteLength+t.byteLength)}get code(){return h[this.codec]}toV0(){if("dag-pb"!==this.codec)throw new Error("Cannot convert a non dag-pb CID to CIDv0");const{name:e,length:t}=n.decode(this.multihash);if("sha2-256"!==e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(32!==t)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new d(0,this.codec,this.multihash)}toV1(){return new d(1,this.codec,this.multihash,this.multibaseName)}toBaseEncodedString(e=this.multibaseName){if(this.string&&0!==this.string.length&&e===this.multibaseName)return this.string;let t;if(0===this.version){if("base58btc"!==e)throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");t=n.toB58String(this.multihash)}else{if(1!==this.version)throw new Error("unsupported version");t=u(i.encode(e,this.bytes))}return e===this.multibaseName&&Object.defineProperty(this,"string",{value:t}),t}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}toString(e){return this.toBaseEncodedString(e)}toJSON(){return{codec:this.codec,version:this.version,hash:this.multihash}}equals(e){return this.codec===e.codec&&this.version===e.version&&c(this.multihash,e.multihash)}static validateCID(e){const t=o.checkCIDComponents(e);if(t)throw new Error(t)}static isCID(e){return e instanceof d||Boolean(e&&e[f])}}d.codecs=h,t.exports=d}}},{package:"cids",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/cids/src/index.js"}],[238,{buffer:2081},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer");t.exports=class{constructor(e,t,r,i){this.name=e,this.code=t,this.codeBuf=n.from(this.code),this.alphabet=i,this.engine=r(i)}encode(e){return this.engine.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.engine.decode(e)}}}}},{package:"multibase",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multibase/src/base.js"}],[239,{"./base.js":238,"./rfc4648":241,"./util":242,"base-x":1950},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("base-x"),i=e("./base.js"),s=e("./rfc4648"),{decodeText:o,encodeText:a}=e("./util"),u=[["identity","\0",()=>({encode:o,decode:a}),""],["base2","0",s(1),"01"],["base8","7",s(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",s(4),"0123456789abcdef"],["base16upper","F",s(4),"0123456789ABCDEF"],["base32hex","v",s(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",s(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",s(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",s(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",s(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",s(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",s(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",s(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",s(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],c=u.reduce(((e,t)=>(e[t[0]]=new i(t[0],t[1],t[2],t[3]),e)),{}),h=u.reduce(((e,t)=>(e[t[1]]=c[t[0]],e)),{});t.exports={names:c,codes:h}}}},{package:"multibase",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multibase/src/constants.js"}],[24,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WALLET_PREFIX=r.NOTIFICATION_NAMES=r.LOG_METHOD_TYPES=r.LOG_LIMIT=r.LOG_IGNORE_METHODS=void 0;r.WALLET_PREFIX="wallet_";r.NOTIFICATION_NAMES={accountsChanged:"metamask_accountsChanged",unlockStateChanged:"metamask_unlockStateChanged",chainChanged:"metamask_chainChanged"};r.LOG_IGNORE_METHODS=["wallet_registerOnboarding","wallet_watchAsset"];r.LOG_METHOD_TYPES={restricted:"restricted",internal:"internal"};r.LOG_LIMIT=100}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/permissions/enums.js"}],[240,{"./constants":239,"./util":242,buffer:2081},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("./constants"),{decodeText:s,asBuffer:o}=e("./util");function a(e){if(i.names[e])return i.names[e];if(i.codes[e])return i.codes[e];throw new Error(`Unsupported encoding: ${e}`)}(r=t.exports=function(e,t){if(!t)throw new Error("requires an encoded buffer");const{name:r,codeBuf:i}=a(e);!function(e,t){a(e).decode(s(t))}(r,t);const o=n.alloc(i.length+t.length);return o.set(i,0),o.set(t,i.length),o}).encode=function(e,t){const r=a(e);return n.concat([r.codeBuf,n.from(r.encode(t))])},r.decode=function(e){ArrayBuffer.isView(e)&&(e=s(e));const t=e[0];["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase());const r=a(e[0]);return o(r.decode(e.substring(1)))},r.isEncoded=function(e){if(e instanceof Uint8Array&&(e=s(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(e){return!1}},r.encoding=a,r.encodingFromData=function(e){return e instanceof Uint8Array&&(e=s(e)),a(e[0])},r.names=Object.freeze(i.names),r.codes=Object.freeze(i.codes)}}},{package:"multibase",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multibase/src/index.js"}],[2401,{"./utils/cache":2412,"json-rpc-engine":4727},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockCacheMiddleware=void 0;const n=e("json-rpc-engine"),i=e("./utils/cache"),s=[undefined,null,"<nil>"];class o{constructor(){this.cache={}}getBlockCacheForPayload(e,t){const r=Number.parseInt(t,16);let n=this.cache[r];if(!n){const e={};this.cache[r]=e,n=e}return n}async get(e,t){const r=this.getBlockCacheForPayload(e,t),n=(0,i.cacheIdentifierForPayload)(e,!0);return n?r[n]:undefined}async set(e,t,r){if(!this.canCacheResult(e,r))return;const n=(0,i.cacheIdentifierForPayload)(e,!0);if(!n)return;this.getBlockCacheForPayload(e,t)[n]=r}canCacheRequest(e){if(!(0,i.canCache)(e))return!1;return"pending"!==(0,i.blockTagForPayload)(e)}canCacheResult(e,t){return!s.includes(t)&&!(e.method&&["eth_getTransactionByHash","eth_getTransactionReceipt"].includes(e.method)&&(!t||!t.blockHash||"0x0000000000000000000000000000000000000000000000000000000000000000"===t.blockHash))}clearBefore(e){const t=Number.parseInt(e,16);Object.keys(this.cache).map(Number).filter((e=>e<t)).forEach((e=>delete this.cache[e]))}}r.createBlockCacheMiddleware=function({blockTracker:e}={}){if(!e)throw new Error("createBlockCacheMiddleware - No PollingBlockTracker specified");const t=new o,r={perma:t,block:t,fork:t};return(0,n.createAsyncMiddleware)((async(n,s,o)=>{if(n.skipCache)return o();const a=(0,i.cacheTypeForPayload)(n),u=r[a];if(!u)return o();if(!u.canCacheRequest(n))return o();let c,h=(0,i.blockTagForPayload)(n);if(h||(h="latest"),"earliest"===h)c="0x00";else if("latest"===h){const r=await e.getLatestBlock();t.clearBefore(r),c=r}else c=h;const l=await u.get(n,c);return l===undefined?(await o(),await u.set(n,c,s.result)):s.result=l,undefined}))}}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/block-cache.js"}],[2402,{"./utils/cache":2412,"json-rpc-engine":4727},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefRewriteMiddleware=void 0;const n=e("json-rpc-engine"),i=e("./utils/cache");r.createBlockRefRewriteMiddleware=function({blockTracker:e}={}){if(!e)throw Error('BlockRefRewriteMiddleware - mandatory "blockTracker" option is missing.');return(0,n.createAsyncMiddleware)((async(t,r,n)=>{var s;const o=(0,i.blockTagParamIndex)(t);if(o===undefined)return n();let a=null===(s=t.params)||void 0===s?void 0:s[o];if(a===undefined&&(a="latest"),"latest"!==a)return n();const u=await e.getLatestBlock();return t.params&&(t.params[o]=u),n()}))}}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/block-ref-rewrite.js"}],[2403,{"./utils/cache":2412,clone:2123,"json-rpc-engine":4727,pify:2435},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefMiddleware=void 0;const i=e("json-rpc-engine"),s=n(e("clone")),o=n(e("pify")),a=e("./utils/cache");r.createBlockRefMiddleware=function({provider:e,blockTracker:t}={}){if(!e)throw Error('BlockRefMiddleware - mandatory "provider" option is missing.');if(!t)throw Error('BlockRefMiddleware - mandatory "blockTracker" option is missing.');return(0,i.createAsyncMiddleware)((async(r,n,i)=>{var u;const c=(0,a.blockTagParamIndex)(r);if(c===undefined)return i();let h=null===(u=r.params)||void 0===u?void 0:u[c];if(h===undefined&&(h="latest"),"latest"!==h)return i();const l=await t.getLatestBlock(),f=(0,s.default)(r);f.params&&(f.params[c]=l);const d=await(0,o.default)(e.sendAsync).call(e,f);return n.result=d.result,n.error=d.error,i()}))}}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/block-ref.js"}],[2404,{"json-rpc-engine":4727},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockTrackerInspectorMiddleware=void 0;const n=e("json-rpc-engine"),i=["eth_getTransactionByHash","eth_getTransactionReceipt"];r.createBlockTrackerInspectorMiddleware=function({blockTracker:e}){return(0,n.createAsyncMiddleware)((async(t,r,n)=>{var s;if(!i.includes(t.method))return n();if(await n(),!(null===(s=r.result)||void 0===s?void 0:s.blockNumber))return undefined;if("string"==typeof r.result.blockNumber){Number.parseInt(r.result.blockNumber,16)>Number.parseInt(e.getCurrentBlock(),16)&&await e.checkForLatestBlock()}return undefined}))}}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/block-tracker-inspector.js"}],[2405,{btoa:2080,"eth-rpc-errors":2455,"json-rpc-engine":4727,"node-fetch":2080},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createFetchConfigFromReq=r.createFetchMiddleware=void 0;const n=e("json-rpc-engine"),i=e("eth-rpc-errors"),s=global.fetch||e("node-fetch"),o=global.btoa||e("btoa"),a=["Gateway timeout","ETIMEDOUT","failed to parse response body","Failed to fetch"];function u(e){switch(e.status){case 405:throw i.ethErrors.rpc.methodNotFound();case 418:throw i.ethErrors.rpc.internal({message:"Request is being rate limited."});case 503:case 504:throw function(){let e="Gateway timeout. The request took too long to process. ";return e+="This can happen when querying logs over too wide a block range.",i.ethErrors.rpc.internal({message:e})}()}}function c(e,t){if(200!==e.status)throw i.ethErrors.rpc.internal({message:`Non-200 status code: '${e.status}'`,data:t});if(t.error)throw i.ethErrors.rpc.internal({data:t.error});return t.result}function h({req:e,rpcUrl:t,originHttpHeaderKey:r}){const n=new URL(t),i=function(e){let t="";t+=e.protocol,t+=`//${e.hostname}`,e.port&&(t+=`:${e.port}`);return t+=`${e.pathname}`,t+=`${e.search}`,t}(n),s={id:e.id,jsonrpc:e.jsonrpc,method:e.method,params:e.params},a=e.origin,u={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)};if(n.username&&n.password){const e=`${n.username}:${n.password}`,t=o(e);u.headers.Authorization=`Basic ${t}`}return r&&a&&(u.headers[r]=a),{fetchUrl:i,fetchParams:u}}function l(e){return new Promise((t=>setTimeout(t,e)))}r.createFetchMiddleware=function({rpcUrl:e,originHttpHeaderKey:t}){return(0,n.createAsyncMiddleware)((async(r,n,i)=>{const{fetchUrl:o,fetchParams:f}=h({req:r,rpcUrl:e,originHttpHeaderKey:t});for(let e=0;e<5;e++){try{const e=await s(o,f);u(e);const t=await e.text();let r;try{r=JSON.parse(t)}catch(e){throw new Error(`FetchMiddleware - failed to parse response body: "${t}"`)}const i=c(e,r);return void(n.result=i)}catch(e){const t=e.toString();if(!a.some((e=>t.includes(e))))throw e}await l(1e3)}}))},r.createFetchConfigFromReq=h}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/fetch.js"}],[2406,{"./block-cache":2401,"./block-ref":2403,"./block-ref-rewrite":2402,"./block-tracker-inspector":2404,"./fetch":2405,"./inflight-cache":2407,"./providerAsMiddleware":2408,"./providerFromEngine":2409,"./providerFromMiddleware":2410,"./retryOnEmpty":2411,"./wallet":2413},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./block-cache"),r),i(e("./block-ref-rewrite"),r),i(e("./block-ref"),r),i(e("./block-tracker-inspector"),r),i(e("./fetch"),r),i(e("./inflight-cache"),r),i(e("./providerAsMiddleware"),r),i(e("./providerFromEngine"),r),i(e("./providerFromMiddleware"),r),i(e("./retryOnEmpty"),r),i(e("./wallet"),r)}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/index.js"}],[2407,{"./utils/cache":2412,clone:2123,"json-rpc-engine":4727},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createInflightCacheMiddleware=void 0;const i=n(e("clone")),s=e("json-rpc-engine"),o=e("./utils/cache");r.createInflightCacheMiddleware=function(){const e={};return(0,s.createAsyncMiddleware)((async(t,r,n)=>{if(t.skipCache)return n();const s=(0,o.cacheIdentifierForPayload)(t);if(!s)return n();let a=e[s];return a?(await function(e,t){const{resolve:r,promise:n}=function(){let e;const t=new Promise((t=>{e=t}));return{resolve:e,promise:t}}();return t.push((t=>{e.result=(0,i.default)(t.result),e.error=(0,i.default)(t.error),r()})),n}(r,a),undefined):(a=[],e[s]=a,await n(),delete e[s],function(e,t){setTimeout((()=>{t.forEach((t=>{try{t(e)}catch(e){console.error(e)}}))}))}(r,a),undefined)}))}}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/inflight-cache.js"}],[2408,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ethersProviderAsMiddleware=r.providerAsMiddleware=void 0,r.providerAsMiddleware=function(e){return(t,r,n,i)=>{e.sendAsync(t,((e,t)=>e?i(e):(Object.assign(r,t),i())))}},r.ethersProviderAsMiddleware=function(e){return(t,r,n,i)=>{e.send(t,((e,t)=>e?i(e):(Object.assign(r,t),i())))}}}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/providerAsMiddleware.js"}],[2409,{"@metamask/safe-event-emitter":1315},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.providerFromEngine=void 0;const i=n(e("@metamask/safe-event-emitter"));r.providerFromEngine=function(e){const t=new i.default;return t.sendAsync=e.handle.bind(e),t.send=(t,r)=>{if("function"!=typeof r)throw new Error('Must provide callback to "send" method.');e.handle(t,r)},e.on&&e.on("notification",(e=>{t.emit("data",null,e)})),t}}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/providerFromEngine.js"}],[241,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e=>t=>({encode:r=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(r,t,e),decode:r=>((e,t,r)=>{const n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const s=new Uint8Array(i*r/8|0);let o=0,a=0,u=0;for(let t=0;t<i;++t){const i=n[e[t]];if(i===undefined)throw new SyntaxError("Invalid character "+e[t]);a=a<<r|i,o+=r,o>=8&&(o-=8,s[u++]=255&a>>o)}if(o>=r||255&a<<8-o)throw new SyntaxError("Unexpected end of data");return s})(r,t,e)})}}},{package:"multibase",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multibase/src/rfc4648.js"}],[2410,{"./providerFromEngine":2409,"json-rpc-engine":4727},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.providerFromMiddleware=void 0;const n=e("json-rpc-engine"),i=e("./providerFromEngine");r.providerFromMiddleware=function(e){const t=new n.JsonRpcEngine;return t.push(e),(0,i.providerFromEngine)(t)}}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/providerFromMiddleware.js"}],[2411,{"./utils/cache":2412,clone:2123,"json-rpc-engine":4727,pify:2435},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createRetryOnEmptyMiddleware=void 0;const i=n(e("clone")),s=e("json-rpc-engine"),o=n(e("pify")),a=e("./utils/cache"),u=[undefined,null,"<nil>"];function c(e){return new Promise((t=>setTimeout(t,e)))}r.createRetryOnEmptyMiddleware=function({provider:e,blockTracker:t}={}){if(!e)throw Error('RetryOnEmptyMiddleware - mandatory "provider" option is missing.');if(!t)throw Error('RetryOnEmptyMiddleware - mandatory "blockTracker" option is missing.');return(0,s.createAsyncMiddleware)((async(r,n,s)=>{var h;const l=(0,a.blockTagParamIndex)(r);if(l===undefined)return s();let f=null===(h=r.params)||void 0===h?void 0:h[l];if(f===undefined&&(f="latest"),["latest","pending"].includes(f))return s();const d=Number.parseInt(f.slice(2),16);if(Number.isNaN(d))return s();const p=await t.getLatestBlock();if(d>Number.parseInt(p.slice(2),16))return s();const m=(0,i.default)(r),g=await async function(e,t){for(let r=0;r<e;r++)try{return await t()}catch(e){await c(1e3)}throw new Error("RetryOnEmptyMiddleware - retries exhausted")}(10,(async()=>{const t=await(0,o.default)(e.sendAsync).call(e,m);if(u.includes(t))throw new Error(`RetryOnEmptyMiddleware - empty response "${JSON.stringify(t)}" for request "${JSON.stringify(m)}"`);return t}));return n.result=g.result,n.error=g.error,s()}))}}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/retryOnEmpty.js"}],[2412,{"json-stable-stringify":4731},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.cacheTypeForPayload=r.blockTagParamIndex=r.paramsWithoutBlockTag=r.blockTagForPayload=r.canCache=r.cacheIdentifierForPayload=void 0;const i=n(e("json-stable-stringify"));function s(e){return"never"!==u(e)}function o(e){if(!e.params)return[];const t=a(e);return t===undefined||t>=e.params.length?e.params:"eth_getBlockByNumber"===e.method?e.params.slice(1):e.params.slice(0,t)}function a(e){switch(e.method){case"eth_getStorageAt":return 2;case"eth_getBalance":case"eth_getCode":case"eth_getTransactionCount":case"eth_call":return 1;case"eth_getBlockByNumber":return 0;default:return undefined}}function u(e){switch(e.method){case"web3_clientVersion":case"web3_sha3":case"eth_protocolVersion":case"eth_getBlockTransactionCountByHash":case"eth_getUncleCountByBlockHash":case"eth_getCode":case"eth_getBlockByHash":case"eth_getTransactionByHash":case"eth_getTransactionByBlockHashAndIndex":case"eth_getTransactionReceipt":case"eth_getUncleByBlockHashAndIndex":case"eth_getCompilers":case"eth_compileLLL":case"eth_compileSolidity":case"eth_compileSerpent":case"shh_version":case"test_permaCache":return"perma";case"eth_getBlockByNumber":case"eth_getBlockTransactionCountByNumber":case"eth_getUncleCountByBlockNumber":case"eth_getTransactionByBlockNumberAndIndex":case"eth_getUncleByBlockNumberAndIndex":case"test_forkCache":return"fork";case"eth_gasPrice":case"eth_blockNumber":case"eth_getBalance":case"eth_getStorageAt":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":case"eth_getFilterLogs":case"eth_getLogs":case"test_blockCache":return"block";default:return"never"}}r.cacheIdentifierForPayload=function(e,t){var r;const n=t?o(e):null!==(r=e.params)&&void 0!==r?r:[];return s(e)?`${e.method}:${(0,i.default)(n)}`:null},r.canCache=s,r.blockTagForPayload=function(e){if(!e.params)return undefined;const t=a(e);return t===undefined||t>=e.params.length?undefined:e.params[t]},r.paramsWithoutBlockTag=o,r.blockTagParamIndex=a,r.cacheTypeForPayload=u}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/utils/cache.js"}],[2413,{"eth-rpc-errors":2455,"eth-sig-util":2414,"json-rpc-engine":4727},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.createWalletMiddleware=void 0;const o=e("json-rpc-engine"),a=s(e("eth-sig-util")),u=e("eth-rpc-errors");function c(e){return 42===e.length}r.createWalletMiddleware=function({getAccounts:e,processDecryptMessage:t,processEncryptionPublicKey:r,processEthSignMessage:n,processPersonalMessage:i,processTransaction:s,processSignTransaction:h,processTypedMessage:l,processTypedMessageV3:f,processTypedMessageV4:d}){if(!e)throw new Error("opts.getAccounts is required");return(0,o.createScaffoldMiddleware)({eth_accounts:(0,o.createAsyncMiddleware)((async function(t,r){r.result=await e(t)})),eth_coinbase:(0,o.createAsyncMiddleware)((async function(t,r){const n=await e(t);r.result=n[0]||null})),eth_sendTransaction:(0,o.createAsyncMiddleware)((async function(e,t){if(!s)throw u.ethErrors.rpc.methodNotSupported();const r=e.params[0]||{};r.from=await p(r.from,e),t.result=await s(r,e)})),eth_signTransaction:(0,o.createAsyncMiddleware)((async function(e,t){if(!h)throw u.ethErrors.rpc.methodNotSupported();const r=e.params[0]||{};r.from=await p(r.from,e),t.result=await h(r,e)})),eth_sign:(0,o.createAsyncMiddleware)((async function(e,t){if(!n)throw u.ethErrors.rpc.methodNotSupported();const r=await p(e.params[0],e),i=e.params[1],s=e.params[2]||{},o=Object.assign(Object.assign({},s),{from:r,data:i});t.result=await n(o,e)})),eth_signTypedData:(0,o.createAsyncMiddleware)((async function(e,t){if(!l)throw u.ethErrors.rpc.methodNotSupported();const r=e.params[0],n=await p(e.params[1],e),i=e.params[2]||{},s=Object.assign(Object.assign({},i),{from:n,data:r});t.result=await l(s,e,"V1")})),eth_signTypedData_v3:(0,o.createAsyncMiddleware)((async function(e,t){if(!f)throw u.ethErrors.rpc.methodNotSupported();const r=await p(e.params[0],e),n=e.params[1],i={data:n,from:r,version:"V3"};t.result=await f(i,e,"V3")})),eth_signTypedData_v4:(0,o.createAsyncMiddleware)((async function(e,t){if(!d)throw u.ethErrors.rpc.methodNotSupported();const r=await p(e.params[0],e),n=e.params[1],i={data:n,from:r,version:"V4"};t.result=await d(i,e,"V4")})),personal_sign:(0,o.createAsyncMiddleware)((async function(e,t){if(!i)throw u.ethErrors.rpc.methodNotSupported();const r=e.params[0],n=e.params[1],s=e.params[2]||{};let o,a;if(c(r)&&!c(n)){let e="The eth_personalSign method requires params ordered ";e+="[message, address]. This was previously handled incorrectly, ",e+="and has been corrected automatically. ",e+="Please switch this param order for smooth behavior in the future.",t.warning=e,o=r,a=n}else a=r,o=n;o=await p(o,e);const h=Object.assign(Object.assign({},s),{from:o,data:a});t.result=await i(h,e)})),eth_getEncryptionPublicKey:(0,o.createAsyncMiddleware)((async function(e,t){if(!r)throw u.ethErrors.rpc.methodNotSupported();const n=await p(e.params[0],e);t.result=await r(n,e)})),eth_decrypt:(0,o.createAsyncMiddleware)((async function(e,r){if(!t)throw u.ethErrors.rpc.methodNotSupported();const n=e.params[0],i=await p(e.params[1],e),s=e.params[2]||{},o=Object.assign(Object.assign({},s),{from:i,data:n});r.result=await t(o,e)})),personal_ecRecover:(0,o.createAsyncMiddleware)((async function(e,t){const r=e.params[0],n=e.params[1],i=e.params[2]||{},s=Object.assign(Object.assign({},i),{sig:n,data:r}),o=a.recoverPersonalSignature(s);t.result=o}))});async function p(t,r){if("string"==typeof t&&t.length>0){const n=(await e(r)).map((e=>e.toLowerCase())),i=t.toLowerCase();if(n.includes(i))return i}throw u.ethErrors.rpc.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})}}}}},{package:"eth-json-rpc-middleware",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/dist/wallet.js"}],[2414,{"ethereumjs-abi":2415,"ethereumjs-util":2427},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("ethereumjs-util"),i=e("ethereumjs-abi");function s(e){const t=new Error("Expect argument to be non-empty array");if("object"!=typeof e||!e.length)throw t;const r=e.map((function(e){return"bytes"===e.type?n.toBuffer(e.value):e.value})),s=e.map((function(e){return e.type})),o=e.map((function(e){if(!e.name)throw t;return e.type+" "+e.name}));return i.soliditySHA3(["bytes32","bytes32"],[i.soliditySHA3(new Array(e.length).fill("string"),o),i.soliditySHA3(s,r)])}function o(e,t){const r=n.toBuffer(t),i=n.fromRpcSig(r);return n.ecrecover(e,i.v,i.r,i.s)}function a(e){const t=n.toBuffer(e.data);return o(n.hashPersonalMessage(t),e.sig)}function u(e,t){for(var r=""+e;r.length<t;)r="0"+r;return r}t.exports={concatSig:function(e,t,r){const i=n.fromSigned(t),s=n.fromSigned(r),o=n.bufferToInt(e),a=u(n.toUnsigned(i).toString("hex"),64),c=u(n.toUnsigned(s).toString("hex"),64),h=n.stripHexPrefix(n.intToHex(o));return n.addHexPrefix(a.concat(c,h)).toString("hex")},normalize:function(e){if(e){if("number"==typeof e){const t=n.toBuffer(e);e=n.bufferToHex(t)}if("string"!=typeof e){var t="eth-sig-util.normalize() requires hex string or integer input.";throw new Error(t+=" received "+typeof e+": "+e)}return n.addHexPrefix(e.toLowerCase())}},personalSign:function(e,t){var r=n.toBuffer(t.data),i=n.hashPersonalMessage(r),s=n.ecsign(i,e);return n.bufferToHex(this.concatSig(s.v,s.r,s.s))},recoverPersonalSignature:function(e){const t=a(e),r=n.publicToAddress(t);return n.bufferToHex(r)},extractPublicKey:function(e){return"0x"+a(e).toString("hex")},typedSignatureHash:function(e){const t=s(e);return n.bufferToHex(t)},signTypedData:function(e,t){const r=s(t.data),i=n.ecsign(r,e);return n.bufferToHex(this.concatSig(i.v,i.r,i.s))},recoverTypedSignature:function(e){const t=o(s(e.data),e.sig),r=n.publicToAddress(t);return n.bufferToHex(r)}}}}},{package:"eth-sig-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/eth-sig-util/index.js"}],[2415,{"./lib/index.js":2416},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib/index.js")}}},{package:"ethereumjs-abi",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/index.js"}],[2416,{"bn.js":2037,buffer:2081,"ethereumjs-util":2421},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("ethereumjs-util"),i=e("bn.js");var s=function(){};function o(e){return e.startsWith("int[")?"int256"+e.slice(3):"int"===e?"int256":e.startsWith("uint[")?"uint256"+e.slice(4):"uint"===e?"uint256":e.startsWith("fixed[")?"fixed128x128"+e.slice(5):"fixed"===e?"fixed128x128":e.startsWith("ufixed[")?"ufixed128x128"+e.slice(6):"ufixed"===e?"ufixed128x128":e}function a(e){return parseInt(/^\D+(\d+)$/.exec(e)[1],10)}function u(e){var t=/^\D+(\d+)x(\d+)$/.exec(e);return[parseInt(t[1],10),parseInt(t[2],10)]}function c(e){var t=e.match(/(.*)\[(.*?)\]$/);return t?""===t[2]?"dynamic":parseInt(t[2],10):null}function h(e){var t=typeof e;if("string"===t)return n.isHexPrefixed(e)?new i(n.stripHexPrefix(e),16):new i(e,10);if("number"===t)return new i(e);if(e.toArray)return e;throw new Error("Argument is not a number")}function l(e){var t=/^(\w+)\((.*)\)$/.exec(e);if(3!==t.length)throw new Error("Invalid method signature");var r=/^(.+)\):\((.+)$/.exec(t[2]);if(null!==r&&3===r.length)return{method:t[1],args:r[1].split(","),retargs:r[2].split(",")};var n=t[2].split(",");return 1===n.length&&""===n[0]&&(n=[]),{method:t[1],args:n}}function f(e,t){var s,o,l,d;if("address"===e)return f("uint160",h(t));if("bool"===e)return f("uint8",t?1:0);if("string"===e)return f("bytes",r.from(t,"utf8"));if(g(e)){if(void 0===t.length)throw new Error("Not an array?");if("dynamic"!==(s=c(e))&&0!==s&&t.length>s)throw new Error("Elements exceed array size: "+s);for(d in l=[],e=e.slice(0,e.lastIndexOf("[")),"string"==typeof t&&(t=JSON.parse(t)),t)l.push(f(e,t[d]));if("dynamic"===s){var p=f("uint256",t.length);l.unshift(p)}return r.concat(l)}if("bytes"===e)return t=r.from(t),l=r.concat([f("uint256",t.length),t]),t.length%32!=0&&(l=r.concat([l,n.zeros(32-t.length%32)])),l;if(e.startsWith("bytes")){if((s=a(e))<1||s>32)throw new Error("Invalid bytes<N> width: "+s);return n.setLengthRight(t,32)}if(e.startsWith("uint")){if((s=a(e))%8||s<8||s>256)throw new Error("Invalid uint<N> width: "+s);if((o=h(t)).bitLength()>s)throw new Error("Supplied uint exceeds width: "+s+" vs "+o.bitLength());if(o<0)throw new Error("Supplied uint is negative");return o.toArrayLike(r,"be",32)}if(e.startsWith("int")){if((s=a(e))%8||s<8||s>256)throw new Error("Invalid int<N> width: "+s);if((o=h(t)).bitLength()>s)throw new Error("Supplied int exceeds width: "+s+" vs "+o.bitLength());return o.toTwos(256).toArrayLike(r,"be",32)}if(e.startsWith("ufixed")){if(s=u(e),(o=h(t))<0)throw new Error("Supplied ufixed is negative");return f("uint256",o.mul(new i(2).pow(new i(s[1]))))}if(e.startsWith("fixed"))return s=u(e),f("int256",h(t).mul(new i(2).pow(new i(s[1]))));throw new Error("Unsupported or invalid type: "+e)}function d(e,t,n){var s,o,a,u;if("string"==typeof e&&(e=p(e)),"address"===e.name)return d(e.rawType,t,n).toArrayLike(r,"be",20).toString("hex");if("bool"===e.name)return d(e.rawType,t,n).toString()===new i(1).toString();if("string"===e.name){var c=d(e.rawType,t,n);return r.from(c,"utf8").toString()}if(e.isArray){for(a=[],s=e.size,"dynamic"===e.size&&(n=d("uint256",t,n).toNumber(),s=d("uint256",t,n).toNumber(),n+=32),u=0;u<s;u++){var h=d(e.subArray,t,n);a.push(h),n+=e.subArray.memoryUsage}return a}if("bytes"===e.name)return n=d("uint256",t,n).toNumber(),s=d("uint256",t,n).toNumber(),t.slice(n+32,n+32+s);if(e.name.startsWith("bytes"))return t.slice(n,n+e.size);if(e.name.startsWith("uint")){if((o=new i(t.slice(n,n+32),16,"be")).bitLength()>e.size)throw new Error("Decoded int exceeds width: "+e.size+" vs "+o.bitLength());return o}if(e.name.startsWith("int")){if((o=new i(t.slice(n,n+32),16,"be").fromTwos(256)).bitLength()>e.size)throw new Error("Decoded uint exceeds width: "+e.size+" vs "+o.bitLength());return o}if(e.name.startsWith("ufixed")){if(s=new i(2).pow(new i(e.size[1])),!(o=d("uint256",t,n)).mod(s).isZero())throw new Error("Decimals not supported yet");return o.div(s)}if(e.name.startsWith("fixed")){if(s=new i(2).pow(new i(e.size[1])),!(o=d("int256",t,n)).mod(s).isZero())throw new Error("Decimals not supported yet");return o.div(s)}throw new Error("Unsupported or invalid type: "+e.name)}function p(e){var t,r,n;if(g(e)){t=c(e);var i=e.slice(0,e.lastIndexOf("["));return i=p(i),r={isArray:!0,name:e,size:t,memoryUsage:"dynamic"===t?32:i.memoryUsage*t,subArray:i}}switch(e){case"address":n="uint160";break;case"bool":n="uint8";break;case"string":n="bytes"}if(r={rawType:n,name:e,memoryUsage:32},e.startsWith("bytes")&&"bytes"!==e||e.startsWith("uint")||e.startsWith("int")?r.size=a(e):(e.startsWith("ufixed")||e.startsWith("fixed"))&&(r.size=u(e)),e.startsWith("bytes")&&"bytes"!==e&&(r.size<1||r.size>32))throw new Error("Invalid bytes<N> width: "+r.size);if((e.startsWith("uint")||e.startsWith("int"))&&(r.size%8||r.size<8||r.size>256))throw new Error("Invalid int/uint<N> width: "+r.size);return r}function m(e){return"string"===e||"bytes"===e||"dynamic"===c(e)}function g(e){return e.lastIndexOf("]")===e.length-1}function y(e,t){return e.startsWith("address")||e.startsWith("bytes")?"0x"+t.toString("hex"):t.toString()}s.eventID=function(e,t){var i=e+"("+t.map(o).join(",")+")";return n.keccak256(r.from(i))},s.methodID=function(e,t){return s.eventID(e,t).slice(0,4)},s.rawEncode=function(e,t){var n=[],i=[],s=0;e.forEach((function(e){if(g(e)){var t=c(e);s+="dynamic"!==t?32*t:32}else s+=32}));for(var a=0;a<e.length;a++){var u=o(e[a]),h=f(u,t[a]);m(u)?(n.push(f("uint256",s)),i.push(h),s+=h.length):n.push(h)}return r.concat(n.concat(i))},s.rawDecode=function(e,t){var n=[];t=r.from(t);for(var i=0,s=0;s<e.length;s++){var a=p(o(e[s])),u=d(a,t,i);i+=a.memoryUsage,n.push(u)}return n},s.simpleEncode=function(e){var t=Array.prototype.slice.call(arguments).slice(1),n=l(e);if(t.length!==n.args.length)throw new Error("Argument count mismatch");return r.concat([s.methodID(n.method,n.args),s.rawEncode(n.args,t)])},s.simpleDecode=function(e,t){var r=l(e);if(!r.retargs)throw new Error("No return values in method");return s.rawDecode(r.retargs,t)},s.stringify=function(e,t){var r=[];for(var n in e){var i=e[n],s=t[n];s=/^[^\[]+\[.*\]$/.test(i)?s.map((function(e){return y(i,e)})).join(", "):y(i,s),r.push(s)}return r},s.solidityPack=function(e,t){if(e.length!==t.length)throw new Error("Number of types are not matching the values");for(var i,s,u=[],c=0;c<e.length;c++){var l=o(e[c]),f=t[c];if("bytes"===l)u.push(f);else if("string"===l)u.push(r.from(f,"utf8"));else if("bool"===l)u.push(r.from(f?"01":"00","hex"));else if("address"===l)u.push(n.setLengthLeft(f,20));else if(l.startsWith("bytes")){if((i=a(l))<1||i>32)throw new Error("Invalid bytes<N> width: "+i);u.push(n.setLengthRight(f,i))}else if(l.startsWith("uint")){if((i=a(l))%8||i<8||i>256)throw new Error("Invalid uint<N> width: "+i);if((s=h(f)).bitLength()>i)throw new Error("Supplied uint exceeds width: "+i+" vs "+s.bitLength());u.push(s.toArrayLike(r,"be",i/8))}else{if(!l.startsWith("int"))throw new Error("Unsupported or invalid type: "+l);if((i=a(l))%8||i<8||i>256)throw new Error("Invalid int<N> width: "+i);if((s=h(f)).bitLength()>i)throw new Error("Supplied int exceeds width: "+i+" vs "+s.bitLength());u.push(s.toTwos(i).toArrayLike(r,"be",i/8))}}return r.concat(u)},s.soliditySHA3=function(e,t){return n.keccak256(s.solidityPack(e,t))},s.soliditySHA256=function(e,t){return n.sha256(s.solidityPack(e,t))},s.solidityRIPEMD160=function(e,t){return n.ripemd160(s.solidityPack(e,t),!0)},s.fromSerpent=function(e){for(var t,r=[],n=0;n<e.length;n++){var i=e[n];if("s"===i)r.push("bytes");else if("b"===i){for(var s="bytes",o=n+1;o<e.length&&((t=e[o])>="0"&&t<="9");)s+=e[o]-"0",o++;n=o-1,r.push(s)}else if("i"===i)r.push("int256");else{if("a"!==i)throw new Error("Unsupported or invalid type: "+i);r.push("int256[]")}}return r},s.toSerpent=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if("bytes"===n)t.push("s");else if(n.startsWith("bytes"))t.push("b"+a(n));else if("int256"===n)t.push("i");else{if("int256[]"!==n)throw new Error("Unsupported or invalid type: "+n);t.push("a")}}return t.join("")},t.exports=s}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-abi",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/lib/index.js"}],[2417,{"./bytes":2418,"./hash":2420,"./secp256k1v3-adapter":2423,assert:1700,"bn.js":2037,buffer:2081,"ethjs-util":2428},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.importPublic=r.privateToPublic=r.privateToAddress=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.isPrecompiled=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isZeroAddress=r.isValidAddress=r.zeroAddress=void 0;var n=e("assert"),i=e("ethjs-util"),s=e("./secp256k1v3-adapter"),o=e("bn.js"),a=e("./bytes"),u=e("./hash");r.zeroAddress=function(){var e=a.zeros(20);return a.bufferToHex(e)},r.isValidAddress=function(e){return/^0x[0-9a-fA-F]{40}$/.test(e)},r.isZeroAddress=function(e){return r.zeroAddress()===a.addHexPrefix(e)},r.toChecksumAddress=function(e,t){e=i.stripHexPrefix(e).toLowerCase();for(var r=t!==undefined?t.toString()+"0x":"",n=u.keccak(r+e).toString("hex"),s="0x",o=0;o<e.length;o++)parseInt(n[o],16)>=8?s+=e[o].toUpperCase():s+=e[o];return s},r.isValidChecksumAddress=function(e,t){return r.isValidAddress(e)&&r.toChecksumAddress(e,t)===e},r.generateAddress=function(e,r){e=a.toBuffer(e);var n=new o(r);return n.isZero()?u.rlphash([e,null]).slice(-20):u.rlphash([e,t.from(n.toArray())]).slice(-20)},r.generateAddress2=function(e,r,i){var s=a.toBuffer(e),o=a.toBuffer(r),c=a.toBuffer(i);return n(20===s.length),n(32===o.length),u.keccak256(t.concat([t.from("ff","hex"),s,o,u.keccak256(c)])).slice(-20)},r.isPrecompiled=function(e){var t=a.unpad(e);return 1===t.length&&t[0]>=1&&t[0]<=8},r.isValidPrivate=function(e){return s.privateKeyVerify(e)},r.isValidPublic=function(e,r){return void 0===r&&(r=!1),64===e.length?s.publicKeyVerify(t.concat([t.from([4]),e])):!!r&&s.publicKeyVerify(e)},r.pubToAddress=function(e,t){return void 0===t&&(t=!1),e=a.toBuffer(e),t&&64!==e.length&&(e=s.publicKeyConvert(e,!1).slice(1)),n(64===e.length),u.keccak(e).slice(-20)},r.publicToAddress=r.pubToAddress,r.privateToAddress=function(e){return r.publicToAddress(r.privateToPublic(e))},r.privateToPublic=function(e){return e=a.toBuffer(e),s.publicKeyCreate(e,!1).slice(1)},r.importPublic=function(e){return 64!==(e=a.toBuffer(e)).length&&(e=s.publicKeyConvert(e,!1).slice(1)),e}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/node_modules/ethereumjs-util/dist/account.js"}],[2418,{"bn.js":2037,buffer:2081,"ethjs-util":2428},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.baToJSON=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToHex=r.bufferToInt=r.toBuffer=r.stripZeros=r.unpad=r.setLengthRight=r.setLength=r.setLengthLeft=r.zeros=void 0;var n=e("ethjs-util"),i=e("bn.js");r.zeros=function(e){return t.allocUnsafe(e).fill(0)},r.setLengthLeft=function(e,t,n){void 0===n&&(n=!1);var i=r.zeros(t);return e=r.toBuffer(e),n?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)},r.setLength=r.setLengthLeft,r.setLengthRight=function(e,t){return r.setLength(e,t,!0)},r.unpad=function(e){for(var t=(e=n.stripHexPrefix(e))[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e},r.stripZeros=r.unpad,r.toBuffer=function(e){if(!t.isBuffer(e))if(Array.isArray(e))e=t.from(e);else if("string"==typeof e){if(!n.isHexString(e))throw new Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: "+e);e=t.from(n.padToEven(n.stripHexPrefix(e)),"hex")}else if("number"==typeof e)e=n.intToBuffer(e);else if(null===e||e===undefined)e=t.allocUnsafe(0);else if(i.isBN(e))e=e.toArrayLike(t);else{if(!e.toArray)throw new Error("invalid type");e=t.from(e.toArray())}return e},r.bufferToInt=function(e){return new i(r.toBuffer(e)).toNumber()},r.bufferToHex=function(e){return"0x"+(e=r.toBuffer(e)).toString("hex")},r.fromSigned=function(e){return new i(e).fromTwos(256)},r.toUnsigned=function(e){return t.from(e.toTwos(256).toArray())},r.addHexPrefix=function(e){return"string"!=typeof e||n.isHexPrefixed(e)?e:"0x"+e},r.baToJSON=function(e){if(t.isBuffer(e))return"0x"+e.toString("hex");if(e instanceof Array){for(var n=[],i=0;i<e.length;i++)n.push(r.baToJSON(e[i]));return n}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/node_modules/ethereumjs-util/dist/bytes.js"}],[2419,{"bn.js":2037,buffer:2081},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.MAX_INTEGER=void 0;var n=e("bn.js");r.MAX_INTEGER=new n("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new n("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=t.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=t.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=t.from(r.KECCAK256_RLP_S,"hex")}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/node_modules/ethereumjs-util/dist/constants.js"}],[242,{buffer:2081,"web-encoding":6035},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),{TextEncoder:i,TextDecoder:s}=e("web-encoding"),o=new s,a=new i;t.exports={decodeText:e=>o.decode(e),encodeText:e=>a.encode(e),asBuffer:({buffer:e,byteLength:t,byteOffset:r})=>n.from(e,r,t)}}}},{package:"multibase",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multibase/src/util.js"}],[2420,{"./bytes":2418,buffer:2081,"create-hash":2185,"ethereum-cryptography/keccak":2490,"ethjs-util":2428,rlp:5737},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.rlphash=r.ripemd160=r.sha256=r.keccak256=r.keccak=void 0;var n=e("ethereum-cryptography/keccak"),i=n.keccak224,s=n.keccak384,o=n.keccak256,a=n.keccak512,u=e("create-hash"),c=e("ethjs-util"),h=e("rlp"),l=e("./bytes");r.keccak=function(e,r){switch(void 0===r&&(r=256),e="string"!=typeof e||c.isHexString(e)?l.toBuffer(e):t.from(e,"utf8"),r||(r=256),r){case 224:return i(e);case 256:return o(e);case 384:return s(e);case 512:return a(e);default:throw new Error("Invald algorithm: keccak"+r)}},r.keccak256=function(e){return r.keccak(e)},r.sha256=function(e){return e=l.toBuffer(e),u("sha256").update(e).digest()},r.ripemd160=function(e,t){e=l.toBuffer(e);var r=u("rmd160").update(e).digest();return!0===t?l.setLength(r,32):r},r.rlphash=function(e){return r.keccak(h.encode(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/node_modules/ethereumjs-util/dist/hash.js"}],[2421,{"./account":2417,"./bytes":2418,"./constants":2419,"./hash":2420,"./object":2422,"./secp256k1v3-adapter":2423,"./signature":2426,"bn.js":2037,"ethjs-util":2428,rlp:5737},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.secp256k1=r.rlp=r.BN=void 0;var s=e("./secp256k1v3-adapter");r.secp256k1=s;var o=e("ethjs-util"),a=e("bn.js");r.BN=a;var u=e("rlp");r.rlp=u,Object.assign(r,o),i(e("./constants"),r),i(e("./account"),r),i(e("./hash"),r),i(e("./signature"),r),i(e("./bytes"),r),i(e("./object"),r)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/node_modules/ethereumjs-util/dist/index.js"}],[2422,{"./bytes":2418,assert:1700,buffer:2081,"ethjs-util":2428,rlp:5737},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.defineProperties=void 0;var n=e("assert"),i=e("ethjs-util"),s=e("rlp"),o=e("./bytes");r.defineProperties=function(e,r,a){if(e.raw=[],e._fields=[],e.toJSON=function(t){if(void 0===t&&(t=!1),t){var r={};return e._fields.forEach((function(t){r[t]="0x"+e[t].toString("hex")})),r}return o.baToJSON(e.raw)},e.serialize=function(){return s.encode(e.raw)},r.forEach((function(r,i){function s(){return e.raw[i]}function a(s){"00"!==(s=o.toBuffer(s)).toString("hex")||r.allowZero||(s=t.allocUnsafe(0)),r.allowLess&&r.length?(s=o.stripZeros(s),n(r.length>=s.length,"The field "+r.name+" must not have more "+r.length+" bytes")):r.allowZero&&0===s.length||!r.length||n(r.length===s.length,"The field "+r.name+" must have byte length of "+r.length),e.raw[i]=s}e._fields.push(r.name),Object.defineProperty(e,r.name,{enumerable:!0,configurable:!0,get:s,set:a}),r.default&&(e[r.name]=r.default),r.alias&&Object.defineProperty(e,r.alias,{enumerable:!1,configurable:!0,set:a,get:s})})),a)if("string"==typeof a&&(a=t.from(i.stripHexPrefix(a),"hex")),t.isBuffer(a)&&(a=s.decode(a)),Array.isArray(a)){if(a.length>e._fields.length)throw new Error("wrong number of fields in data");a.forEach((function(t,r){e[e._fields[r]]=o.toBuffer(t)}))}else{if("object"!=typeof a)throw new Error("invalid data");var u=Object.keys(a);r.forEach((function(t){-1!==u.indexOf(t.name)&&(e[t.name]=a[t.name]),-1!==u.indexOf(t.alias)&&(e[t.alias]=a[t.alias])}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/node_modules/ethereumjs-util/dist/object.js"}],[2423,{"./secp256k1v3-lib/der":2424,"./secp256k1v3-lib/index":2425,buffer:2081,"ethereum-cryptography/secp256k1":2498},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.ecdhUnsafe=r.ecdh=r.recover=r.verify=r.sign=r.signatureImportLax=r.signatureImport=r.signatureExport=r.signatureNormalize=r.publicKeyCombine=r.publicKeyTweakMul=r.publicKeyTweakAdd=r.publicKeyVerify=r.publicKeyConvert=r.publicKeyCreate=r.privateKeyTweakMul=r.privateKeyTweakAdd=r.privateKeyModInverse=r.privateKeyNegate=r.privateKeyImport=r.privateKeyExport=r.privateKeyVerify=void 0;var n=e("ethereum-cryptography/secp256k1"),i=e("./secp256k1v3-lib/index"),s=e("./secp256k1v3-lib/der");r.privateKeyVerify=function(e){return 32===e.length&&n.privateKeyVerify(Uint8Array.from(e))},r.privateKeyExport=function(e,t){if(32!==e.length)throw new RangeError("private key length is invalid");var r=i.privateKeyExport(e,t);return s.privateKeyExport(e,r,t)},r.privateKeyImport=function(e){if(null!==(e=s.privateKeyImport(e))&&32===e.length&&r.privateKeyVerify(e))return e;throw new Error("couldn't import from DER format")},r.privateKeyNegate=function(e){return t.from(n.privateKeyNegate(Uint8Array.from(e)))},r.privateKeyModInverse=function(e){if(32!==e.length)throw new Error("private key length is invalid");return t.from(i.privateKeyModInverse(Uint8Array.from(e)))},r.privateKeyTweakAdd=function(e,r){return t.from(n.privateKeyTweakAdd(Uint8Array.from(e),r))},r.privateKeyTweakMul=function(e,r){return t.from(n.privateKeyTweakMul(Uint8Array.from(e),Uint8Array.from(r)))},r.publicKeyCreate=function(e,r){return t.from(n.publicKeyCreate(Uint8Array.from(e),r))},r.publicKeyConvert=function(e,r){return t.from(n.publicKeyConvert(Uint8Array.from(e),r))},r.publicKeyVerify=function(e){return(33===e.length||65===e.length)&&n.publicKeyVerify(Uint8Array.from(e))},r.publicKeyTweakAdd=function(e,r,i){return t.from(n.publicKeyTweakAdd(Uint8Array.from(e),Uint8Array.from(r),i))},r.publicKeyTweakMul=function(e,r,i){return t.from(n.publicKeyTweakMul(Uint8Array.from(e),Uint8Array.from(r),i))},r.publicKeyCombine=function(e,r){var i=[];return e.forEach((function(e){i.push(Uint8Array.from(e))})),t.from(n.publicKeyCombine(i,r))},r.signatureNormalize=function(e){return t.from(n.signatureNormalize(Uint8Array.from(e)))},r.signatureExport=function(e){return t.from(n.signatureExport(Uint8Array.from(e)))},r.signatureImport=function(e){return t.from(n.signatureImport(Uint8Array.from(e)))},r.signatureImportLax=function(e){if(0===e.length)throw new RangeError("signature length is invalid");var t=s.signatureImportLax(e);if(null===t)throw new Error("couldn't parse DER signature");return i.signatureImport(t)},r.sign=function(e,r,i){if(null===i)throw new TypeError("options should be an Object");var s=undefined;if(i){if(s={},null===i.data)throw new TypeError("options.data should be a Buffer");if(i.data){if(32!=i.data.length)throw new RangeError("options.data length is invalid");s.data=new Uint8Array(i.data)}if(null===i.noncefn)throw new TypeError("options.noncefn should be a Function");i.noncefn&&(s.noncefn=function(e,r,n,s,o){var a=null!=n?t.from(n):null,u=null!=s?t.from(s):null,c=t.from("");return i.noncefn&&(c=i.noncefn(t.from(e),t.from(r),a,u,o)),new Uint8Array(c)})}var o=n.ecdsaSign(Uint8Array.from(e),Uint8Array.from(r),s);return{signature:t.from(o.signature),recovery:o.recid}},r.verify=function(e,t,r){return n.ecdsaVerify(Uint8Array.from(t),Uint8Array.from(e),r)},r.recover=function(e,r,i,s){return t.from(n.ecdsaRecover(Uint8Array.from(r),i,Uint8Array.from(e),s))},r.ecdh=function(e,r){return t.from(n.ecdh(Uint8Array.from(e),Uint8Array.from(r),{}))},r.ecdhUnsafe=function(e,r,n){if(33!==e.length&&65!==e.length)throw new RangeError("public key length is invalid");if(32!==r.length)throw new RangeError("private key length is invalid");return t.from(i.ecdhUnsafe(Uint8Array.from(e),Uint8Array.from(r),n))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/node_modules/ethereumjs-util/dist/secp256k1v3-adapter.js"}],[2424,{buffer:2081},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=e.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r.privateKeyExport=function(r,i,s){void 0===s&&(s=!0);var o=e.from(s?t:n);return r.copy(o,s?8:9),i.copy(o,s?181:214),o},r.privateKeyImport=function(e){var t=e.length,r=0;if(t<r+1||48!==e[r])return null;if(t<(r+=1)+1||!(128&e[r]))return null;var n=127&e[r];if(n<1||n>2)return null;if(t<(r+=1)+n)return null;var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);return t<(r+=n)+i||t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2]||t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]?null:e.slice(r+2,r+2+e[r+1])},r.signatureImportLax=function(t){var r=e.alloc(32,0),n=e.alloc(32,0),i=t.length,s=0;if(48!==t[s++])return null;var o=t[s++];if(128&o&&(s+=o-128)>i)return null;if(2!==t[s++])return null;var a=t[s++];if(128&a){if(s+(o=a-128)>i)return null;for(;o>0&&0===t[s];s+=1,o-=1);for(a=0;o>0;s+=1,o-=1)a=(a<<8)+t[s]}if(a>i-s)return null;var u=s;if(s+=a,2!==t[s++])return null;var c=t[s++];if(128&c){if(s+(o=c-128)>i)return null;for(;o>0&&0===t[s];s+=1,o-=1);for(c=0;o>0;s+=1,o-=1)c=(c<<8)+t[s]}if(c>i-s)return null;var h=s;for(s+=c;a>0&&0===t[u];a-=1,u+=1);if(a>32)return null;var l=t.slice(u,u+a);for(l.copy(r,32-l.length);c>0&&0===t[h];c-=1,h+=1);if(c>32)return null;var f=t.slice(h,h+c);return f.copy(n,32-f.length),{r:r,s:n}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/node_modules/ethereumjs-util/dist/secp256k1v3-lib/der.js"}],[2425,{"bn.js":2037,buffer:2081,elliptic:2315},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=e("bn.js"),i=new(0,e("elliptic").ec)("secp256k1"),s=i.curve;r.privateKeyExport=function(e,t){void 0===t&&(t=!0);var r=new n(e);if(r.ucmp(s.n)>=0)throw new Error("couldn't export to DER format");var a=i.g.mul(r);return o(a.getX(),a.getY(),t)},r.privateKeyModInverse=function(e){var r=new n(e);if(r.ucmp(s.n)>=0||r.isZero())throw new Error("private key range is invalid");return r.invm(s.n).toArrayLike(t,"be",32)},r.signatureImport=function(e){var r=new n(e.r);r.ucmp(s.n)>=0&&(r=new n(0));var i=new n(e.s);return i.ucmp(s.n)>=0&&(i=new n(0)),t.concat([r.toArrayLike(t,"be",32),i.toArrayLike(t,"be",32)])},r.ecdhUnsafe=function(e,t,r){void 0===r&&(r=!0);var a=i.keyFromPublic(e),u=new n(t);if(u.ucmp(s.n)>=0||u.isZero())throw new Error("scalar was invalid (zero or overflow)");var c=a.pub.mul(u);return o(c.getX(),c.getY(),r)};var o=function(e,r,n){var i;return n?((i=t.alloc(33))[0]=r.isOdd()?3:2,e.toArrayLike(t,"be",32).copy(i,1)):((i=t.alloc(65))[0]=4,e.toArrayLike(t,"be",32).copy(i,1),r.toArrayLike(t,"be",32).copy(i,33)),i}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/node_modules/ethereumjs-util/dist/secp256k1v3-lib/index.js"}],[2426,{"./bytes":2418,"./hash":2420,"./secp256k1v3-adapter":2423,"bn.js":2037,buffer:2081},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;var n=e("./secp256k1v3-adapter"),i=e("bn.js"),s=e("./bytes"),o=e("./hash");function a(e,t){return t?e-(2*t+35):e-27}function u(e){return 0===e||1===e}r.ecsign=function(e,t,r){var i=n.sign(e,t),s=i.recovery;return{r:i.signature.slice(0,32),s:i.signature.slice(32,64),v:r?s+(2*r+35):s+27}},r.ecrecover=function(e,r,i,o,c){var h=t.concat([s.setLength(i,32),s.setLength(o,32)],64),l=a(r,c);if(!u(l))throw new Error("Invalid signature v value");var f=n.recover(e,h,l);return n.publicKeyConvert(f,!1).slice(1)},r.toRpcSig=function(e,r,n,i){if(!u(a(e,i)))throw new Error("Invalid signature v value");return s.bufferToHex(t.concat([s.setLengthLeft(r,32),s.setLengthLeft(n,32),s.toBuffer(e)]))},r.fromRpcSig=function(e){var t=s.toBuffer(e);if(65!==t.length)throw new Error("Invalid signature length");var r=t[64];return r<27&&(r+=27),{v:r,r:t.slice(0,32),s:t.slice(32,64)}},r.isValidSignature=function(e,t,r,n,s){void 0===n&&(n=!0);var o=new i("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),c=new i("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(32!==t.length||32!==r.length)return!1;if(!u(a(e,s)))return!1;var h=new i(t),l=new i(r);return!(h.isZero()||h.gt(c)||l.isZero()||l.gt(c))&&(!n||1!==l.cmp(o))},r.hashPersonalMessage=function(e){var r=t.from("Ethereum Signed Message:\n"+e.length.toString(),"utf-8");return o.keccak(t.concat([r,e]))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/node_modules/ethereumjs-util/dist/signature.js"}],[2427,{assert:1700,"bn.js":2037,"create-hash":2185,"ethjs-util":2428,keccak:2429,rlp:5737,"safe-buffer":5739,secp256k1:2436},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("keccak"),s=e("secp256k1"),o=e("assert"),a=e("rlp"),u=e("bn.js"),c=e("create-hash"),h=e("safe-buffer").Buffer;Object.assign(r,e("ethjs-util")),r.MAX_INTEGER=new u("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new u("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.SHA3_NULL_S=r.KECCAK256_NULL_S,r.KECCAK256_NULL=h.from(r.KECCAK256_NULL_S,"hex"),r.SHA3_NULL=r.KECCAK256_NULL,r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.SHA3_RLP_ARRAY_S=r.KECCAK256_RLP_ARRAY_S,r.KECCAK256_RLP_ARRAY=h.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.SHA3_RLP_ARRAY=r.KECCAK256_RLP_ARRAY,r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.SHA3_RLP_S=r.KECCAK256_RLP_S,r.KECCAK256_RLP=h.from(r.KECCAK256_RLP_S,"hex"),r.SHA3_RLP=r.KECCAK256_RLP,r.BN=u,r.rlp=a,r.secp256k1=s,r.zeros=function(e){return h.allocUnsafe(e).fill(0)},r.zeroAddress=function(){var e=r.zeros(20);return r.bufferToHex(e)},r.setLengthLeft=r.setLength=function(e,t,n){var i=r.zeros(t);return e=r.toBuffer(e),n?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)},r.setLengthRight=function(e,t){return r.setLength(e,t,!0)},r.unpad=r.stripZeros=function(e){for(var t=(e=r.stripHexPrefix(e))[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e},r.toBuffer=function(e){if(!h.isBuffer(e))if(Array.isArray(e))e=h.from(e);else if("string"==typeof e)e=r.isHexString(e)?h.from(r.padToEven(r.stripHexPrefix(e)),"hex"):h.from(e);else if("number"==typeof e)e=r.intToBuffer(e);else if(null===e||e===undefined)e=h.allocUnsafe(0);else if(u.isBN(e))e=e.toArrayLike(h);else{if(!e.toArray)throw new Error("invalid type");e=h.from(e.toArray())}return e},r.bufferToInt=function(e){return new u(r.toBuffer(e)).toNumber()},r.bufferToHex=function(e){return"0x"+(e=r.toBuffer(e)).toString("hex")},r.fromSigned=function(e){return new u(e).fromTwos(256)},r.toUnsigned=function(e){return h.from(e.toTwos(256).toArray())},r.keccak=function(e,t){return e=r.toBuffer(e),t||(t=256),i("keccak"+t).update(e).digest()},r.keccak256=function(e){return r.keccak(e)},r.sha3=r.keccak,r.sha256=function(e){return e=r.toBuffer(e),c("sha256").update(e).digest()},r.ripemd160=function(e,t){e=r.toBuffer(e);var n=c("rmd160").update(e).digest();return!0===t?r.setLength(n,32):n},r.rlphash=function(e){return r.keccak(a.encode(e))},r.isValidPrivate=function(e){return s.privateKeyVerify(e)},r.isValidPublic=function(e,t){return 64===e.length?s.publicKeyVerify(h.concat([h.from([4]),e])):!!t&&s.publicKeyVerify(e)},r.pubToAddress=r.publicToAddress=function(e,t){return e=r.toBuffer(e),t&&64!==e.length&&(e=s.publicKeyConvert(e,!1).slice(1)),o(64===e.length),r.keccak(e).slice(-20)};var l=r.privateToPublic=function(e){return e=r.toBuffer(e),s.publicKeyCreate(e,!1).slice(1)};r.importPublic=function(e){return 64!==(e=r.toBuffer(e)).length&&(e=s.publicKeyConvert(e,!1).slice(1)),e},r.ecsign=function(e,t){var r=s.sign(e,t),n={};return n.r=r.signature.slice(0,32),n.s=r.signature.slice(32,64),n.v=r.recovery+27,n},r.hashPersonalMessage=function(e){var t=r.toBuffer("Ethereum Signed Message:\n"+e.length.toString());return r.keccak(h.concat([t,e]))},r.ecrecover=function(e,t,n,i){var o=h.concat([r.setLength(n,32),r.setLength(i,32)],64),a=t-27;if(0!==a&&1!==a)throw new Error("Invalid signature v value");var u=s.recover(e,o,a);return s.publicKeyConvert(u,!1).slice(1)},r.toRpcSig=function(e,t,n){if(27!==e&&28!==e)throw new Error("Invalid recovery id");return r.bufferToHex(h.concat([r.setLengthLeft(t,32),r.setLengthLeft(n,32),r.toBuffer(e-27)]))},r.fromRpcSig=function(e){if(65!==(e=r.toBuffer(e)).length)throw new Error("Invalid signature length");var t=e[64];return t<27&&(t+=27),{v:t,r:e.slice(0,32),s:e.slice(32,64)}},r.privateToAddress=function(e){return r.publicToAddress(l(e))},r.isValidAddress=function(e){return/^0x[0-9a-fA-F]{40}$/.test(e)},r.isZeroAddress=function(e){return r.zeroAddress()===r.addHexPrefix(e)},r.toChecksumAddress=function(e){e=r.stripHexPrefix(e).toLowerCase();for(var t=r.keccak(e).toString("hex"),n="0x",i=0;i<e.length;i++)parseInt(t[i],16)>=8?n+=e[i].toUpperCase():n+=e[i];return n},r.isValidChecksumAddress=function(e){return r.isValidAddress(e)&&r.toChecksumAddress(e)===e},r.generateAddress=function(e,t){return e=r.toBuffer(e),t=(t=new u(t)).isZero()?null:h.from(t.toArray()),r.rlphash([e,t]).slice(-20)},r.isPrecompiled=function(e){var t=r.unpad(e);return 1===t.length&&t[0]>=1&&t[0]<=8},r.addHexPrefix=function(e){return"string"!=typeof e||r.isHexPrefixed(e)?e:"0x"+e},r.isValidSignature=function(e,t,r,n){var i=new u("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),s=new u("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);return 32===t.length&&32===r.length&&((27===e||28===e)&&(t=new u(t),r=new u(r),!(t.isZero()||t.gt(s)||r.isZero()||r.gt(s))&&(!1!==n||1!==new u(r).cmp(i))))},r.baToJSON=function(e){if(h.isBuffer(e))return"0x"+e.toString("hex");if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(r.baToJSON(e[n]));return t}},r.defineProperties=function(e,t,i){if(e.raw=[],e._fields=[],e.toJSON=function(t){if(t){var n={};return e._fields.forEach((function(t){n[t]="0x"+e[t].toString("hex")})),n}return r.baToJSON(this.raw)},e.serialize=function(){return a.encode(e.raw)},t.forEach((function(t,n){function i(){return e.raw[n]}function s(i){"00"!==(i=r.toBuffer(i)).toString("hex")||t.allowZero||(i=h.allocUnsafe(0)),t.allowLess&&t.length?(i=r.stripZeros(i),o(t.length>=i.length,"The field "+t.name+" must not have more "+t.length+" bytes")):t.allowZero&&0===i.length||!t.length||o(t.length===i.length,"The field "+t.name+" must have byte length of "+t.length),e.raw[n]=i}e._fields.push(t.name),Object.defineProperty(e,t.name,{enumerable:!0,configurable:!0,get:i,set:s}),t.default&&(e[t.name]=t.default),t.alias&&Object.defineProperty(e,t.alias,{enumerable:!1,configurable:!0,set:s,get:i})})),i)if("string"==typeof i&&(i=h.from(r.stripHexPrefix(i),"hex")),h.isBuffer(i)&&(i=a.decode(i)),Array.isArray(i)){if(i.length>e._fields.length)throw new Error("wrong number of fields in data");i.forEach((function(t,n){e[e._fields[n]]=r.toBuffer(t)}))}else{if("object"!==(void 0===i?"undefined":n(i)))throw new Error("invalid data");var s=Object.keys(i);t.forEach((function(t){-1!==s.indexOf(t.name)&&(e[t.name]=i[t.name]),-1!==s.indexOf(t.alias)&&(e[t.alias]=i[t.alias])}))}}}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-util/dist/index.js"}],[2428,{buffer:2081,"is-hex-prefixed":4694,"strip-hex-prefix":5899},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("is-hex-prefixed"),i=e("strip-hex-prefix");function s(e){var t=e;if("string"!=typeof t)throw new Error("[ethjs-util] while padding to even, value must be string, is currently "+typeof t+", while padToEven.");return t.length%2&&(t="0"+t),t}function o(e){return"0x"+e.toString(16)}t.exports={arrayContainsArray:function(e,t,r){if(!0!==Array.isArray(e))throw new Error("[ethjs-util] method arrayContainsArray requires input 'superset' to be an array got type '"+typeof e+"'");if(!0!==Array.isArray(t))throw new Error("[ethjs-util] method arrayContainsArray requires input 'subset' to be an array got type '"+typeof t+"'");return t[Boolean(r)?"some":"every"]((function(t){return e.indexOf(t)>=0}))},intToBuffer:function(e){var t=o(e);return new r(s(t.slice(2)),"hex")},getBinarySize:function(e){if("string"!=typeof e)throw new Error("[ethjs-util] while getting binary size, method getBinarySize requires input 'str' to be type String, got '"+typeof e+"'.");return r.byteLength(e,"utf8")},isHexPrefixed:n,stripHexPrefix:i,padToEven:s,intToHex:o,fromAscii:function(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r).toString(16);t+=n.length<2?"0"+n:n}return"0x"+t},fromUtf8:function(e){return"0x"+s(new r(e,"utf8").toString("hex")).replace(/^0+|0+$/g,"")},toAscii:function(e){var t="",r=0,n=e.length;for("0x"===e.substring(0,2)&&(r=2);r<n;r+=2){var i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t},toUtf8:function(e){return new r(s(i(e).replace(/^0+|0+$/g,"")),"hex").toString("utf8")},getKeys:function(e,t,r){if(!Array.isArray(e))throw new Error("[ethjs-util] method getKeys expecting type Array as 'params' input, got '"+typeof e+"'");if("string"!=typeof t)throw new Error("[ethjs-util] method getKeys expecting type String for input 'key' got '"+typeof t+"'.");for(var n=[],i=0;i<e.length;i++){var s=e[i][t];if(r&&!s)s="";else if("string"!=typeof s)throw new Error("invalid abi");n.push(s)}return n},isHexString:function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/ethjs-util/lib/index.js"}],[2429,{"./lib/api":2430,"./lib/keccak":2434},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib/api")(e("./lib/keccak"))}}},{package:"keccak",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/keccak/js.js"}],[243,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a||s>49)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(127&n)<<s:(127&n)*Math.pow(2,s),s+=7}while(n>=128);return e.bytes=o-r,i}}}},{package:"varint",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multicodec/node_modules/varint/decode.js"}],[2430,{"./keccak":2431,"./shake":2432},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./keccak"),i=e("./shake");t.exports=function(e){var t=n(e),r=i(e);return function(e,n){switch("string"==typeof e?e.toLowerCase():e){case"keccak224":return new t(1152,448,null,224,n);case"keccak256":return new t(1088,512,null,256,n);case"keccak384":return new t(832,768,null,384,n);case"keccak512":return new t(576,1024,null,512,n);case"sha3-224":return new t(1152,448,6,224,n);case"sha3-256":return new t(1088,512,6,256,n);case"sha3-384":return new t(832,768,6,384,n);case"sha3-512":return new t(576,1024,6,512,n);case"shake128":return new r(1344,256,31,n);case"shake256":return new r(1088,512,31,n);default:throw new Error("Invald algorithm: "+e)}}}}}},{package:"keccak",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/keccak/lib/api/index.js"}],[2431,{inherits:4404,"safe-buffer":5739,stream:2084},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=e("stream").Transform,s=e("inherits");t.exports=function(e){function t(t,r,n,s,o){i.call(this,o),this._rate=t,this._capacity=r,this._delimitedSuffix=n,this._hashBitLength=s,this._options=o,this._state=new e,this._state.initialize(t,r),this._finalized=!1}return s(t,i),t.prototype._transform=function(e,t,r){var n=null;try{this.update(e,t)}catch(e){n=e}r(n)},t.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(e){t=e}e(t)},t.prototype.update=function(e,t){if(!n.isBuffer(e)&&"string"!=typeof e)throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Digest already called");return n.isBuffer(e)||(e=n.from(e,t)),this._state.absorb(e),this},t.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0,this._delimitedSuffix&&this._state.absorbLastFewBits(this._delimitedSuffix);var t=this._state.squeeze(this._hashBitLength/8);return e!==undefined&&(t=t.toString(e)),this._resetState(),t},t.prototype._resetState=function(){return this._state.initialize(this._rate,this._capacity),this},t.prototype._clone=function(){var e=new t(this._rate,this._capacity,this._delimitedSuffix,this._hashBitLength,this._options);return this._state.copy(e._state),e._finalized=this._finalized,e},t}}}},{package:"keccak",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/keccak/lib/api/keccak.js"}],[2432,{inherits:4404,"safe-buffer":5739,stream:2084},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=e("stream").Transform,s=e("inherits");t.exports=function(e){function t(t,r,n,s){i.call(this,s),this._rate=t,this._capacity=r,this._delimitedSuffix=n,this._options=s,this._state=new e,this._state.initialize(t,r),this._finalized=!1}return s(t,i),t.prototype._transform=function(e,t,r){var n=null;try{this.update(e,t)}catch(e){n=e}r(n)},t.prototype._flush=function(){},t.prototype._read=function(e){this.push(this.squeeze(e))},t.prototype.update=function(e,t){if(!n.isBuffer(e)&&"string"!=typeof e)throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Squeeze already called");return n.isBuffer(e)||(e=n.from(e,t)),this._state.absorb(e),this},t.prototype.squeeze=function(e,t){this._finalized||(this._finalized=!0,this._state.absorbLastFewBits(this._delimitedSuffix));var r=this._state.squeeze(e);return t!==undefined&&(r=r.toString(t)),r},t.prototype._resetState=function(){return this._state.initialize(this._rate,this._capacity),this},t.prototype._clone=function(){var e=new t(this._rate,this._capacity,this._delimitedSuffix,this._options);return this._state.copy(e._state),e._finalized=this._finalized,e},t}}}},{package:"keccak",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/keccak/lib/api/shake.js"}],[2433,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648];r.p1600=function(e){for(var t=0;t<24;++t){var r=e[0]^e[10]^e[20]^e[30]^e[40],i=e[1]^e[11]^e[21]^e[31]^e[41],s=e[2]^e[12]^e[22]^e[32]^e[42],o=e[3]^e[13]^e[23]^e[33]^e[43],a=e[4]^e[14]^e[24]^e[34]^e[44],u=e[5]^e[15]^e[25]^e[35]^e[45],c=e[6]^e[16]^e[26]^e[36]^e[46],h=e[7]^e[17]^e[27]^e[37]^e[47],l=e[8]^e[18]^e[28]^e[38]^e[48],f=e[9]^e[19]^e[29]^e[39]^e[49],d=l^(s<<1|o>>>31),p=f^(o<<1|s>>>31),m=e[0]^d,g=e[1]^p,y=e[10]^d,v=e[11]^p,w=e[20]^d,b=e[21]^p,_=e[30]^d,E=e[31]^p,k=e[40]^d,A=e[41]^p;d=r^(a<<1|u>>>31),p=i^(u<<1|a>>>31);var T=e[2]^d,S=e[3]^p,x=e[12]^d,P=e[13]^p,I=e[22]^d,M=e[23]^p,C=e[32]^d,L=e[33]^p,N=e[42]^d,B=e[43]^p;d=s^(c<<1|h>>>31),p=o^(h<<1|c>>>31);var R=e[4]^d,O=e[5]^p,j=e[14]^d,D=e[15]^p,U=e[24]^d,F=e[25]^p,K=e[34]^d,V=e[35]^p,G=e[44]^d,H=e[45]^p;d=a^(l<<1|f>>>31),p=u^(f<<1|l>>>31);var Y=e[6]^d,q=e[7]^p,z=e[16]^d,W=e[17]^p,$=e[26]^d,Z=e[27]^p,J=e[36]^d,Q=e[37]^p,X=e[46]^d,ee=e[47]^p;d=c^(r<<1|i>>>31),p=h^(i<<1|r>>>31);var te=e[8]^d,re=e[9]^p,ne=e[18]^d,ie=e[19]^p,se=e[28]^d,oe=e[29]^p,ae=e[38]^d,ue=e[39]^p,ce=e[48]^d,he=e[49]^p,le=m,fe=g,de=v<<4|y>>>28,pe=y<<4|v>>>28,me=w<<3|b>>>29,ge=b<<3|w>>>29,ye=E<<9|_>>>23,ve=_<<9|E>>>23,we=k<<18|A>>>14,be=A<<18|k>>>14,_e=T<<1|S>>>31,Ee=S<<1|T>>>31,ke=P<<12|x>>>20,Ae=x<<12|P>>>20,Te=I<<10|M>>>22,Se=M<<10|I>>>22,xe=L<<13|C>>>19,Pe=C<<13|L>>>19,Ie=N<<2|B>>>30,Me=B<<2|N>>>30,Ce=O<<30|R>>>2,Le=R<<30|O>>>2,Ne=j<<6|D>>>26,Be=D<<6|j>>>26,Re=F<<11|U>>>21,Oe=U<<11|F>>>21,je=K<<15|V>>>17,De=V<<15|K>>>17,Ue=H<<29|G>>>3,Fe=G<<29|H>>>3,Ke=Y<<28|q>>>4,Ve=q<<28|Y>>>4,Ge=W<<23|z>>>9,He=z<<23|W>>>9,Ye=$<<25|Z>>>7,qe=Z<<25|$>>>7,ze=J<<21|Q>>>11,We=Q<<21|J>>>11,$e=ee<<24|X>>>8,Ze=X<<24|ee>>>8,Je=te<<27|re>>>5,Qe=re<<27|te>>>5,Xe=ne<<20|ie>>>12,et=ie<<20|ne>>>12,tt=oe<<7|se>>>25,rt=se<<7|oe>>>25,nt=ae<<8|ue>>>24,it=ue<<8|ae>>>24,st=ce<<14|he>>>18,ot=he<<14|ce>>>18;e[0]=le^~ke&Re,e[1]=fe^~Ae&Oe,e[10]=Ke^~Xe&me,e[11]=Ve^~et&ge,e[20]=_e^~Ne&Ye,e[21]=Ee^~Be&qe,e[30]=Je^~de&Te,e[31]=Qe^~pe&Se,e[40]=Ce^~Ge&tt,e[41]=Le^~He&rt,e[2]=ke^~Re&ze,e[3]=Ae^~Oe&We,e[12]=Xe^~me&xe,e[13]=et^~ge&Pe,e[22]=Ne^~Ye&nt,e[23]=Be^~qe&it,e[32]=de^~Te&je,e[33]=pe^~Se&De,e[42]=Ge^~tt&ye,e[43]=He^~rt&ve,e[4]=Re^~ze&st,e[5]=Oe^~We&ot,e[14]=me^~xe&Ue,e[15]=ge^~Pe&Fe,e[24]=Ye^~nt&we,e[25]=qe^~it&be,e[34]=Te^~je&$e,e[35]=Se^~De&Ze,e[44]=tt^~ye&Ie,e[45]=rt^~ve&Me,e[6]=ze^~st&le,e[7]=We^~ot&fe,e[16]=xe^~Ue&Ke,e[17]=Pe^~Fe&Ve,e[26]=nt^~we&_e,e[27]=it^~be&Ee,e[36]=je^~$e&Je,e[37]=De^~Ze&Qe,e[46]=ye^~Ie&Ce,e[47]=ve^~Me&Le,e[8]=st^~le&ke,e[9]=ot^~fe&Ae,e[18]=Ue^~Ke&Xe,e[19]=Fe^~Ve&et,e[28]=we^~_e&Ne,e[29]=be^~Ee&Be,e[38]=$e^~Je&de,e[39]=Ze^~Qe&pe,e[48]=Ie^~Ce&Ge,e[49]=Me^~Le&He,e[0]^=n[2*t],e[1]^=n[2*t+1]}}}}},{package:"keccak",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/keccak/lib/keccak-state-unroll.js"}],[2434,{"./keccak-state-unroll":2433,"safe-buffer":5739},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=e("./keccak-state-unroll");function s(){this.state=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.blockSize=null,this.count=0,this.squeezing=!1}s.prototype.initialize=function(e,t){for(var r=0;r<50;++r)this.state[r]=0;this.blockSize=e/8,this.count=0,this.squeezing=!1},s.prototype.absorb=function(e){for(var t=0;t<e.length;++t)this.state[~~(this.count/4)]^=e[t]<<this.count%4*8,this.count+=1,this.count===this.blockSize&&(i.p1600(this.state),this.count=0)},s.prototype.absorbLastFewBits=function(e){this.state[~~(this.count/4)]^=e<<this.count%4*8,0!=(128&e)&&this.count===this.blockSize-1&&i.p1600(this.state),this.state[~~((this.blockSize-1)/4)]^=128<<(this.blockSize-1)%4*8,i.p1600(this.state),this.count=0,this.squeezing=!0},s.prototype.squeeze=function(e){this.squeezing||this.absorbLastFewBits(1);for(var t=n.alloc(e),r=0;r<e;++r)t[r]=this.state[~~(this.count/4)]>>>this.count%4*8&255,this.count+=1,this.count===this.blockSize&&(i.p1600(this.state),this.count=0);return t},s.prototype.copy=function(e){for(var t=0;t<50;++t)e.state[t]=this.state[t];e.blockSize=this.blockSize,e.count=this.count,e.squeezing=this.squeezing},t.exports=s}}},{package:"keccak",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/keccak/lib/keccak.js"}],[2435,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=(e,t)=>function(){const r=t.promiseModule,n=new Array(arguments.length);for(let e=0;e<arguments.length;e++)n[e]=arguments[e];return new r(((r,i)=>{t.errorFirst?n.push((function(e,n){if(t.multiArgs){const t=new Array(arguments.length-1);for(let e=1;e<arguments.length;e++)t[e-1]=arguments[e];e?(t.unshift(e),i(t)):r(t)}else e?i(e):r(n)})):n.push((function(e){if(t.multiArgs){const e=new Array(arguments.length-1);for(let t=0;t<arguments.length;t++)e[t]=arguments[t];r(e)}else r(e)})),e.apply(this,n)}))};t.exports=(e,t)=>{t=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},t);const r=e=>{const r=t=>"string"==typeof t?e===t:t.test(e);return t.include?t.include.some(r):!t.exclude.some(r)};let i;i="function"==typeof e?function(){return t.excludeMain?e.apply(this,arguments):n(e,t).apply(this,arguments)}:Object.create(Object.getPrototypeOf(e));for(const s in e){const o=e[s];i[s]="function"==typeof o&&r(s)?n(o,t):o}return i}}}},{package:"pify",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/pify/index.js"}],[2436,{"./lib":2440,"./lib/elliptic":2439},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib")(e("./lib/elliptic"))}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/secp256k1/elliptic.js"}],[2437,{"../../../../is-buffer/index.js":4686},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){var t=Object.prototype.toString;r.isArray=function(e,t){if(!Array.isArray(e))throw TypeError(t)},r.isBoolean=function(e,r){if("[object Boolean]"!==t.call(e))throw TypeError(r)},r.isBuffer=function(t,r){if(!e.isBuffer(t))throw TypeError(r)},r.isFunction=function(e,r){if("[object Function]"!==t.call(e))throw TypeError(r)},r.isNumber=function(e,r){if("[object Number]"!==t.call(e))throw TypeError(r)},r.isObject=function(e,r){if("[object Object]"!==t.call(e))throw TypeError(r)},r.isBufferLength=function(e,t,r){if(e.length!==t)throw RangeError(r)},r.isBufferLength2=function(e,t,r,n){if(e.length!==t&&e.length!==r)throw RangeError(n)},r.isLengthGTZero=function(e,t){if(0===e.length)throw RangeError(t)},r.isNumberInInterval=function(e,t,r,n){if(e<=t||e>=r)throw RangeError(n)}}).call(this)}).call(this,{isBuffer:e("../../../../is-buffer/index.js")})}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/secp256k1/lib/assert.js"}],[2438,{bip66:1970,"safe-buffer":5739},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=e("bip66"),s=n.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),o=n.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r.privateKeyExport=function(e,t,r){var i=n.from(r?s:o);return e.copy(i,r?8:9),t.copy(i,r?181:214),i},r.privateKeyImport=function(e){var t=e.length,r=0;if(!(t<r+1||48!==e[r])&&!(t<(r+=1)+1)&&128&e[r]){var n=127&e[r];if(r+=1,!(n<1||n>2||t<r+n)){var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);if(!(t<(r+=n)+i||t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2]||t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]))return e.slice(r+2,r+2+e[r+1])}}},r.signatureExport=function(e){for(var t=n.concat([n.from([0]),e.r]),r=33,s=0;r>1&&0===t[s]&&!(128&t[s+1]);--r,++s);for(var o=n.concat([n.from([0]),e.s]),a=33,u=0;a>1&&0===o[u]&&!(128&o[u+1]);--a,++u);return i.encode(t.slice(s),o.slice(u))},r.signatureImport=function(e){var t=n.alloc(32,0),r=n.alloc(32,0);try{var s=i.decode(e);if(33===s.r.length&&0===s.r[0]&&(s.r=s.r.slice(1)),s.r.length>32)throw new Error("R length is too long");if(33===s.s.length&&0===s.s[0]&&(s.s=s.s.slice(1)),s.s.length>32)throw new Error("S length is too long")}catch(e){return}return s.r.copy(t,32-s.r.length),s.s.copy(r,32-s.s.length),{r:t,s:r}},r.signatureImportLax=function(e){var t=n.alloc(32,0),r=n.alloc(32,0),i=e.length,s=0;if(48===e[s++]){var o=e[s++];if(!(128&o&&(s+=o-128)>i)&&2===e[s++]){var a=e[s++];if(128&a){if(s+(o=a-128)>i)return;for(;o>0&&0===e[s];s+=1,o-=1);for(a=0;o>0;s+=1,o-=1)a=(a<<8)+e[s]}if(!(a>i-s)){var u=s;if(s+=a,2===e[s++]){var c=e[s++];if(128&c){if(s+(o=c-128)>i)return;for(;o>0&&0===e[s];s+=1,o-=1);for(c=0;o>0;s+=1,o-=1)c=(c<<8)+e[s]}if(!(c>i-s)){var h=s;for(s+=c;a>0&&0===e[u];a-=1,u+=1);if(!(a>32)){var l=e.slice(u,u+a);for(l.copy(t,32-l.length);c>0&&0===e[h];c-=1,h+=1);if(!(c>32)){var f=e.slice(h,h+c);return f.copy(r,32-f.length),{r:t,s:r}}}}}}}}}}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/secp256k1/lib/der.js"}],[2439,{"../messages.json":2441,"bn.js":2037,"create-hash":2185,elliptic:2315,"safe-buffer":5739},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=e("create-hash"),s=e("bn.js"),o=e("elliptic").ec,a=e("../messages.json"),u=new o("secp256k1"),c=u.curve;function h(e){var t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){var r=new s(t);if(r.cmp(c.p)>=0)return null;var n=(r=r.toRed(c.red)).redSqr().redIMul(r).redIAdd(c.b).redSqrt();return 3===e!==n.isOdd()&&(n=n.redNeg()),u.keyPair({pub:{x:r,y:n}})}(t,e.slice(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,r){var n=new s(t),i=new s(r);if(n.cmp(c.p)>=0||i.cmp(c.p)>=0)return null;if(n=n.toRed(c.red),i=i.toRed(c.red),(6===e||7===e)&&i.isOdd()!==(7===e))return null;var o=n.redSqr().redIMul(n);return i.redSqr().redISub(o.redIAdd(c.b)).isZero()?u.keyPair({pub:{x:n,y:i}}):null}(t,e.slice(1,33),e.slice(33,65));default:return null}}r.privateKeyVerify=function(e){var t=new s(e);return t.cmp(c.n)<0&&!t.isZero()},r.privateKeyExport=function(e,t){var r=new s(e);if(r.cmp(c.n)>=0||r.isZero())throw new Error(a.EC_PRIVATE_KEY_EXPORT_DER_FAIL);return n.from(u.keyFromPrivate(e).getPublic(t,!0))},r.privateKeyNegate=function(e){var t=new s(e);return t.isZero()?n.alloc(32):c.n.sub(t).umod(c.n).toArrayLike(n,"be",32)},r.privateKeyModInverse=function(e){var t=new s(e);if(t.cmp(c.n)>=0||t.isZero())throw new Error(a.EC_PRIVATE_KEY_RANGE_INVALID);return t.invm(c.n).toArrayLike(n,"be",32)},r.privateKeyTweakAdd=function(e,t){var r=new s(t);if(r.cmp(c.n)>=0)throw new Error(a.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);if(r.iadd(new s(e)),r.cmp(c.n)>=0&&r.isub(c.n),r.isZero())throw new Error(a.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);return r.toArrayLike(n,"be",32)},r.privateKeyTweakMul=function(e,t){var r=new s(t);if(r.cmp(c.n)>=0||r.isZero())throw new Error(a.EC_PRIVATE_KEY_TWEAK_MUL_FAIL);return r.imul(new s(e)),r.cmp(c.n)&&(r=r.umod(c.n)),r.toArrayLike(n,"be",32)},r.publicKeyCreate=function(e,t){var r=new s(e);if(r.cmp(c.n)>=0||r.isZero())throw new Error(a.EC_PUBLIC_KEY_CREATE_FAIL);return n.from(u.keyFromPrivate(e).getPublic(t,!0))},r.publicKeyConvert=function(e,t){var r=h(e);if(null===r)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);return n.from(r.getPublic(t,!0))},r.publicKeyVerify=function(e){return null!==h(e)},r.publicKeyTweakAdd=function(e,t,r){var i=h(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(c.n)>=0)throw new Error(a.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);var o=c.g.mul(t).add(i.pub);if(o.isInfinity())throw new Error(a.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);return n.from(o.encode(!0,r))},r.publicKeyTweakMul=function(e,t,r){var i=h(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(c.n)>=0||t.isZero())throw new Error(a.EC_PUBLIC_KEY_TWEAK_MUL_FAIL);return n.from(i.pub.mul(t).encode(!0,r))},r.publicKeyCombine=function(e,t){for(var r=new Array(e.length),i=0;i<e.length;++i)if(r[i]=h(e[i]),null===r[i])throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);for(var s=r[0].pub,o=1;o<r.length;++o)s=s.add(r[o].pub);if(s.isInfinity())throw new Error(a.EC_PUBLIC_KEY_COMBINE_FAIL);return n.from(s.encode(!0,t))},r.signatureNormalize=function(e){var t=new s(e.slice(0,32)),r=new s(e.slice(32,64));if(t.cmp(c.n)>=0||r.cmp(c.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);var i=n.from(e);return 1===r.cmp(u.nh)&&c.n.sub(r).toArrayLike(n,"be",32).copy(i,32),i},r.signatureExport=function(e){var t=e.slice(0,32),r=e.slice(32,64);if(new s(t).cmp(c.n)>=0||new s(r).cmp(c.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);return{r:t,s:r}},r.signatureImport=function(e){var t=new s(e.r);t.cmp(c.n)>=0&&(t=new s(0));var r=new s(e.s);return r.cmp(c.n)>=0&&(r=new s(0)),n.concat([t.toArrayLike(n,"be",32),r.toArrayLike(n,"be",32)])},r.sign=function(e,t,r,i){if("function"==typeof r){var o=r;r=function(r){var u=o(e,t,null,i,r);if(!n.isBuffer(u)||32!==u.length)throw new Error(a.ECDSA_SIGN_FAIL);return new s(u)}}var h=new s(t);if(h.cmp(c.n)>=0||h.isZero())throw new Error(a.ECDSA_SIGN_FAIL);var l=u.sign(e,t,{canonical:!0,k:r,pers:i});return{signature:n.concat([l.r.toArrayLike(n,"be",32),l.s.toArrayLike(n,"be",32)]),recovery:l.recoveryParam}},r.verify=function(e,t,r){var n={r:t.slice(0,32),s:t.slice(32,64)},i=new s(n.r),o=new s(n.s);if(i.cmp(c.n)>=0||o.cmp(c.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);if(1===o.cmp(u.nh)||i.isZero()||o.isZero())return!1;var l=h(r);if(null===l)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);return u.verify(e,n,{x:l.pub.x,y:l.pub.y})},r.recover=function(e,t,r,i){var o={r:t.slice(0,32),s:t.slice(32,64)},h=new s(o.r),l=new s(o.s);if(h.cmp(c.n)>=0||l.cmp(c.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);try{if(h.isZero()||l.isZero())throw new Error;var f=u.recoverPubKey(e,o,r);return n.from(f.encode(!0,i))}catch(e){throw new Error(a.ECDSA_RECOVER_FAIL)}},r.ecdh=function(e,t){var n=r.ecdhUnsafe(e,t,!0);return i("sha256").update(n).digest()},r.ecdhUnsafe=function(e,t,r){var i=h(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);var o=new s(t);if(o.cmp(c.n)>=0||o.isZero())throw new Error(a.ECDH_FAIL);return n.from(i.pub.mul(o).encode(!0,r))}}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/secp256k1/lib/elliptic/index.js"}],[244,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r,i){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");r=r||[];var s=i=i||0;for(;t>=n;)r[i++]=255&t|128,t/=128;for(;-128&t;)r[i++]=255&t|128,t>>>=7;return r[i]=0|t,e.bytes=i-s+1,r};var n=Math.pow(2,31)}}},{package:"varint",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multicodec/node_modules/varint/encode.js"}],[2440,{"./assert":2437,"./der":2438,"./messages.json":2441},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./assert"),i=e("./der"),s=e("./messages.json");function o(e,t){return e===undefined?t:(n.isBoolean(e,s.COMPRESSED_TYPE_INVALID),e)}t.exports=function(e){return{privateKeyVerify:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),32===t.length&&e.privateKeyVerify(t)},privateKeyExport:function(t,r){n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0);var a=e.privateKeyExport(t,r);return i.privateKeyExport(t,a,r)},privateKeyImport:function(t){if(n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),(t=i.privateKeyImport(t))&&32===t.length&&e.privateKeyVerify(t))return t;throw new Error(s.EC_PRIVATE_KEY_IMPORT_DER_FAIL)},privateKeyNegate:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyNegate(t)},privateKeyModInverse:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyModInverse(t)},privateKeyTweakAdd:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakAdd(t,r)},privateKeyTweakMul:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakMul(t,r)},publicKeyCreate:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyCreate(t,r)},publicKeyConvert:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyConvert(t,r)},publicKeyVerify:function(t){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),e.publicKeyVerify(t)},publicKeyTweakAdd:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakAdd(t,r,i)},publicKeyTweakMul:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakMul(t,r,i)},publicKeyCombine:function(t,r){n.isArray(t,s.EC_PUBLIC_KEYS_TYPE_INVALID),n.isLengthGTZero(t,s.EC_PUBLIC_KEYS_LENGTH_INVALID);for(var i=0;i<t.length;++i)n.isBuffer(t[i],s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t[i],33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID);return r=o(r,!0),e.publicKeyCombine(t,r)},signatureNormalize:function(t){return n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),e.signatureNormalize(t)},signatureExport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=e.signatureExport(t);return i.signatureExport(r)},signatureImport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImport(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},signatureImportLax:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImportLax(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},sign:function(t,r,i){n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID);var o=null,a=null;return i!==undefined&&(n.isObject(i,s.OPTIONS_TYPE_INVALID),i.data!==undefined&&(n.isBuffer(i.data,s.OPTIONS_DATA_TYPE_INVALID),n.isBufferLength(i.data,32,s.OPTIONS_DATA_LENGTH_INVALID),o=i.data),i.noncefn!==undefined&&(n.isFunction(i.noncefn,s.OPTIONS_NONCEFN_TYPE_INVALID),a=i.noncefn)),e.sign(t,r,a,o)},verify:function(t,r,i){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isBuffer(i,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(i,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),e.verify(t,r,i)},recover:function(t,r,i,a){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isNumber(i,s.RECOVERY_ID_TYPE_INVALID),n.isNumberInInterval(i,-1,4,s.RECOVERY_ID_VALUE_INVALID),a=o(a,!0),e.recover(t,r,i,a)},ecdh:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.ecdh(t,r)},ecdhUnsafe:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),i=o(i,!0),e.ecdhUnsafe(t,r,i)}}}}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/secp256k1/lib/index.js"}],[2441,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={COMPRESSED_TYPE_INVALID:"compressed should be a boolean",EC_PRIVATE_KEY_TYPE_INVALID:"private key should be a Buffer",EC_PRIVATE_KEY_LENGTH_INVALID:"private key length is invalid",EC_PRIVATE_KEY_RANGE_INVALID:"private key range is invalid",EC_PRIVATE_KEY_TWEAK_ADD_FAIL:"tweak out of range or resulting private key is invalid",EC_PRIVATE_KEY_TWEAK_MUL_FAIL:"tweak out of range",EC_PRIVATE_KEY_EXPORT_DER_FAIL:"couldn't export to DER format",EC_PRIVATE_KEY_IMPORT_DER_FAIL:"couldn't import from DER format",EC_PUBLIC_KEYS_TYPE_INVALID:"public keys should be an Array",EC_PUBLIC_KEYS_LENGTH_INVALID:"public keys Array should have at least 1 element",EC_PUBLIC_KEY_TYPE_INVALID:"public key should be a Buffer",EC_PUBLIC_KEY_LENGTH_INVALID:"public key length is invalid",EC_PUBLIC_KEY_PARSE_FAIL:"the public key could not be parsed or is invalid",EC_PUBLIC_KEY_CREATE_FAIL:"private was invalid, try again",EC_PUBLIC_KEY_TWEAK_ADD_FAIL:"tweak out of range or resulting public key is invalid",EC_PUBLIC_KEY_TWEAK_MUL_FAIL:"tweak out of range",EC_PUBLIC_KEY_COMBINE_FAIL:"the sum of the public keys is not valid",ECDH_FAIL:"scalar was invalid (zero or overflow)",ECDSA_SIGNATURE_TYPE_INVALID:"signature should be a Buffer",ECDSA_SIGNATURE_LENGTH_INVALID:"signature length is invalid",ECDSA_SIGNATURE_PARSE_FAIL:"couldn't parse signature",ECDSA_SIGNATURE_PARSE_DER_FAIL:"couldn't parse DER signature",ECDSA_SIGNATURE_SERIALIZE_DER_FAIL:"couldn't serialize signature to DER format",ECDSA_SIGN_FAIL:"nonce generation function failed or private key is invalid",ECDSA_RECOVER_FAIL:"couldn't recover public key from signature",MSG32_TYPE_INVALID:"message should be a Buffer",MSG32_LENGTH_INVALID:"message length is invalid",OPTIONS_TYPE_INVALID:"options should be an Object",OPTIONS_DATA_TYPE_INVALID:"options.data should be a Buffer",OPTIONS_DATA_LENGTH_INVALID:"options.data length is invalid",OPTIONS_NONCEFN_TYPE_INVALID:"options.noncefn should be a Function",RECOVERY_ID_TYPE_INVALID:"recovery should be a Number",RECOVERY_ID_VALUE_INVALID:"recovery should have value between -1 and 4",TWEAK_TYPE_INVALID:"tweak should be a Buffer",TWEAK_LENGTH_INVALID:"tweak length is invalid"}}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-json-rpc-middleware/node_modules/secp256k1/lib/messages.json"}],[2443,{"@ethereumjs/common":401,"@ethereumjs/tx":405,"bn.js":2444,buffer:2081,crypto:2191,"ethereumjs-util":2521,events:2082,"gridplus-sdk":4327,secp256k1:5750},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("crypto"),i=e("events").EventEmitter,s=e("bn.js"),o=e("gridplus-sdk"),a=e("@ethereumjs/tx"),u=(e("@ethereumjs/common").default,e("ethereumjs-util")),c=e("secp256k1"),h="Lattice Hardware",l=12e4;class f extends i{constructor(e={}){super(),this.type=h,this._resetDefaults(),this.deserialize(e)}async deserialize(e={}){e.hdPath&&(this.hdPath=e.hdPath),e.creds&&(this.creds=e.creds),e.accounts&&(this.accounts=e.accounts),e.accountIndices&&(this.accountIndices=e.accountIndices),e.accountOpts&&(this.accountOpts=e.accountOpts),e.walletUID&&(this.walletUID=e.walletUID),e.name&&(this.appName=e.name),e.appName&&(this.appName=e.appName),e.network&&(this.network=e.network),e.page&&(this.page=e.page),e.sdkState&&(this.sdkState=e.sdkState)}setHdPath(e){this.hdPath=e}async serialize(){return{creds:this.creds,accounts:this.accounts,accountIndices:this.accountIndices,accountOpts:this.accountOpts,walletUID:this.walletUID,appName:this.appName,name:this.name,network:this.network,page:this.page,hdPath:this.hdPath,sdkState:this.sdkSession?this.sdkSession.getStateData():null}}isUnlocked(){return!!this._getCurrentWalletUID()&&!!this.sdkSession}async unlock(e=!1){if(!this.accountOpts||this.accounts.length>0&&this.accountOpts.length!=this.accounts.length)throw this.forgetDevice(),new Error("You can now add multiple Lattice and SafeCard accounts at the same time! "+"Your accounts have been cleared. Please press Continue to add them back in.");if(this.isUnlocked())return"Unlocked";const t=await this._getCreds();t&&(this.creds.deviceID=t.deviceID,this.creds.password=t.password,this.creds.endpoint=t.endpoint||null);return await this._initSession()&&e||await this._connect(),"Unlocked"}async addAccounts(e=1){if(-1e3===e)return this.forgetDevice(),[];if(e<=0)throw new Error("Number of accounts to add must be a positive number.");await this.unlock();const t=await this._fetchAddresses(e,this.unlockedAccount),r=this._getCurrentWalletUID();if(!r)throw await this._connect(),new Error("No active wallet found in Lattice. Please retry.");return t.forEach(((e,t)=>{let n=!1;for(let t=0;t<this.accounts.length;t++)this.accounts[t]===e&&this.accountOpts[t].walletUID===r&&this.accountOpts[t].hdPath===this.hdPath&&(n=!0);n||(this.accounts.push(e),this.accountIndices.push(this.unlockedAccount+t),this.accountOpts.push({walletUID:r,hdPath:this.hdPath}))})),this.accounts}async getAccounts(){return this.accounts?[...this.accounts]:[]}async signTransaction(e,t){let r,n;const i=t.toJSON();i.type=t._type||null;const s=await this._findSignerIdx(e),c=p(t).toNumber(),h=this.sdkSession.getFwVersion(),l=this.accountIndices[s],{hdPath:f}=this.accountOpts[s];if(h.major>0||h.minor>=15){const e={payload:t._type?t.getMessageToSign(!1):rlp.encode(t.getMessageToSign(!1)),curveType:o.Constants.SIGNING.CURVES.SECP256K1,hashType:o.Constants.SIGNING.HASHES.KECCAK256,encodingType:o.Constants.SIGNING.ENCODINGS.EVM,signerPath:this._getHDPathIndices(f,l)};r=await this.sdkSession.sign({data:e}),n=d(t,r)}else{let e;try{switch(e={chainId:c,nonce:`0x${t.nonce.toString("hex")}`||0,gasLimit:`0x${t.gasLimit.toString("hex")}`,to:t.to?t.to.toString("hex"):null,value:`0x${t.value.toString("hex")}`,data:0===t.data.length?null:`0x${t.data.toString("hex")}`,signerPath:this._getHDPathIndices(f,l)},t._type){case 2:if(null===t.maxPriorityFeePerGas||null===t.maxFeePerGas||t.maxPriorityFeePerGas===undefined||t.maxFeePerGas===undefined)throw new Error("`maxPriorityFeePerGas` and `maxFeePerGas` must be included for EIP1559 transactions.");e.maxPriorityFeePerGas=`0x${t.maxPriorityFeePerGas.toString("hex")}`,e.maxFeePerGas=`0x${t.maxFeePerGas.toString("hex")}`,e.accessList=t.accessList||[],e.type=2;break;case 1:e.accessList=t.accessList||[],e.gasPrice=`0x${t.gasPrice.toString("hex")}`,e.type=1;break;default:e.gasPrice=`0x${t.gasPrice.toString("hex")}`,e.type=null}if(0===h.major&&h.minor<=11&&e.type)throw new Error("Please update Lattice firmware.")}catch(e){throw new Error("Failed to build transaction.")}if(r=await this.sdkSession.sign({currency:"ETH",data:e}),!r.sig||!r.sig.r||!r.sig.s)throw new Error("No signature returned.");n=r.sig.v===undefined?d(t,r):0===r.sig.v.length?"0":r.sig.v.toString("hex")}i.r=u.addHexPrefix(r.sig.r.toString("hex")),i.s=u.addHexPrefix(r.sig.s.toString("hex")),i.v=u.addHexPrefix(n);if(null===await this._accountIdxInCurrentWallet(e))throw new Error("Wrong account. Please change your Lattice wallet or "+"switch to an account on your current active wallet.");return a.TransactionFactory.fromTxData(i,{common:t.common,freeze:Object.isFrozen(t)})}async signPersonalMessage(e,t){return this.signMessage(e,{payload:t,protocol:"signPersonal"})}async signTypedData(e,t,r){if(r.version&&"V4"!==r.version&&"V3"!==r.version)throw new Error(`Only signTypedData V3 and V4 messages (EIP712) are supported. Got version ${r.version}`);return this.signMessage(e,{payload:t,protocol:"eip712"})}async signMessage(e,t){const r=await this._findSignerIdx(e);let{payload:n,protocol:i}=t;n&&i||(n=t,i="signPersonal");const s=this.accountIndices[r],o=this.accountOpts[r].hdPath,a={currency:"ETH_MSG",data:{protocol:i,payload:n,signerPath:this._getHDPathIndices(o,s)}},u=await this.sdkSession.sign(a);if(!u.sig)throw new Error("No signature returned");let c;try{c=u.sig.v.toString("hex"),c.length<2&&(c=`0${c}`)}catch(e){throw new Error("Invalid signature format returned.")}if(null===await this._accountIdxInCurrentWallet(e))throw new Error("Wrong account. Please change your Lattice wallet or "+"switch to an account on your current active wallet.");return`0x${u.sig.r}${u.sig.s}${c}`}async exportAccount(e){throw new Error("exportAccount not supported by this device")}removeAccount(e){this.accounts.forEach(((t,r)=>{if(t.toLowerCase()===e.toLowerCase())return this.accounts.splice(r,1),this.accountIndices.splice(r,1),void this.accountOpts.splice(r,1)}))}async getFirstPage(){return this.page=0,this._getPage(0)}async getNextPage(){return this._getPage(1)}async getPreviousPage(){return this._getPage(-1)}setAccountToUnlock(e){this.unlockedAccount=parseInt(e,10)}forgetDevice(){this._resetDefaults()}async _findSignerIdx(e){const t=this.isUnlocked();await this.unlock(!0);let r=await this._accountIdxInCurrentWallet(e);if(null!==r)return r;if(t&&(await this._connect(),r=await this._accountIdxInCurrentWallet(e),null!==r))return r;throw new Error("Account not found in active Lattice wallet. Please switch.")}async _accountIdxInCurrentWallet(e){const t=await this._findAccountByAddress(e),{walletUID:r}=this.accountOpts[t],n=this.sdkSession.getActiveWallet();if(!n)throw this._connect(),new Error("No active wallet in Lattice.");const i=n.uid.toString("hex");return r.toString("hex")===i?t:null}async _findAccountByAddress(e){const t=await this.getAccounts();let r=-1;if(t.forEach(((t,n)=>{e.toLowerCase()===t.toLowerCase()&&(r=n)})),r<0)throw new Error("Signer not present");return r}_getHDPathIndices(e,t=0){const r=e.split("/").slice(1),n=[];let i=!1;if(r.forEach((e=>{const r="'"===e[e.length-1];let s=r?2147483648:0;e.indexOf("x")>-1?(s+=t,i=!0):s+=Number(r?e.slice(0,e.length-1):e),n.push(s)})),!1===i&&n.push(t),n.length>5)throw new Error("Only HD paths with up to 5 indices are allowed.");return n}_resetDefaults(){this.accounts=[],this.accountIndices=[],this.accountOpts=[],this.isLocked=!0,this.creds={deviceID:null,password:null,endpoint:null},this.walletUID=null,this.sdkSession=null,this.page=0,this.unlockedAccount=0,this.network=null,this.hdPath="m/44'/60'/0'/0/x"}async _openConnectorTab(e){try{const t=window.open(e);if(t)return{chromium:t};if(browser&&browser.tabs&&browser.tabs.create){return{firefox:await browser.tabs.create({url:e})}}throw new Error("Unknown browser context. Cannot open Lattice connector.")}catch(e){throw new Error("Failed to open Lattice connector.")}}async _findTabById(e){return browser.tabs.query({}).forEach((t=>{if(t.id===e)return t})),null}_getCreds(){return new Promise(((e,t)=>{if(this._hasCreds())return e();const n=this.appName?this.appName:"Unknown",i="https://lattice.gridplus.io",s=`${i}?keyring=${n}&forceLogin=true`;let o;function a(r){if(r.origin===i)try{clearInterval(o);const n=JSON.parse(r.data);return n.deviceID&&n.password?e(n):t(new Error("Invalid credentials returned from Lattice."))}catch(e){return t(e)}}this._openConnectorTab(s).then((n=>{if(n.chromium)window.addEventListener("message",a,!1),o=setInterval((()=>{if(n.chromium.closed)return clearInterval(o),t(new Error("Lattice connector closed."))}),500);else if(n.firefox){const i="&loginCache=";o=setInterval((()=>{this._findTabById(n.firefox.id).then((n=>{if(!n||!n.url)return t(new Error("Lattice connector closed."));const s=n.url.indexOf(i);if(s<0)return;const a=s+i.length;clearInterval(o);try{const i=r.from(n.url.slice(a),"base64").toString();browser.tabs.remove(n.id).then((()=>{const r=JSON.parse(i);return r.deviceID&&r.password?e(r):t(new Error("Invalid credentials returned from Lattice."))}))}catch(e){return t("Failed to get login data from Lattice. Please try again.")}}))}),500)}}))}))}async _connect(){try{this.sdkSession.timeout=2e4,await this.sdkSession.connect(this.creds.deviceID)}finally{this.sdkSession.timeout=l}}async _initSession(){if(this.isUnlocked())return;let e="https://signing.gridpl.us";this.creds.endpoint&&(e=this.creds.endpoint);let t={name:this.appName,baseUrl:e,timeout:l,privKey:this._genSessionKey(),network:this.network,skipRetryOnWrongWallet:!0};return this.sdkSession=new o.Client(t),!!t.stateData}async _fetchAddresses(e=1,t=0,r=[]){if(!this.isUnlocked())throw new Error("No connection to Lattice. Cannot fetch addresses.");return this.__fetchAddresses(e,t)}async __fetchAddresses(e=1,t=0,r=[]){if(0===e)return r;const n=this._hdPathHasInternalVarIdx(),i={currency:"ETH",startPath:this._getHDPathIndices(this.hdPath,t),n:n?1:e},s=await this.sdkSession.getAddresses(i);if(s.length<1)throw new Error("No addresses returned");return n?await this.__fetchAddresses(e-1,t+1,r.concat(s)):s}async _getPage(e=0){try{this.page+=e,this.page<0&&(this.page=0);const t=5*this.page;await this.unlock();const r=await this._fetchAddresses(5,t);return r.map(((e,r)=>({address:e,balance:null,index:t+r})))}catch(e){try{await this._connect();return await this._getPage(0)}catch(e){throw new Error("Failed to get accounts. Please forget the device and try again. "+"Make sure you do not have a locked SafeCard inserted.")}}}_hasCreds(){return null!==this.creds.deviceID&&null!==this.creds.password&&this.appName}_genSessionKey(){if(this.name&&!this.appName&&(this.appName=this.name),!this._hasCreds())throw new Error("No credentials -- cannot create session key!");const e=r.concat([r.from(this.creds.password),r.from(this.creds.deviceID),r.from(this.appName)]);return n.createHash("sha256").update(e).digest()}_hdPathHasInternalVarIdx(){const e=this.hdPath.split("/").slice(1);for(let t=0;t<e.length-1;t++)if(e[t].indexOf("x")>-1)return!0;return!1}_getCurrentWalletUID(){if(!this.sdkSession)return null;const e=this.sdkSession.getActiveWallet();return e&&e.uid?e.uid.toString("hex"):null}}function d(e,t){const n=e.getMessageToSign(!0),i=new Uint8Array(r.concat([t.sig.r,t.sig.s])),o=new Uint8Array(t.pubkey),u=c.ecdsaRecover(i,0,n,!1),h=c.ecdsaRecover(i,1,n,!1),l=r.from(o).toString("hex"),f=r.from(u).toString("hex"),d=r.from(h).toString("hex");let m;if(l===f)m=0;else{if(l!==d)return null;m=1}if(e._type)return m.toString(16);const g=p(e);return e.supports(a.Capability.EIP155ReplayProtection)||e.common&&e.common.gteHardfork("spuriousDragon")?g.muln(2).addn(35).addn(m).toString("hex"):new s(m).addn(27).toString("hex")}function p(e){return e&&e.common&&"function"==typeof e.common.chainIdBN?e.common.chainIdBN():e&&e.chainId?new s(e.chainId):new s(1)}f.type=h,t.exports=f}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-lattice-keyring/index.js"}],[2444,{buffer:2080},function(){with(this)return function(){"use strict";return function(e,t,r){!function(t,r){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function s(e,t,r){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var o;"object"==typeof t?t.exports=s:r.BN=s,s.BN=s,s.wordSize=26;try{o="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:e("buffer").Buffer}catch(e){}function a(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+e)}function u(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function c(e,t,r,i){for(var s=0,o=0,a=Math.min(e.length,r),u=t;u<a;u++){var c=e.charCodeAt(u)-48;s*=i,o=c>=49?c-49+10:c>=17?c-17+10:c,n(c>=0&&o<i,"Invalid character"),s+=o}return s}function h(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return e.cmp(t)<0?e:t},s.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},s.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},s.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,o,a=0;if("be"===r)for(i=e.length-1,s=0;i>=0;i-=3)o=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);else if("le"===r)for(i=0,s=0;i<e.length;i+=3)o=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);return this._strip()},s.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,s=0,o=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=u(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=u(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;this._strip()},s.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var s=e.length-r,o=s%n,a=Math.min(s,s-o)+r,u=0,h=r;h<a;h+=n)u=c(e,h,h+n,t),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==o){var l=1;for(u=c(e,h,e.length,t),h=0;h<o;h++)l*=t;this.imuln(l),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this._strip()},s.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype._move=function(e){h(e,this)},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=l}catch(e){s.prototype.inspect=l}else s.prototype.inspect=l;function l(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,s=0,o=0;o<this.length;o++){var a=this.words[o],u=(16777215&(a<<i|s)).toString(16);r=0!==(s=a>>>24-i&16777215)||o!==this.length-1?f[6-u.length]+u+r:u+r,(i+=2)>=26&&(i-=26,o--)}for(0!==s&&(r=s.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=d[e],h=p[e];r="";var l=this.clone();for(l.negative=0;!l.isZero();){var m=l.modrn(h).toString(e);r=(l=l.idivn(h)).isZero()?m+r:f[c-m.length]+m+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16,2)},o&&(s.prototype.toBuffer=function(e,t){return this.toArrayLike(o,e,t)}),s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)};function m(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],s=0|t.words[0],o=i*s,a=67108863&o,u=o/67108864|0;r.words[0]=a;for(var c=1;c<n;c++){for(var h=u>>>26,l=67108863&u,f=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=f;d++){var p=c-d|0;h+=(o=(i=0|e.words[p])*(s=0|t.words[d])+l)/67108864|0,l=67108863&o}r.words[c]=0|l,u=0|h}return 0!==u?r.words[c]=0|u:r.length--,r._strip()}s.prototype.toArrayLike=function(e,t,r){this._strip();var i=this.byteLength(),s=r||Math.max(1,i);n(i<=s,"byte array longer than desired length"),n(s>0,"Requested array length <= 0");var o=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,s);return this["_toArrayLike"+("le"===t?"LE":"BE")](o,i),o},s.prototype._toArrayLikeLE=function(e,t){for(var r=0,n=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|n;e[r++]=255&o,r<e.length&&(e[r++]=o>>8&255),r<e.length&&(e[r++]=o>>16&255),6===s?(r<e.length&&(e[r++]=o>>24&255),n=0,s=0):(n=o>>>24,s+=2)}if(r<e.length)for(e[r++]=n;r<e.length;)e[r++]=0},s.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,n=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|n;e[r--]=255&o,r>=0&&(e[r--]=o>>8&255),r>=0&&(e[r--]=o>>16&255),6===s?(r>=0&&(e[r--]=o>>24&255),n=0,s=0):(n=o>>>24,s+=2)}if(r>=0)for(e[r--]=n;r>=0;)e[r--]=0},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0==(8191&t)&&(r+=13,t>>>=13),0==(127&t)&&(r+=7,t>>>=7),0==(15&t)&&(r+=4,t>>>=4),0==(3&t)&&(r+=2,t>>>=2),0==(1&t)&&r++,r},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},s.prototype.ior=function(e){return n(0==(this.negative|e.negative)),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},s.prototype.iand=function(e){return n(0==(this.negative|e.negative)),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},s.prototype.ixor=function(e){return n(0==(this.negative|e.negative)),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},s.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,s=0;s<n.length;s++)t=(0|r.words[s])+(0|n.words[s])+i,this.words[s]=67108863&t,i=t>>>26;for(;0!==i&&s<r.length;s++)t=(0|r.words[s])+i,this.words[s]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var s=0,o=0;o<n.length;o++)s=(t=(0|r.words[o])-(0|n.words[o])+s)>>26,this.words[o]=67108863&t;for(;0!==s&&o<r.length;o++)s=(t=(0|r.words[o])+s)>>26,this.words[o]=67108863&t;if(0===s&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var g=function(e,t,r){var n,i,s,o=e.words,a=t.words,u=r.words,c=0,h=0|o[0],l=8191&h,f=h>>>13,d=0|o[1],p=8191&d,m=d>>>13,g=0|o[2],y=8191&g,v=g>>>13,w=0|o[3],b=8191&w,_=w>>>13,E=0|o[4],k=8191&E,A=E>>>13,T=0|o[5],S=8191&T,x=T>>>13,P=0|o[6],I=8191&P,M=P>>>13,C=0|o[7],L=8191&C,N=C>>>13,B=0|o[8],R=8191&B,O=B>>>13,j=0|o[9],D=8191&j,U=j>>>13,F=0|a[0],K=8191&F,V=F>>>13,G=0|a[1],H=8191&G,Y=G>>>13,q=0|a[2],z=8191&q,W=q>>>13,$=0|a[3],Z=8191&$,J=$>>>13,Q=0|a[4],X=8191&Q,ee=Q>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],se=8191&ie,oe=ie>>>13,ae=0|a[7],ue=8191&ae,ce=ae>>>13,he=0|a[8],le=8191&he,fe=he>>>13,de=0|a[9],pe=8191&de,me=de>>>13;r.negative=e.negative^t.negative,r.length=19;var ge=(c+(n=Math.imul(l,K))|0)+((8191&(i=(i=Math.imul(l,V))+Math.imul(f,K)|0))<<13)|0;c=((s=Math.imul(f,V))+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(p,K),i=(i=Math.imul(p,V))+Math.imul(m,K)|0,s=Math.imul(m,V);var ye=(c+(n=n+Math.imul(l,H)|0)|0)+((8191&(i=(i=i+Math.imul(l,Y)|0)+Math.imul(f,H)|0))<<13)|0;c=((s=s+Math.imul(f,Y)|0)+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(y,K),i=(i=Math.imul(y,V))+Math.imul(v,K)|0,s=Math.imul(v,V),n=n+Math.imul(p,H)|0,i=(i=i+Math.imul(p,Y)|0)+Math.imul(m,H)|0,s=s+Math.imul(m,Y)|0;var ve=(c+(n=n+Math.imul(l,z)|0)|0)+((8191&(i=(i=i+Math.imul(l,W)|0)+Math.imul(f,z)|0))<<13)|0;c=((s=s+Math.imul(f,W)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(b,K),i=(i=Math.imul(b,V))+Math.imul(_,K)|0,s=Math.imul(_,V),n=n+Math.imul(y,H)|0,i=(i=i+Math.imul(y,Y)|0)+Math.imul(v,H)|0,s=s+Math.imul(v,Y)|0,n=n+Math.imul(p,z)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(m,z)|0,s=s+Math.imul(m,W)|0;var we=(c+(n=n+Math.imul(l,Z)|0)|0)+((8191&(i=(i=i+Math.imul(l,J)|0)+Math.imul(f,Z)|0))<<13)|0;c=((s=s+Math.imul(f,J)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(k,K),i=(i=Math.imul(k,V))+Math.imul(A,K)|0,s=Math.imul(A,V),n=n+Math.imul(b,H)|0,i=(i=i+Math.imul(b,Y)|0)+Math.imul(_,H)|0,s=s+Math.imul(_,Y)|0,n=n+Math.imul(y,z)|0,i=(i=i+Math.imul(y,W)|0)+Math.imul(v,z)|0,s=s+Math.imul(v,W)|0,n=n+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,J)|0)+Math.imul(m,Z)|0,s=s+Math.imul(m,J)|0;var be=(c+(n=n+Math.imul(l,X)|0)|0)+((8191&(i=(i=i+Math.imul(l,ee)|0)+Math.imul(f,X)|0))<<13)|0;c=((s=s+Math.imul(f,ee)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(S,K),i=(i=Math.imul(S,V))+Math.imul(x,K)|0,s=Math.imul(x,V),n=n+Math.imul(k,H)|0,i=(i=i+Math.imul(k,Y)|0)+Math.imul(A,H)|0,s=s+Math.imul(A,Y)|0,n=n+Math.imul(b,z)|0,i=(i=i+Math.imul(b,W)|0)+Math.imul(_,z)|0,s=s+Math.imul(_,W)|0,n=n+Math.imul(y,Z)|0,i=(i=i+Math.imul(y,J)|0)+Math.imul(v,Z)|0,s=s+Math.imul(v,J)|0,n=n+Math.imul(p,X)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(m,X)|0,s=s+Math.imul(m,ee)|0;var _e=(c+(n=n+Math.imul(l,re)|0)|0)+((8191&(i=(i=i+Math.imul(l,ne)|0)+Math.imul(f,re)|0))<<13)|0;c=((s=s+Math.imul(f,ne)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(I,K),i=(i=Math.imul(I,V))+Math.imul(M,K)|0,s=Math.imul(M,V),n=n+Math.imul(S,H)|0,i=(i=i+Math.imul(S,Y)|0)+Math.imul(x,H)|0,s=s+Math.imul(x,Y)|0,n=n+Math.imul(k,z)|0,i=(i=i+Math.imul(k,W)|0)+Math.imul(A,z)|0,s=s+Math.imul(A,W)|0,n=n+Math.imul(b,Z)|0,i=(i=i+Math.imul(b,J)|0)+Math.imul(_,Z)|0,s=s+Math.imul(_,J)|0,n=n+Math.imul(y,X)|0,i=(i=i+Math.imul(y,ee)|0)+Math.imul(v,X)|0,s=s+Math.imul(v,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(m,re)|0,s=s+Math.imul(m,ne)|0;var Ee=(c+(n=n+Math.imul(l,se)|0)|0)+((8191&(i=(i=i+Math.imul(l,oe)|0)+Math.imul(f,se)|0))<<13)|0;c=((s=s+Math.imul(f,oe)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(L,K),i=(i=Math.imul(L,V))+Math.imul(N,K)|0,s=Math.imul(N,V),n=n+Math.imul(I,H)|0,i=(i=i+Math.imul(I,Y)|0)+Math.imul(M,H)|0,s=s+Math.imul(M,Y)|0,n=n+Math.imul(S,z)|0,i=(i=i+Math.imul(S,W)|0)+Math.imul(x,z)|0,s=s+Math.imul(x,W)|0,n=n+Math.imul(k,Z)|0,i=(i=i+Math.imul(k,J)|0)+Math.imul(A,Z)|0,s=s+Math.imul(A,J)|0,n=n+Math.imul(b,X)|0,i=(i=i+Math.imul(b,ee)|0)+Math.imul(_,X)|0,s=s+Math.imul(_,ee)|0,n=n+Math.imul(y,re)|0,i=(i=i+Math.imul(y,ne)|0)+Math.imul(v,re)|0,s=s+Math.imul(v,ne)|0,n=n+Math.imul(p,se)|0,i=(i=i+Math.imul(p,oe)|0)+Math.imul(m,se)|0,s=s+Math.imul(m,oe)|0;var ke=(c+(n=n+Math.imul(l,ue)|0)|0)+((8191&(i=(i=i+Math.imul(l,ce)|0)+Math.imul(f,ue)|0))<<13)|0;c=((s=s+Math.imul(f,ce)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(R,K),i=(i=Math.imul(R,V))+Math.imul(O,K)|0,s=Math.imul(O,V),n=n+Math.imul(L,H)|0,i=(i=i+Math.imul(L,Y)|0)+Math.imul(N,H)|0,s=s+Math.imul(N,Y)|0,n=n+Math.imul(I,z)|0,i=(i=i+Math.imul(I,W)|0)+Math.imul(M,z)|0,s=s+Math.imul(M,W)|0,n=n+Math.imul(S,Z)|0,i=(i=i+Math.imul(S,J)|0)+Math.imul(x,Z)|0,s=s+Math.imul(x,J)|0,n=n+Math.imul(k,X)|0,i=(i=i+Math.imul(k,ee)|0)+Math.imul(A,X)|0,s=s+Math.imul(A,ee)|0,n=n+Math.imul(b,re)|0,i=(i=i+Math.imul(b,ne)|0)+Math.imul(_,re)|0,s=s+Math.imul(_,ne)|0,n=n+Math.imul(y,se)|0,i=(i=i+Math.imul(y,oe)|0)+Math.imul(v,se)|0,s=s+Math.imul(v,oe)|0,n=n+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(m,ue)|0,s=s+Math.imul(m,ce)|0;var Ae=(c+(n=n+Math.imul(l,le)|0)|0)+((8191&(i=(i=i+Math.imul(l,fe)|0)+Math.imul(f,le)|0))<<13)|0;c=((s=s+Math.imul(f,fe)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(D,K),i=(i=Math.imul(D,V))+Math.imul(U,K)|0,s=Math.imul(U,V),n=n+Math.imul(R,H)|0,i=(i=i+Math.imul(R,Y)|0)+Math.imul(O,H)|0,s=s+Math.imul(O,Y)|0,n=n+Math.imul(L,z)|0,i=(i=i+Math.imul(L,W)|0)+Math.imul(N,z)|0,s=s+Math.imul(N,W)|0,n=n+Math.imul(I,Z)|0,i=(i=i+Math.imul(I,J)|0)+Math.imul(M,Z)|0,s=s+Math.imul(M,J)|0,n=n+Math.imul(S,X)|0,i=(i=i+Math.imul(S,ee)|0)+Math.imul(x,X)|0,s=s+Math.imul(x,ee)|0,n=n+Math.imul(k,re)|0,i=(i=i+Math.imul(k,ne)|0)+Math.imul(A,re)|0,s=s+Math.imul(A,ne)|0,n=n+Math.imul(b,se)|0,i=(i=i+Math.imul(b,oe)|0)+Math.imul(_,se)|0,s=s+Math.imul(_,oe)|0,n=n+Math.imul(y,ue)|0,i=(i=i+Math.imul(y,ce)|0)+Math.imul(v,ue)|0,s=s+Math.imul(v,ce)|0,n=n+Math.imul(p,le)|0,i=(i=i+Math.imul(p,fe)|0)+Math.imul(m,le)|0,s=s+Math.imul(m,fe)|0;var Te=(c+(n=n+Math.imul(l,pe)|0)|0)+((8191&(i=(i=i+Math.imul(l,me)|0)+Math.imul(f,pe)|0))<<13)|0;c=((s=s+Math.imul(f,me)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(D,H),i=(i=Math.imul(D,Y))+Math.imul(U,H)|0,s=Math.imul(U,Y),n=n+Math.imul(R,z)|0,i=(i=i+Math.imul(R,W)|0)+Math.imul(O,z)|0,s=s+Math.imul(O,W)|0,n=n+Math.imul(L,Z)|0,i=(i=i+Math.imul(L,J)|0)+Math.imul(N,Z)|0,s=s+Math.imul(N,J)|0,n=n+Math.imul(I,X)|0,i=(i=i+Math.imul(I,ee)|0)+Math.imul(M,X)|0,s=s+Math.imul(M,ee)|0,n=n+Math.imul(S,re)|0,i=(i=i+Math.imul(S,ne)|0)+Math.imul(x,re)|0,s=s+Math.imul(x,ne)|0,n=n+Math.imul(k,se)|0,i=(i=i+Math.imul(k,oe)|0)+Math.imul(A,se)|0,s=s+Math.imul(A,oe)|0,n=n+Math.imul(b,ue)|0,i=(i=i+Math.imul(b,ce)|0)+Math.imul(_,ue)|0,s=s+Math.imul(_,ce)|0,n=n+Math.imul(y,le)|0,i=(i=i+Math.imul(y,fe)|0)+Math.imul(v,le)|0,s=s+Math.imul(v,fe)|0;var Se=(c+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;c=((s=s+Math.imul(m,me)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(D,z),i=(i=Math.imul(D,W))+Math.imul(U,z)|0,s=Math.imul(U,W),n=n+Math.imul(R,Z)|0,i=(i=i+Math.imul(R,J)|0)+Math.imul(O,Z)|0,s=s+Math.imul(O,J)|0,n=n+Math.imul(L,X)|0,i=(i=i+Math.imul(L,ee)|0)+Math.imul(N,X)|0,s=s+Math.imul(N,ee)|0,n=n+Math.imul(I,re)|0,i=(i=i+Math.imul(I,ne)|0)+Math.imul(M,re)|0,s=s+Math.imul(M,ne)|0,n=n+Math.imul(S,se)|0,i=(i=i+Math.imul(S,oe)|0)+Math.imul(x,se)|0,s=s+Math.imul(x,oe)|0,n=n+Math.imul(k,ue)|0,i=(i=i+Math.imul(k,ce)|0)+Math.imul(A,ue)|0,s=s+Math.imul(A,ce)|0,n=n+Math.imul(b,le)|0,i=(i=i+Math.imul(b,fe)|0)+Math.imul(_,le)|0,s=s+Math.imul(_,fe)|0;var xe=(c+(n=n+Math.imul(y,pe)|0)|0)+((8191&(i=(i=i+Math.imul(y,me)|0)+Math.imul(v,pe)|0))<<13)|0;c=((s=s+Math.imul(v,me)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(D,Z),i=(i=Math.imul(D,J))+Math.imul(U,Z)|0,s=Math.imul(U,J),n=n+Math.imul(R,X)|0,i=(i=i+Math.imul(R,ee)|0)+Math.imul(O,X)|0,s=s+Math.imul(O,ee)|0,n=n+Math.imul(L,re)|0,i=(i=i+Math.imul(L,ne)|0)+Math.imul(N,re)|0,s=s+Math.imul(N,ne)|0,n=n+Math.imul(I,se)|0,i=(i=i+Math.imul(I,oe)|0)+Math.imul(M,se)|0,s=s+Math.imul(M,oe)|0,n=n+Math.imul(S,ue)|0,i=(i=i+Math.imul(S,ce)|0)+Math.imul(x,ue)|0,s=s+Math.imul(x,ce)|0,n=n+Math.imul(k,le)|0,i=(i=i+Math.imul(k,fe)|0)+Math.imul(A,le)|0,s=s+Math.imul(A,fe)|0;var Pe=(c+(n=n+Math.imul(b,pe)|0)|0)+((8191&(i=(i=i+Math.imul(b,me)|0)+Math.imul(_,pe)|0))<<13)|0;c=((s=s+Math.imul(_,me)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(D,X),i=(i=Math.imul(D,ee))+Math.imul(U,X)|0,s=Math.imul(U,ee),n=n+Math.imul(R,re)|0,i=(i=i+Math.imul(R,ne)|0)+Math.imul(O,re)|0,s=s+Math.imul(O,ne)|0,n=n+Math.imul(L,se)|0,i=(i=i+Math.imul(L,oe)|0)+Math.imul(N,se)|0,s=s+Math.imul(N,oe)|0,n=n+Math.imul(I,ue)|0,i=(i=i+Math.imul(I,ce)|0)+Math.imul(M,ue)|0,s=s+Math.imul(M,ce)|0,n=n+Math.imul(S,le)|0,i=(i=i+Math.imul(S,fe)|0)+Math.imul(x,le)|0,s=s+Math.imul(x,fe)|0;var Ie=(c+(n=n+Math.imul(k,pe)|0)|0)+((8191&(i=(i=i+Math.imul(k,me)|0)+Math.imul(A,pe)|0))<<13)|0;c=((s=s+Math.imul(A,me)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(D,re),i=(i=Math.imul(D,ne))+Math.imul(U,re)|0,s=Math.imul(U,ne),n=n+Math.imul(R,se)|0,i=(i=i+Math.imul(R,oe)|0)+Math.imul(O,se)|0,s=s+Math.imul(O,oe)|0,n=n+Math.imul(L,ue)|0,i=(i=i+Math.imul(L,ce)|0)+Math.imul(N,ue)|0,s=s+Math.imul(N,ce)|0,n=n+Math.imul(I,le)|0,i=(i=i+Math.imul(I,fe)|0)+Math.imul(M,le)|0,s=s+Math.imul(M,fe)|0;var Me=(c+(n=n+Math.imul(S,pe)|0)|0)+((8191&(i=(i=i+Math.imul(S,me)|0)+Math.imul(x,pe)|0))<<13)|0;c=((s=s+Math.imul(x,me)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(D,se),i=(i=Math.imul(D,oe))+Math.imul(U,se)|0,s=Math.imul(U,oe),n=n+Math.imul(R,ue)|0,i=(i=i+Math.imul(R,ce)|0)+Math.imul(O,ue)|0,s=s+Math.imul(O,ce)|0,n=n+Math.imul(L,le)|0,i=(i=i+Math.imul(L,fe)|0)+Math.imul(N,le)|0,s=s+Math.imul(N,fe)|0;var Ce=(c+(n=n+Math.imul(I,pe)|0)|0)+((8191&(i=(i=i+Math.imul(I,me)|0)+Math.imul(M,pe)|0))<<13)|0;c=((s=s+Math.imul(M,me)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(D,ue),i=(i=Math.imul(D,ce))+Math.imul(U,ue)|0,s=Math.imul(U,ce),n=n+Math.imul(R,le)|0,i=(i=i+Math.imul(R,fe)|0)+Math.imul(O,le)|0,s=s+Math.imul(O,fe)|0;var Le=(c+(n=n+Math.imul(L,pe)|0)|0)+((8191&(i=(i=i+Math.imul(L,me)|0)+Math.imul(N,pe)|0))<<13)|0;c=((s=s+Math.imul(N,me)|0)+(i>>>13)|0)+(Le>>>26)|0,Le&=67108863,n=Math.imul(D,le),i=(i=Math.imul(D,fe))+Math.imul(U,le)|0,s=Math.imul(U,fe);var Ne=(c+(n=n+Math.imul(R,pe)|0)|0)+((8191&(i=(i=i+Math.imul(R,me)|0)+Math.imul(O,pe)|0))<<13)|0;c=((s=s+Math.imul(O,me)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863;var Be=(c+(n=Math.imul(D,pe))|0)+((8191&(i=(i=Math.imul(D,me))+Math.imul(U,pe)|0))<<13)|0;return c=((s=Math.imul(U,me))+(i>>>13)|0)+(Be>>>26)|0,Be&=67108863,u[0]=ge,u[1]=ye,u[2]=ve,u[3]=we,u[4]=be,u[5]=_e,u[6]=Ee,u[7]=ke,u[8]=Ae,u[9]=Te,u[10]=Se,u[11]=xe,u[12]=Pe,u[13]=Ie,u[14]=Me,u[15]=Ce,u[16]=Le,u[17]=Ne,u[18]=Be,0!==c&&(u[19]=c,r.length++),r};function y(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,s=0;s<r.length-1;s++){var o=i;i=0;for(var a=67108863&n,u=Math.min(s,t.length-1),c=Math.max(0,s-e.length+1);c<=u;c++){var h=s-c,l=(0|e.words[h])*(0|t.words[c]),f=67108863&l;a=67108863&(f=f+a|0),i+=(o=(o=o+(l/67108864|0)|0)+(f>>>26)|0)>>>26,o&=67108863}r.words[s]=a,n=o,o=i}return 0!==n?r.words[s]=n:r.length--,r._strip()}function v(e,t,r){return y(e,t,r)}function w(e,t){this.x=e,this.y=t}Math.imul||(g=m),s.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?g(this,e,t):r<63?m(this,e,t):r<1024?y(this,e,t):v(this,e,t)},w.prototype.makeRBT=function(e){for(var t=new Array(e),r=s.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},w.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},w.prototype.permute=function(e,t,r,n,i,s){for(var o=0;o<s;o++)n[o]=t[e[o]],i[o]=r[e[o]]},w.prototype.transform=function(e,t,r,n,i,s){this.permute(s,e,t,r,n,i);for(var o=1;o<i;o<<=1)for(var a=o<<1,u=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),h=0;h<i;h+=a)for(var l=u,f=c,d=0;d<o;d++){var p=r[h+d],m=n[h+d],g=r[h+d+o],y=n[h+d+o],v=l*g-f*y;y=l*y+f*g,g=v,r[h+d]=p+g,n[h+d]=m+y,r[h+d+o]=p-g,n[h+d+o]=m-y,d!==a&&(v=u*l-c*f,f=u*f+c*l,l=v)}},w.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},w.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},w.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},w.prototype.convert13b=function(e,t,r,i){for(var s=0,o=0;o<t;o++)s+=0|e[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*t;o<i;++o)r[o]=0;n(0===s),n(0==(-8192&s))},w.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},w.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),s=this.stub(n),o=new Array(n),a=new Array(n),u=new Array(n),c=new Array(n),h=new Array(n),l=new Array(n),f=r.words;f.length=n,this.convert13b(e.words,e.length,o,n),this.convert13b(t.words,t.length,c,n),this.transform(o,s,a,u,n,i),this.transform(c,s,h,l,n,i);for(var d=0;d<n;d++){var p=a[d]*h[d]-u[d]*l[d];u[d]=a[d]*l[d]+u[d]*h[d],a[d]=p}return this.conjugate(a,u,n),this.transform(a,u,f,s,n,i),this.conjugate(f,s,n),this.normalize13b(f,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),v(this,e,t)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"==typeof e),n(e<67108864);for(var r=0,i=0;i<this.length;i++){var s=(0|this.words[i])*e,o=(67108863&s)+(67108863&r);r>>=26,r+=s/67108864|0,r+=o>>>26,this.words[i]=67108863&o}return 0!==r&&(this.words[i]=r,this.length++),t?this.ineg():this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=e.words[n]>>>i&1}return t}(e);if(0===t.length)return new s(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},s.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,s=67108863>>>26-r<<26-r;if(0!==r){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&s,u=(0|this.words[t])-a<<r;this.words[t]=u|o,o=a>>>26-r}o&&(this.words[t]=o,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},s.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var s=e%26,o=Math.min((e-s)/26,this.length),a=67108863^67108863>>>s<<s,u=r;if(i-=o,i=Math.max(0,i),u){for(var c=0;c<o;c++)u.words[c]=this.words[c];u.length=o}if(0===o);else if(this.length>o)for(this.length-=o,c=0;c<this.length;c++)this.words[c]=this.words[c+o];else this.words[0]=0,this.length=1;var h=0;for(c=this.length-1;c>=0&&(0!==h||c>=i);c--){var l=0|this.words[c];this.words[c]=h<<26-s|l>>>s,h=l&a}return u&&0!==h&&(u.words[u.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r)&&!!(this.words[r]&i)},s.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,r){var i,s,o=e.length+r;this._expand(o);var a=0;for(i=0;i<e.length;i++){s=(0|this.words[i+r])+a;var u=(0|e.words[i])*t;a=((s-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&s}for(;i<this.length-r;i++)a=(s=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&s;if(0===a)return this._strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(s=-(0|this.words[i])+a)>>26,this.words[i]=67108863&s;return this.negative=1,this._strip()},s.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,o=0|i.words[i.length-1];0!==(r=26-this._countBits(o))&&(i=i.ushln(r),n.iushln(r),o=0|i.words[i.length-1]);var a,u=n.length-i.length;if("mod"!==t){(a=new s(null)).length=u+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var h=n.clone()._ishlnsubmul(i,1,u);0===h.negative&&(n=h,a&&(a.words[u]=1));for(var l=u-1;l>=0;l--){var f=67108864*(0|n.words[i.length+l])+(0|n.words[i.length+l-1]);for(f=Math.min(f/o|0,67108863),n._ishlnsubmul(i,f,l);0!==n.negative;)f--,n.negative=0,n._ishlnsubmul(i,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=f)}return a&&a._strip(),n._strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},s.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.iadd(e)),{div:i,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):0!=(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||this.cmp(e)<0?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modrn(e.words[0]))}:this._wordDiv(e,t);var i,o,a},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),s=r.cmp(n);return s<0||1===i&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=(1<<26)%e,i=0,s=this.length-1;s>=0;s--)i=(r*i+(0|this.words[s]))%e;return t?-i:i},s.prototype.modn=function(e){return this.modrn(e)},s.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var s=(0|this.words[i])+67108864*r;this.words[i]=s/e|0,r=s%e}return this._strip(),t?this.ineg():this},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new s(1),o=new s(0),a=new s(0),u=new s(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var h=r.clone(),l=t.clone();!t.isZero();){for(var f=0,d=1;0==(t.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(t.iushrn(f);f-- >0;)(i.isOdd()||o.isOdd())&&(i.iadd(h),o.isub(l)),i.iushrn(1),o.iushrn(1);for(var p=0,m=1;0==(r.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||u.isOdd())&&(a.iadd(h),u.isub(l)),a.iushrn(1),u.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),o.isub(u)):(r.isub(t),a.isub(i),u.isub(o))}return{a:a,b:u,gcd:r.iushln(c)}},s.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,o=new s(1),a=new s(0),u=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,h=1;0==(t.words[0]&h)&&c<26;++c,h<<=1);if(c>0)for(t.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(u),o.iushrn(1);for(var l=0,f=1;0==(r.words[0]&f)&&l<26;++l,f<<=1);if(l>0)for(r.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(a)):(r.isub(t),a.isub(o))}return(i=0===t.cmpn(1)?o:a).cmpn(0)<0&&i.iadd(e),i},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var s=t;t=r,r=s}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return 0==(1&this.words[0])},s.prototype.isOdd=function(){return 1==(1&this.words[0])},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var s=i,o=r;0!==s&&o<this.length;o++){var a=0|this.words[o];s=(a+=s)>>>26,a&=67108863,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return-1===this.cmpn(e)},s.prototype.lt=function(e){return-1===this.cmp(e)},s.prototype.lten=function(e){return this.cmpn(e)<=0},s.prototype.lte=function(e){return this.cmp(e)<=0},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new S(e)},s.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var b={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function k(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function A(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function T(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function x(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new s(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):r.strip!==undefined?r.strip():r._strip(),r},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},i(E,_),E.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var s=e.words[9];for(t.words[t.length++]=s&r,i=10;i<e.length;i++){var o=0|e.words[i];e.words[i-10]=(o&r)<<4|s>>>22,s=o}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(k,_),i(A,_),i(T,_),T.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){if(b[e])return b[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new k;else if("p192"===e)t=new A;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new T}return b[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0==(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(h(e,e.umod(this.m)._forceRed(this)),e)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},S.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new s(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),o=0;!i.isZero()&&0===i.andln(1);)o++,i.iushrn(1);n(!i.isZero());var a=new s(1).toRed(this),u=a.redNeg(),c=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new s(2*h*h).toRed(this);0!==this.pow(h,c).cmp(u);)h.redIAdd(u);for(var l=this.pow(h,i),f=this.pow(e,i.addn(1).iushrn(1)),d=this.pow(e,i),p=o;0!==d.cmp(a);){for(var m=d,g=0;0!==m.cmp(a);g++)m=m.redSqr();n(g<p);var y=this.pow(l,new s(1).iushln(p-g-1));f=f.redMul(y),l=y.redSqr(),d=d.redMul(l),p=g}return f},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new s(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],o=0,a=0,u=t.bitLength()%26;for(0===u&&(u=26),n=t.length-1;n>=0;n--){for(var c=t.words[n],h=u-1;h>=0;h--){var l=c>>h&1;i!==r[0]&&(i=this.sqr(i)),0!==l||0!==o?(o<<=1,o|=l,(4===++a||0===n&&0===h)&&(i=this.mul(i,r[o]),a=0,o=0)):a=0}u=26}return i},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new x(e)},i(x,S),x.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},x.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},x.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},x.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},x.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t,this)}}},{package:"bn.js",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-lattice-keyring/node_modules/bn.js/lib/bn.js"}],[245,{"./decode.js":243,"./encode.js":244,"./length.js":246},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={encode:e("./encode.js"),decode:e("./decode.js"),encodingLength:e("./length.js")}}}},{package:"varint",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multicodec/node_modules/varint/index.js"}],[246,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Math.pow(2,7),i=Math.pow(2,14),s=Math.pow(2,21),o=Math.pow(2,28),a=Math.pow(2,35),u=Math.pow(2,42),c=Math.pow(2,49),h=Math.pow(2,56),l=Math.pow(2,63);t.exports=function(e){return e<n?1:e<i?2:e<s?3:e<o?4:e<a?5:e<u?6:e<c?7:e<h?8:e<l?9:10}}}},{package:"varint",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multicodec/node_modules/varint/length.js"}],[247,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=Object.freeze({identity:0,cidv1:1,cidv2:2,cidv3:3,ip4:4,tcp:6,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,dccp:33,"murmur3-128":34,"murmur3-32":35,ip6:41,ip6zone:42,path:47,multicodec:48,multihash:49,multiaddr:50,multibase:51,dns:53,dns4:54,dns6:55,dnsaddr:56,protobuf:80,cbor:81,raw:85,"dbl-sha2-256":86,rlp:96,bencode:99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:132,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,docid:206,"stellar-block":208,"stellar-tx":209,md4:212,md5:213,bmt:214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:230,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"bls12_381-g1g2-pub":238,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:301,utp:302,unix:400,p2p:421,ipfs:421,https:443,onion:444,onion3:445,garlic64:446,garlic32:447,tls:448,quic:460,ws:477,wss:478,"p2p-websocket-star":479,http:480,json:512,messagepack:513,"libp2p-peer-record":769,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"p256-pub":4608,"p384-pub":4609,"p521-pub":4610,"ed448-pub":4611,"x448-pub":4612,"ed25519-priv":4864,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332,"skynet-ns":11639056});t.exports={baseTable:n}}}},{package:"multicodec",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/base-table.js"}],[2479,{"@ethereumjs/tx":405,buffer:2081,"ethereumjs-util":2521,events:2082,hdkey:2480,"trezor-connect":5958,"trezor-connect/lib/plugins/ethereum/typedData":5961},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const{EventEmitter:n}=e("events"),i=e("ethereumjs-util"),s=e("hdkey"),o=e("trezor-connect").default,{TransactionFactory:a}=e("@ethereumjs/tx"),u=e("trezor-connect/lib/plugins/ethereum/typedData"),c="m/44'/60'/0'/0",h={[c]:!0,"m/44'/1'/0'/0":!0},l="Trezor Hardware",f=1e3,d={email:"support@metamask.io",appUrl:"https://metamask.io"};function p(e){return new Promise((t=>setTimeout(t,e)))}function m(e){return"function"==typeof e.getChainId}class g extends n{constructor(e={}){super(),this.type=l,this.accounts=[],this.hdk=new s,this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={},this.deserialize(e),o.on("DEVICE_EVENT",(e=>{e&&e.payload&&e.payload.features&&(this.model=e.payload.features.model)})),o.init({manifest:d})}getModel(){return this.model}dispose(){o.dispose()}serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts,page:this.page,paths:this.paths,perPage:this.perPage,unlockedAccount:this.unlockedAccount})}deserialize(e={}){return this.hdPath=e.hdPath||c,this.accounts=e.accounts||[],this.page=e.page||0,this.perPage=e.perPage||5,Promise.resolve()}isUnlocked(){return Boolean(this.hdk&&this.hdk.publicKey)}unlock(){return this.isUnlocked()?Promise.resolve("already unlocked"):new Promise(((e,t)=>{o.getPublicKey({path:this.hdPath,coin:"ETH"}).then((n=>{n.success?(this.hdk.publicKey=r.from(n.payload.publicKey,"hex"),this.hdk.chainCode=r.from(n.payload.chainCode,"hex"),e("just unlocked")):t(new Error(n.payload&&n.payload.error||"Unknown error"))})).catch((e=>{t(new Error(e&&e.toString()||"Unknown error"))}))}))}setAccountToUnlock(e){this.unlockedAccount=parseInt(e,10)}addAccounts(e=1){return new Promise(((t,r)=>{this.unlock().then((r=>{const n=this.unlockedAccount,i=n+e;for(let e=n;e<i;e++){const t=this._addressFromIndex("m",e);this.accounts.includes(t)||this.accounts.push(t),this.page=0}t(this.accounts)})).catch((e=>{r(e)}))}))}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}__getPage(e){return this.page+=e,this.page<=0&&(this.page=1),new Promise(((e,t)=>{this.unlock().then((t=>{const r=(this.page-1)*this.perPage,n=r+this.perPage,s=[];for(let e=r;e<n;e++){const t=this._addressFromIndex("m",e);s.push({address:t,balance:null,index:e}),this.paths[i.toChecksumAddress(t)]=e}e(s)})).catch((e=>{t(e)}))}))}getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}signTransaction(e,t){return m(t)?this._signTransaction(e,t.getChainId(),t,(e=>(t.v=r.from(e.v,"hex"),t.r=r.from(e.r,"hex"),t.s=r.from(e.s,"hex"),t))):this._signTransaction(e,t.common.chainIdBN().toNumber(),t,(e=>{const r=t.toJSON();return r.type=t.type,r.v=i.addHexPrefix(e.v),r.r=i.addHexPrefix(e.r),r.s=i.addHexPrefix(e.s),a.fromTxData(r,{common:t.common,freeze:Object.isFrozen(t)})}))}async _signTransaction(e,t,r,n){let s;s=m(r)?{to:this._normalize(r.to),value:this._normalize(r.value),data:this._normalize(r.data),chainId:t,nonce:this._normalize(r.nonce),gasLimit:this._normalize(r.gasLimit),gasPrice:this._normalize(r.gasPrice)}:{...r.toJSON(),chainId:t,to:this._normalize(r.to)};try{const t=await this.unlock();await p("just unlocked"===t?f:0);const r=await o.ethereumSignTransaction({path:this._pathFromAddress(e),transaction:s});if(r.success){const t=n(r.payload),s=i.toChecksumAddress(i.addHexPrefix(t.getSenderAddress().toString("hex")));if(s!==i.toChecksumAddress(e))throw new Error("signature doesn't match the right address");return t}throw new Error(r.payload&&r.payload.error||"Unknown error")}catch(e){throw new Error(e&&e.toString()||"Unknown error")}}signMessage(e,t){return this.signPersonalMessage(e,t)}signPersonalMessage(e,t){return new Promise(((r,n)=>{this.unlock().then((s=>{setTimeout((s=>{o.ethereumSignMessage({path:this._pathFromAddress(e),message:i.stripHexPrefix(t),hex:!0}).then((t=>{if(t.success){t.payload.address!==i.toChecksumAddress(e)&&n(new Error("signature doesnt match the right address"));const s=`0x${t.payload.signature}`;r(s)}else n(new Error(t.payload&&t.payload.error||"Unknown error"))})).catch((e=>{n(new Error(e&&e.toString()||"Unknown error"))}))}),"just unlocked"===s?f:0)})).catch((e=>{n(new Error(e&&e.toString()||"Unknown error"))}))}))}async signTypedData(e,t,{version:r}){const n=u(t,"V4"===r),{types:{EIP712Domain:s=[],...a}={},message:c={},domain:h={},primaryType:l,domain_separator_hash:d,message_hash:m}=n,g=await this.unlock();await p("just unlocked"===g?f:0);const y=await o.ethereumSignTypedData({path:this._pathFromAddress(e),data:{types:{EIP712Domain:s,...a},message:c,domain:h,primaryType:l},metamask_v4_compat:!0,domain_separator_hash:d,message_hash:m});if(y.success){if(i.toChecksumAddress(e)!==y.payload.address)throw new Error("signature doesnt match the right address");return y.payload.signature}throw new Error(y.payload&&y.payload.error||"Unknown error")}exportAccount(){return Promise.reject(new Error("Not supported on this device"))}forgetDevice(){this.accounts=[],this.hdk=new s,this.page=0,this.unlockedAccount=0,this.paths={}}setHdPath(e){if(!h[e])throw new Error(`The setHdPath method does not support setting HD Path to ${e}`);this.hdPath!==e&&(this.hdk=new s,this.accounts=[],this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={}),this.hdPath=e}_normalize(e){return i.bufferToHex(e).toString()}_addressFromIndex(e,t){const r=this.hdk.derive(`${e}/${t}`),n=i.publicToAddress(r.publicKey,!0).toString("hex");return i.toChecksumAddress(`0x${n}`)}_pathFromAddress(e){const t=i.toChecksumAddress(e);let r=this.paths[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===this._addressFromIndex("m",e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${r}`}}g.type=l,t.exports=g}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-trezor-keyring",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-trezor-keyring/index.js"}],[248,{"./base-table":247},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i={};for(const[e,t]of Object.entries(n)){i[e.toUpperCase().replace(/-/g,"_")]=t}t.exports=Object.freeze(i)}}},{package:"multicodec",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/constants.js"}],[2480,{assert:1700,coinstring:2125,crypto:2191,"safe-buffer":5739,secp256k1:2481},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("assert"),i=e("safe-buffer").Buffer,s=e("crypto"),o=e("coinstring"),a=e("secp256k1"),u=i.from("Bitcoin seed","utf8"),c=2147483648,h={private:76066276,public:76067358};function l(e){this.versions=e||h,this.depth=0,this.index=0,this._privateKey=null,this._publicKey=null,this.chainCode=null,this._fingerprint=0,this.parentFingerprint=0}function f(e,t,r){var n=i.allocUnsafe(78);n.writeUInt32BE(t,0),n.writeUInt8(e.depth,4);var s=e.depth?e.parentFingerprint:0;return n.writeUInt32BE(s,5),n.writeUInt32BE(e.index,9),e.chainCode.copy(n,13),r.copy(n,45),n}function d(e){var t=s.createHash("sha256").update(e).digest();return s.createHash("rmd160").update(t).digest()}Object.defineProperty(l.prototype,"fingerprint",{get:function(){return this._fingerprint}}),Object.defineProperty(l.prototype,"identifier",{get:function(){return this._identifier}}),Object.defineProperty(l.prototype,"pubKeyHash",{get:function(){return this.identifier}}),Object.defineProperty(l.prototype,"privateKey",{get:function(){return this._privateKey},set:function(e){n.equal(e.length,32,"Private key must be 32 bytes."),n(!0===a.privateKeyVerify(e),"Invalid private key"),this._privateKey=e,this._publicKey=a.publicKeyCreate(e,!0),this._identifier=d(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0)}}),Object.defineProperty(l.prototype,"publicKey",{get:function(){return this._publicKey},set:function(e){n(33===e.length||65===e.length,"Public key must be 33 or 65 bytes."),n(!0===a.publicKeyVerify(e),"Invalid public key"),this._publicKey=a.publicKeyConvert(e,!0),this._identifier=d(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0),this._privateKey=null}}),Object.defineProperty(l.prototype,"privateExtendedKey",{get:function(){return this._privateKey?o.encode(f(this,this.versions.private,i.concat([i.alloc(1,0),this.privateKey]))):null}}),Object.defineProperty(l.prototype,"publicExtendedKey",{get:function(){return o.encode(f(this,this.versions.public,this.publicKey))}}),l.prototype.derive=function(e){if("m"===e||"M"===e||"m'"===e||"M'"===e)return this;var t=e.split("/"),r=this;return t.forEach((function(e,t){if(0!==t){var i=e.length>1&&"'"===e[e.length-1],s=parseInt(e,10);n(s<c,"Invalid index"),i&&(s+=c),r=r.deriveChild(s)}else n(e,"m","Invalid path")})),r},l.prototype.deriveChild=function(e){var t,r=e>=c,o=i.allocUnsafe(4);if(o.writeUInt32BE(e,0),r){n(this.privateKey,"Could not derive hardened child key");var u=this.privateKey,h=i.alloc(1,0);u=i.concat([h,u]),t=i.concat([u,o])}else t=i.concat([this.publicKey,o]);var f=s.createHmac("sha512",this.chainCode).update(t).digest(),d=f.slice(0,32),p=f.slice(32),m=new l(this.versions);if(this.privateKey)try{m.privateKey=a.privateKeyTweakAdd(this.privateKey,d)}catch(t){return this.derive(e+1)}else try{m.publicKey=a.publicKeyTweakAdd(this.publicKey,d,!0)}catch(t){return this.derive(e+1,r)}return m.chainCode=p,m.depth=this.depth+1,m.parentFingerprint=this.fingerprint,m.index=e,m},l.prototype.sign=function(e){return a.sign(e,this.privateKey).signature},l.prototype.verify=function(e,t){return a.verify(e,t,this.publicKey)},l.prototype.toJSON=function(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}},l.fromMasterSeed=function(e,t){var r=s.createHmac("sha512",u).update(e).digest(),n=r.slice(0,32),i=r.slice(32),o=new l(t);return o.chainCode=i,o.privateKey=n,o},l.fromExtendedKey=function(e,t){var r=new l(t=t||h),i=o.decode(e),s=i.readUInt32BE(0);n(s===t.private||s===t.public,"Version mismatch: does not match private or public"),r.depth=i.readUInt8(4),r.parentFingerprint=i.readUInt32BE(5),r.index=i.readUInt32BE(9),r.chainCode=i.slice(13,45);var a=i.slice(45);return 0===a.readUInt8(0)?(n(s===t.private,"Version mismatch: version does not match private"),r.privateKey=a.slice(1)):(n(s===t.public,"Version mismatch: version does not match public"),r.publicKey=a),r},l.fromJSON=function(e){return l.fromExtendedKey(e.xpriv)},l.HARDENED_OFFSET=c,t.exports=l}}},{package:"hdkey",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-trezor-keyring/node_modules/hdkey/lib/hdkey.js"}],[2481,{"./lib":2485,"./lib/elliptic":2484},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib")(e("./lib/elliptic"))}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-trezor-keyring/node_modules/secp256k1/elliptic.js"}],[2482,{"../../../../is-buffer/index.js":4686},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){var t=Object.prototype.toString;r.isArray=function(e,t){if(!Array.isArray(e))throw TypeError(t)},r.isBoolean=function(e,r){if("[object Boolean]"!==t.call(e))throw TypeError(r)},r.isBuffer=function(t,r){if(!e.isBuffer(t))throw TypeError(r)},r.isFunction=function(e,r){if("[object Function]"!==t.call(e))throw TypeError(r)},r.isNumber=function(e,r){if("[object Number]"!==t.call(e))throw TypeError(r)},r.isObject=function(e,r){if("[object Object]"!==t.call(e))throw TypeError(r)},r.isBufferLength=function(e,t,r){if(e.length!==t)throw RangeError(r)},r.isBufferLength2=function(e,t,r,n){if(e.length!==t&&e.length!==r)throw RangeError(n)},r.isLengthGTZero=function(e,t){if(0===e.length)throw RangeError(t)},r.isNumberInInterval=function(e,t,r,n){if(e<=t||e>=r)throw RangeError(n)}}).call(this)}).call(this,{isBuffer:e("../../../../is-buffer/index.js")})}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-trezor-keyring/node_modules/secp256k1/lib/assert.js"}],[2483,{bip66:1970,"safe-buffer":5739},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=e("bip66"),s=n.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),o=n.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r.privateKeyExport=function(e,t,r){var i=n.from(r?s:o);return e.copy(i,r?8:9),t.copy(i,r?181:214),i},r.privateKeyImport=function(e){var t=e.length,r=0;if(!(t<r+1||48!==e[r])&&!(t<(r+=1)+1)&&128&e[r]){var n=127&e[r];if(r+=1,!(n<1||n>2||t<r+n)){var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);if(!(t<(r+=n)+i||t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2]||t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]))return e.slice(r+2,r+2+e[r+1])}}},r.signatureExport=function(e){for(var t=n.concat([n.from([0]),e.r]),r=33,s=0;r>1&&0===t[s]&&!(128&t[s+1]);--r,++s);for(var o=n.concat([n.from([0]),e.s]),a=33,u=0;a>1&&0===o[u]&&!(128&o[u+1]);--a,++u);return i.encode(t.slice(s),o.slice(u))},r.signatureImport=function(e){var t=n.alloc(32,0),r=n.alloc(32,0);try{var s=i.decode(e);if(33===s.r.length&&0===s.r[0]&&(s.r=s.r.slice(1)),s.r.length>32)throw new Error("R length is too long");if(33===s.s.length&&0===s.s[0]&&(s.s=s.s.slice(1)),s.s.length>32)throw new Error("S length is too long")}catch(e){return}return s.r.copy(t,32-s.r.length),s.s.copy(r,32-s.s.length),{r:t,s:r}},r.signatureImportLax=function(e){var t=n.alloc(32,0),r=n.alloc(32,0),i=e.length,s=0;if(48===e[s++]){var o=e[s++];if(!(128&o&&(s+=o-128)>i)&&2===e[s++]){var a=e[s++];if(128&a){if(s+(o=a-128)>i)return;for(;o>0&&0===e[s];s+=1,o-=1);for(a=0;o>0;s+=1,o-=1)a=(a<<8)+e[s]}if(!(a>i-s)){var u=s;if(s+=a,2===e[s++]){var c=e[s++];if(128&c){if(s+(o=c-128)>i)return;for(;o>0&&0===e[s];s+=1,o-=1);for(c=0;o>0;s+=1,o-=1)c=(c<<8)+e[s]}if(!(c>i-s)){var h=s;for(s+=c;a>0&&0===e[u];a-=1,u+=1);if(!(a>32)){var l=e.slice(u,u+a);for(l.copy(t,32-l.length);c>0&&0===e[h];c-=1,h+=1);if(!(c>32)){var f=e.slice(h,h+c);return f.copy(r,32-f.length),{r:t,s:r}}}}}}}}}}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-trezor-keyring/node_modules/secp256k1/lib/der.js"}],[2484,{"../messages.json":2486,"bn.js":2037,"create-hash":2185,elliptic:2315,"safe-buffer":5739},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=e("create-hash"),s=e("bn.js"),o=e("elliptic").ec,a=e("../messages.json"),u=new o("secp256k1"),c=u.curve;function h(e){var t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){var r=new s(t);if(r.cmp(c.p)>=0)return null;var n=(r=r.toRed(c.red)).redSqr().redIMul(r).redIAdd(c.b).redSqrt();return 3===e!==n.isOdd()&&(n=n.redNeg()),u.keyPair({pub:{x:r,y:n}})}(t,e.slice(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,r){var n=new s(t),i=new s(r);if(n.cmp(c.p)>=0||i.cmp(c.p)>=0)return null;if(n=n.toRed(c.red),i=i.toRed(c.red),(6===e||7===e)&&i.isOdd()!==(7===e))return null;var o=n.redSqr().redIMul(n);return i.redSqr().redISub(o.redIAdd(c.b)).isZero()?u.keyPair({pub:{x:n,y:i}}):null}(t,e.slice(1,33),e.slice(33,65));default:return null}}r.privateKeyVerify=function(e){var t=new s(e);return t.cmp(c.n)<0&&!t.isZero()},r.privateKeyExport=function(e,t){var r=new s(e);if(r.cmp(c.n)>=0||r.isZero())throw new Error(a.EC_PRIVATE_KEY_EXPORT_DER_FAIL);return n.from(u.keyFromPrivate(e).getPublic(t,!0))},r.privateKeyNegate=function(e){var t=new s(e);return t.isZero()?n.alloc(32):c.n.sub(t).umod(c.n).toArrayLike(n,"be",32)},r.privateKeyModInverse=function(e){var t=new s(e);if(t.cmp(c.n)>=0||t.isZero())throw new Error(a.EC_PRIVATE_KEY_RANGE_INVALID);return t.invm(c.n).toArrayLike(n,"be",32)},r.privateKeyTweakAdd=function(e,t){var r=new s(t);if(r.cmp(c.n)>=0)throw new Error(a.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);if(r.iadd(new s(e)),r.cmp(c.n)>=0&&r.isub(c.n),r.isZero())throw new Error(a.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);return r.toArrayLike(n,"be",32)},r.privateKeyTweakMul=function(e,t){var r=new s(t);if(r.cmp(c.n)>=0||r.isZero())throw new Error(a.EC_PRIVATE_KEY_TWEAK_MUL_FAIL);return r.imul(new s(e)),r.cmp(c.n)&&(r=r.umod(c.n)),r.toArrayLike(n,"be",32)},r.publicKeyCreate=function(e,t){var r=new s(e);if(r.cmp(c.n)>=0||r.isZero())throw new Error(a.EC_PUBLIC_KEY_CREATE_FAIL);return n.from(u.keyFromPrivate(e).getPublic(t,!0))},r.publicKeyConvert=function(e,t){var r=h(e);if(null===r)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);return n.from(r.getPublic(t,!0))},r.publicKeyVerify=function(e){return null!==h(e)},r.publicKeyTweakAdd=function(e,t,r){var i=h(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(c.n)>=0)throw new Error(a.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);var o=c.g.mul(t).add(i.pub);if(o.isInfinity())throw new Error(a.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);return n.from(o.encode(!0,r))},r.publicKeyTweakMul=function(e,t,r){var i=h(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(c.n)>=0||t.isZero())throw new Error(a.EC_PUBLIC_KEY_TWEAK_MUL_FAIL);return n.from(i.pub.mul(t).encode(!0,r))},r.publicKeyCombine=function(e,t){for(var r=new Array(e.length),i=0;i<e.length;++i)if(r[i]=h(e[i]),null===r[i])throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);for(var s=r[0].pub,o=1;o<r.length;++o)s=s.add(r[o].pub);if(s.isInfinity())throw new Error(a.EC_PUBLIC_KEY_COMBINE_FAIL);return n.from(s.encode(!0,t))},r.signatureNormalize=function(e){var t=new s(e.slice(0,32)),r=new s(e.slice(32,64));if(t.cmp(c.n)>=0||r.cmp(c.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);var i=n.from(e);return 1===r.cmp(u.nh)&&c.n.sub(r).toArrayLike(n,"be",32).copy(i,32),i},r.signatureExport=function(e){var t=e.slice(0,32),r=e.slice(32,64);if(new s(t).cmp(c.n)>=0||new s(r).cmp(c.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);return{r:t,s:r}},r.signatureImport=function(e){var t=new s(e.r);t.cmp(c.n)>=0&&(t=new s(0));var r=new s(e.s);return r.cmp(c.n)>=0&&(r=new s(0)),n.concat([t.toArrayLike(n,"be",32),r.toArrayLike(n,"be",32)])},r.sign=function(e,t,r,i){if("function"==typeof r){var o=r;r=function(r){var u=o(e,t,null,i,r);if(!n.isBuffer(u)||32!==u.length)throw new Error(a.ECDSA_SIGN_FAIL);return new s(u)}}var h=new s(t);if(h.cmp(c.n)>=0||h.isZero())throw new Error(a.ECDSA_SIGN_FAIL);var l=u.sign(e,t,{canonical:!0,k:r,pers:i});return{signature:n.concat([l.r.toArrayLike(n,"be",32),l.s.toArrayLike(n,"be",32)]),recovery:l.recoveryParam}},r.verify=function(e,t,r){var n={r:t.slice(0,32),s:t.slice(32,64)},i=new s(n.r),o=new s(n.s);if(i.cmp(c.n)>=0||o.cmp(c.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);if(1===o.cmp(u.nh)||i.isZero()||o.isZero())return!1;var l=h(r);if(null===l)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);return u.verify(e,n,{x:l.pub.x,y:l.pub.y})},r.recover=function(e,t,r,i){var o={r:t.slice(0,32),s:t.slice(32,64)},h=new s(o.r),l=new s(o.s);if(h.cmp(c.n)>=0||l.cmp(c.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);try{if(h.isZero()||l.isZero())throw new Error;var f=u.recoverPubKey(e,o,r);return n.from(f.encode(!0,i))}catch(e){throw new Error(a.ECDSA_RECOVER_FAIL)}},r.ecdh=function(e,t){var n=r.ecdhUnsafe(e,t,!0);return i("sha256").update(n).digest()},r.ecdhUnsafe=function(e,t,r){var i=h(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);var o=new s(t);if(o.cmp(c.n)>=0||o.isZero())throw new Error(a.ECDH_FAIL);return n.from(i.pub.mul(o).encode(!0,r))}}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-trezor-keyring/node_modules/secp256k1/lib/elliptic/index.js"}],[2485,{"./assert":2482,"./der":2483,"./messages.json":2486},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./assert"),i=e("./der"),s=e("./messages.json");function o(e,t){return e===undefined?t:(n.isBoolean(e,s.COMPRESSED_TYPE_INVALID),e)}t.exports=function(e){return{privateKeyVerify:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),32===t.length&&e.privateKeyVerify(t)},privateKeyExport:function(t,r){n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0);var a=e.privateKeyExport(t,r);return i.privateKeyExport(t,a,r)},privateKeyImport:function(t){if(n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),(t=i.privateKeyImport(t))&&32===t.length&&e.privateKeyVerify(t))return t;throw new Error(s.EC_PRIVATE_KEY_IMPORT_DER_FAIL)},privateKeyNegate:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyNegate(t)},privateKeyModInverse:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyModInverse(t)},privateKeyTweakAdd:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakAdd(t,r)},privateKeyTweakMul:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakMul(t,r)},publicKeyCreate:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyCreate(t,r)},publicKeyConvert:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyConvert(t,r)},publicKeyVerify:function(t){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),e.publicKeyVerify(t)},publicKeyTweakAdd:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakAdd(t,r,i)},publicKeyTweakMul:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakMul(t,r,i)},publicKeyCombine:function(t,r){n.isArray(t,s.EC_PUBLIC_KEYS_TYPE_INVALID),n.isLengthGTZero(t,s.EC_PUBLIC_KEYS_LENGTH_INVALID);for(var i=0;i<t.length;++i)n.isBuffer(t[i],s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t[i],33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID);return r=o(r,!0),e.publicKeyCombine(t,r)},signatureNormalize:function(t){return n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),e.signatureNormalize(t)},signatureExport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=e.signatureExport(t);return i.signatureExport(r)},signatureImport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImport(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},signatureImportLax:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImportLax(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},sign:function(t,r,i){n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID);var o=null,a=null;return i!==undefined&&(n.isObject(i,s.OPTIONS_TYPE_INVALID),i.data!==undefined&&(n.isBuffer(i.data,s.OPTIONS_DATA_TYPE_INVALID),n.isBufferLength(i.data,32,s.OPTIONS_DATA_LENGTH_INVALID),o=i.data),i.noncefn!==undefined&&(n.isFunction(i.noncefn,s.OPTIONS_NONCEFN_TYPE_INVALID),a=i.noncefn)),e.sign(t,r,a,o)},verify:function(t,r,i){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isBuffer(i,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(i,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),e.verify(t,r,i)},recover:function(t,r,i,a){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isNumber(i,s.RECOVERY_ID_TYPE_INVALID),n.isNumberInInterval(i,-1,4,s.RECOVERY_ID_VALUE_INVALID),a=o(a,!0),e.recover(t,r,i,a)},ecdh:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.ecdh(t,r)},ecdhUnsafe:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),i=o(i,!0),e.ecdhUnsafe(t,r,i)}}}}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-trezor-keyring/node_modules/secp256k1/lib/index.js"}],[2486,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={COMPRESSED_TYPE_INVALID:"compressed should be a boolean",EC_PRIVATE_KEY_TYPE_INVALID:"private key should be a Buffer",EC_PRIVATE_KEY_LENGTH_INVALID:"private key length is invalid",EC_PRIVATE_KEY_RANGE_INVALID:"private key range is invalid",EC_PRIVATE_KEY_TWEAK_ADD_FAIL:"tweak out of range or resulting private key is invalid",EC_PRIVATE_KEY_TWEAK_MUL_FAIL:"tweak out of range",EC_PRIVATE_KEY_EXPORT_DER_FAIL:"couldn't export to DER format",EC_PRIVATE_KEY_IMPORT_DER_FAIL:"couldn't import from DER format",EC_PUBLIC_KEYS_TYPE_INVALID:"public keys should be an Array",EC_PUBLIC_KEYS_LENGTH_INVALID:"public keys Array should have at least 1 element",EC_PUBLIC_KEY_TYPE_INVALID:"public key should be a Buffer",EC_PUBLIC_KEY_LENGTH_INVALID:"public key length is invalid",EC_PUBLIC_KEY_PARSE_FAIL:"the public key could not be parsed or is invalid",EC_PUBLIC_KEY_CREATE_FAIL:"private was invalid, try again",EC_PUBLIC_KEY_TWEAK_ADD_FAIL:"tweak out of range or resulting public key is invalid",EC_PUBLIC_KEY_TWEAK_MUL_FAIL:"tweak out of range",EC_PUBLIC_KEY_COMBINE_FAIL:"the sum of the public keys is not valid",ECDH_FAIL:"scalar was invalid (zero or overflow)",ECDSA_SIGNATURE_TYPE_INVALID:"signature should be a Buffer",ECDSA_SIGNATURE_LENGTH_INVALID:"signature length is invalid",ECDSA_SIGNATURE_PARSE_FAIL:"couldn't parse signature",ECDSA_SIGNATURE_PARSE_DER_FAIL:"couldn't parse DER signature",ECDSA_SIGNATURE_SERIALIZE_DER_FAIL:"couldn't serialize signature to DER format",ECDSA_SIGN_FAIL:"nonce generation function failed or private key is invalid",ECDSA_RECOVER_FAIL:"couldn't recover public key from signature",MSG32_TYPE_INVALID:"message should be a Buffer",MSG32_LENGTH_INVALID:"message length is invalid",OPTIONS_TYPE_INVALID:"options should be an Object",OPTIONS_DATA_TYPE_INVALID:"options.data should be a Buffer",OPTIONS_DATA_LENGTH_INVALID:"options.data length is invalid",OPTIONS_NONCEFN_TYPE_INVALID:"options.noncefn should be a Function",RECOVERY_ID_TYPE_INVALID:"recovery should be a Number",RECOVERY_ID_VALUE_INVALID:"recovery should have value between -1 and 4",TWEAK_TYPE_INVALID:"tweak should be a Buffer",TWEAK_LENGTH_INVALID:"tweak length is invalid"}}}},{package:"secp256k1",file:"/home/gudahtt/projects/metamask-extension/node_modules/eth-trezor-keyring/node_modules/secp256k1/lib/messages.json"}],[249,{"./constants":248,"./int-table":250,"./print":251,"./util":252,"./varint-table":253,"uint8arrays/concat":256,varint:245},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("varint"),i=e("./int-table"),s=e("./varint-table"),o=e("./util"),a=e("uint8arrays/concat");const u=e("./constants"),c=e("./print");t.exports={addPrefix:function(e,t){let r;if(e instanceof Uint8Array)r=o.varintUint8ArrayEncode(e);else{if(!s[e])throw new Error("multicodec not recognized");r=s[e]}return a([r,t],r.length+t.length)},rmPrefix:function(e){return n.decode(e),e.slice(n.decode.bytes)},getCodec:function(e){const t=n.decode(e),r=i.get(t);if(r===undefined)throw new Error(`Code ${t} not found`);return r},getName:function(e){return i.get(e)},getNumber:function(e){const t=s[e];if(t===undefined)throw new Error("Codec `"+e+"` not found");return n.decode(t)},getCode:function(e){return n.decode(e)},getCodeVarint:function(e){const t=s[e];if(t===undefined)throw new Error("Codec `"+e+"` not found");return t},getVarint:function(e){return n.encode(e)},print:c,...u}}}},{package:"multicodec",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/index.js"}],[25,{"./background-api":22,"./caveat-mutators":23,"./enums":24,"./permission-log":26,"./selectors":27,"./specifications":28},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./caveat-mutators");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}}))}));var i=e("./background-api");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===i[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return i[e]}}))}));var s=e("./enums");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===s[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return s[e]}}))}));var o=e("./permission-log");Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===o[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return o[e]}}))}));var a=e("./specifications");Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===a[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return a[e]}}))}));var u=e("./selectors");Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===u[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return u[e]}}))}))}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/permissions/index.js"}],[250,{"./base-table":247},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i=new Map;for(const e in n){const t=n[e];i.set(t,e)}t.exports=Object.freeze(i)}}},{package:"multicodec",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/int-table.js"}],[251,{"./base-table":247},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i={};for(const[e,t]of Object.entries(n))i[t]===undefined&&(i[t]=e);t.exports=Object.freeze(i)}}},{package:"multicodec",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/print.js"}],[252,{"uint8arrays/from-string":257,"uint8arrays/to-string":262,varint:245},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("varint"),i=e("uint8arrays/to-string"),s=e("uint8arrays/from-string");function o(e){return parseInt(i(e,"base16"),16)}t.exports={numberToUint8Array:function(e){let t=e.toString(16);t.length%2==1&&(t="0"+t);return s(t,"base16")},uint8ArrayToNumber:o,varintUint8ArrayEncode:function(e){return Uint8Array.from(n.encode(o(e)))},varintEncode:function(e){return Uint8Array.from(n.encode(e))}}}}},{package:"multicodec",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/util.js"}],[2527,{bs58check:2090,crypto:2191,"ethereumjs-util":2532,randombytes:5554,"safe-buffer":5739,scryptsy:5749,"uuid/v4":2541},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("safe-buffer").Buffer,s=e("ethereumjs-util"),o=e("crypto"),a=e("randombytes"),u=e("scryptsy"),c=e("uuid/v4"),h=e("bs58check");function l(e,t){if(!e)throw new Error(t||"Assertion failed")}function f(e,t){return i.concat([e.update(t),e.final()])}var d=function(e,t){if(e&&t)throw new Error("Cannot supply both a private and a public key to the constructor");if(e&&!s.isValidPrivate(e))throw new Error("Private key does not satisfy the curve requirements (ie. it is invalid)");if(t&&!s.isValidPublic(t))throw new Error("Invalid public key");this._privKey=e,this._pubKey=t};Object.defineProperty(d.prototype,"privKey",{get:function(){return l(this._privKey,"This is a public key only wallet"),this._privKey}}),Object.defineProperty(d.prototype,"pubKey",{get:function(){return this._pubKey||(this._pubKey=s.privateToPublic(this.privKey)),this._pubKey}}),d.generate=function(e){if(!e)return new d(a(32));for(var t=new s.BN("088f924eeceeda7fe92e1f5b0fffffffffffffff",16);;){var r=a(32);if(new s.BN(s.privateToAddress(r)).lte(t))return new d(r)}},d.generateVanityAddress=function(e){for("object"!==(void 0===e?"undefined":n(e))&&(e=new RegExp(e));;){var t=a(32),r=s.privateToAddress(t);if(e.test(r.toString("hex")))return new d(t)}},d.prototype.getPrivateKey=function(){return this.privKey},d.prototype.getPrivateKeyString=function(){return s.bufferToHex(this.getPrivateKey())},d.prototype.getPublicKey=function(){return this.pubKey},d.prototype.getPublicKeyString=function(){return s.bufferToHex(this.getPublicKey())},d.prototype.getAddress=function(){return s.publicToAddress(this.pubKey)},d.prototype.getAddressString=function(){return s.bufferToHex(this.getAddress())},d.prototype.getChecksumAddressString=function(){return s.toChecksumAddress(this.getAddressString())},d.prototype.toV3=function(e,t){l(this._privKey,"This is a public key only wallet");var r,n=(t=t||{}).salt||a(32),h=t.iv||a(16),d=t.kdf||"scrypt",p={dklen:t.dklen||32,salt:n.toString("hex")};if("pbkdf2"===d)p.c=t.c||262144,p.prf="hmac-sha256",r=o.pbkdf2Sync(i.from(e),n,p.c,p.dklen,"sha256");else{if("scrypt"!==d)throw new Error("Unsupported kdf");p.n=t.n||262144,p.r=t.r||8,p.p=t.p||1,r=u(i.from(e),n,p.n,p.r,p.p,p.dklen)}var m=o.createCipheriv(t.cipher||"aes-128-ctr",r.slice(0,16),h);if(!m)throw new Error("Unsupported cipher");var g=f(m,this.privKey),y=s.keccak256(i.concat([r.slice(16,32),i.from(g,"hex")]));return{version:3,id:c({random:t.uuid||a(16)}),address:this.getAddress().toString("hex"),crypto:{ciphertext:g.toString("hex"),cipherparams:{iv:h.toString("hex")},cipher:t.cipher||"aes-128-ctr",kdf:d,kdfparams:p,mac:y.toString("hex")}}},d.prototype.getV3Filename=function(e){return["UTC--",(e?new Date(e):new Date).toJSON().replace(/:/g,"-"),"--",this.getAddress().toString("hex")].join("")},d.prototype.toV3String=function(e,t){return JSON.stringify(this.toV3(e,t))},d.fromPublicKey=function(e,t){return t&&(e=s.importPublic(e)),new d(null,e)},d.fromExtendedPublicKey=function(e){return l("xpub"===e.slice(0,4),"Not an extended public key"),e=h.decode(e).slice(45),d.fromPublicKey(e,!0)},d.fromPrivateKey=function(e){return new d(e)},d.fromExtendedPrivateKey=function(e){l("xprv"===e.slice(0,4),"Not an extended private key");var t=h.decode(e);return l(0===t[45],"Invalid extended private key"),d.fromPrivateKey(t.slice(46))},d.fromV1=function(e,t){l("string"==typeof t);var r="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e);if("1"!==r.Version)throw new Error("Not a V1 wallet");if("scrypt"!==r.Crypto.KeyHeader.Kdf)throw new Error("Unsupported key derivation scheme");var a=r.Crypto.KeyHeader.KdfParams,c=u(i.from(t),i.from(r.Crypto.Salt,"hex"),a.N,a.R,a.P,a.DkLen),h=i.from(r.Crypto.CipherText,"hex");if(s.keccak256(i.concat([c.slice(16,32),h])).toString("hex")!==r.Crypto.MAC)throw new Error("Key derivation failed - possibly wrong passphrase");var p=f(o.createDecipheriv("aes-128-cbc",s.keccak256(c.slice(0,16)).slice(0,16),i.from(r.Crypto.IV,"hex")),h);return new d(p)},d.fromV3=function(e,t,r){l("string"==typeof t);var a,c,h="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(r?e.toLowerCase():e);if(3!==h.version)throw new Error("Not a V3 wallet");if("scrypt"===h.crypto.kdf)c=h.crypto.kdfparams,a=u(i.from(t),i.from(c.salt,"hex"),c.n,c.r,c.p,c.dklen);else{if("pbkdf2"!==h.crypto.kdf)throw new Error("Unsupported key derivation scheme");if("hmac-sha256"!==(c=h.crypto.kdfparams).prf)throw new Error("Unsupported parameters to PBKDF2");a=o.pbkdf2Sync(i.from(t),i.from(c.salt,"hex"),c.c,c.dklen,"sha256")}var p=i.from(h.crypto.ciphertext,"hex");if(s.keccak256(i.concat([a.slice(16,32),p])).toString("hex")!==h.crypto.mac)throw new Error("Key derivation failed - possibly wrong passphrase");var m=f(o.createDecipheriv(h.crypto.cipher,a.slice(0,16),i.from(h.crypto.cipherparams.iv,"hex")),p);return new d(m)},d.fromEthSale=function(e,t){l("string"==typeof t);var r="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e),a=i.from(r.encseed,"hex"),u=o.pbkdf2Sync(t,t,2e3,32,"sha256").slice(0,16),c=f(o.createDecipheriv("aes-128-cbc",u,a.slice(0,16)),a.slice(16)),h=new d(s.keccak256(c));if(h.getAddress().toString("hex")!==r.ethaddr)throw new Error("Decoded key mismatch - possibly wrong passphrase");return h},t.exports=d}}},{package:"ethereumjs-wallet",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/index.js"}],[2528,{"./bytes":2529,"./hash":2531,"./secp256k1v3-adapter":2534,assert:1700,"bn.js":2037,buffer:2081,"ethjs-util":2538},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.importPublic=r.privateToPublic=r.privateToAddress=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.isPrecompiled=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isZeroAddress=r.isValidAddress=r.zeroAddress=void 0;var n=e("assert"),i=e("ethjs-util"),s=e("./secp256k1v3-adapter"),o=e("bn.js"),a=e("./bytes"),u=e("./hash");r.zeroAddress=function(){var e=a.zeros(20);return a.bufferToHex(e)},r.isValidAddress=function(e){return/^0x[0-9a-fA-F]{40}$/.test(e)},r.isZeroAddress=function(e){return r.zeroAddress()===a.addHexPrefix(e)},r.toChecksumAddress=function(e,t){e=i.stripHexPrefix(e).toLowerCase();for(var r=t!==undefined?t.toString()+"0x":"",n=u.keccak(r+e).toString("hex"),s="0x",o=0;o<e.length;o++)parseInt(n[o],16)>=8?s+=e[o].toUpperCase():s+=e[o];return s},r.isValidChecksumAddress=function(e,t){return r.isValidAddress(e)&&r.toChecksumAddress(e,t)===e},r.generateAddress=function(e,r){e=a.toBuffer(e);var n=new o(r);return n.isZero()?u.rlphash([e,null]).slice(-20):u.rlphash([e,t.from(n.toArray())]).slice(-20)},r.generateAddress2=function(e,r,i){var s=a.toBuffer(e),o=a.toBuffer(r),c=a.toBuffer(i);return n(20===s.length),n(32===o.length),u.keccak256(t.concat([t.from("ff","hex"),s,o,u.keccak256(c)])).slice(-20)},r.isPrecompiled=function(e){var t=a.unpad(e);return 1===t.length&&t[0]>=1&&t[0]<=8},r.isValidPrivate=function(e){return s.privateKeyVerify(e)},r.isValidPublic=function(e,r){return void 0===r&&(r=!1),64===e.length?s.publicKeyVerify(t.concat([t.from([4]),e])):!!r&&s.publicKeyVerify(e)},r.pubToAddress=function(e,t){return void 0===t&&(t=!1),e=a.toBuffer(e),t&&64!==e.length&&(e=s.publicKeyConvert(e,!1).slice(1)),n(64===e.length),u.keccak(e).slice(-20)},r.publicToAddress=r.pubToAddress,r.privateToAddress=function(e){return r.publicToAddress(r.privateToPublic(e))},r.privateToPublic=function(e){return e=a.toBuffer(e),s.publicKeyCreate(e,!1).slice(1)},r.importPublic=function(e){return 64!==(e=a.toBuffer(e)).length&&(e=s.publicKeyConvert(e,!1).slice(1)),e}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/account.js"}],[2529,{"bn.js":2037,buffer:2081,"ethjs-util":2538},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.baToJSON=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToHex=r.bufferToInt=r.toBuffer=r.stripZeros=r.unpad=r.setLengthRight=r.setLength=r.setLengthLeft=r.zeros=void 0;var n=e("ethjs-util"),i=e("bn.js");r.zeros=function(e){return t.allocUnsafe(e).fill(0)},r.setLengthLeft=function(e,t,n){void 0===n&&(n=!1);var i=r.zeros(t);return e=r.toBuffer(e),n?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)},r.setLength=r.setLengthLeft,r.setLengthRight=function(e,t){return r.setLength(e,t,!0)},r.unpad=function(e){for(var t=(e=n.stripHexPrefix(e))[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e},r.stripZeros=r.unpad,r.toBuffer=function(e){if(!t.isBuffer(e))if(Array.isArray(e))e=t.from(e);else if("string"==typeof e){if(!n.isHexString(e))throw new Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: "+e);e=t.from(n.padToEven(n.stripHexPrefix(e)),"hex")}else if("number"==typeof e)e=n.intToBuffer(e);else if(null===e||e===undefined)e=t.allocUnsafe(0);else if(i.isBN(e))e=e.toArrayLike(t);else{if(!e.toArray)throw new Error("invalid type");e=t.from(e.toArray())}return e},r.bufferToInt=function(e){return new i(r.toBuffer(e)).toNumber()},r.bufferToHex=function(e){return"0x"+(e=r.toBuffer(e)).toString("hex")},r.fromSigned=function(e){return new i(e).fromTwos(256)},r.toUnsigned=function(e){return t.from(e.toTwos(256).toArray())},r.addHexPrefix=function(e){return"string"!=typeof e||n.isHexPrefixed(e)?e:"0x"+e},r.baToJSON=function(e){if(t.isBuffer(e))return"0x"+e.toString("hex");if(e instanceof Array){for(var n=[],i=0;i<e.length;i++)n.push(r.baToJSON(e[i]));return n}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/bytes.js"}],[253,{"./base-table":247,"./util":252},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i=e("./util").varintEncode,s={};for(const e in n){const t=n[e];s[e]=i(t)}t.exports=Object.freeze(s)}}},{package:"multicodec",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/varint-table.js"}],[2530,{"bn.js":2037,buffer:2081},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.MAX_INTEGER=void 0;var n=e("bn.js");r.MAX_INTEGER=new n("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new n("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=t.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=t.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=t.from(r.KECCAK256_RLP_S,"hex")}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/constants.js"}],[2531,{"./bytes":2529,buffer:2081,"create-hash":2185,"ethereum-cryptography/keccak":2490,"ethjs-util":2538,rlp:5737},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.rlphash=r.ripemd160=r.sha256=r.keccak256=r.keccak=void 0;var n=e("ethereum-cryptography/keccak"),i=n.keccak224,s=n.keccak384,o=n.keccak256,a=n.keccak512,u=e("create-hash"),c=e("ethjs-util"),h=e("rlp"),l=e("./bytes");r.keccak=function(e,r){switch(void 0===r&&(r=256),e="string"!=typeof e||c.isHexString(e)?l.toBuffer(e):t.from(e,"utf8"),r||(r=256),r){case 224:return i(e);case 256:return o(e);case 384:return s(e);case 512:return a(e);default:throw new Error("Invald algorithm: keccak"+r)}},r.keccak256=function(e){return r.keccak(e)},r.sha256=function(e){return e=l.toBuffer(e),u("sha256").update(e).digest()},r.ripemd160=function(e,t){e=l.toBuffer(e);var r=u("rmd160").update(e).digest();return!0===t?l.setLength(r,32):r},r.rlphash=function(e){return r.keccak(h.encode(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/hash.js"}],[2532,{"./account":2528,"./bytes":2529,"./constants":2530,"./hash":2531,"./object":2533,"./secp256k1v3-adapter":2534,"./signature":2537,"bn.js":2037,"ethjs-util":2538,rlp:5737},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.secp256k1=r.rlp=r.BN=void 0;var s=e("./secp256k1v3-adapter");r.secp256k1=s;var o=e("ethjs-util"),a=e("bn.js");r.BN=a;var u=e("rlp");r.rlp=u,Object.assign(r,o),i(e("./constants"),r),i(e("./account"),r),i(e("./hash"),r),i(e("./signature"),r),i(e("./bytes"),r),i(e("./object"),r)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/index.js"}],[2533,{"./bytes":2529,assert:1700,buffer:2081,"ethjs-util":2538,rlp:5737},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.defineProperties=void 0;var n=e("assert"),i=e("ethjs-util"),s=e("rlp"),o=e("./bytes");r.defineProperties=function(e,r,a){if(e.raw=[],e._fields=[],e.toJSON=function(t){if(void 0===t&&(t=!1),t){var r={};return e._fields.forEach((function(t){r[t]="0x"+e[t].toString("hex")})),r}return o.baToJSON(e.raw)},e.serialize=function(){return s.encode(e.raw)},r.forEach((function(r,i){function s(){return e.raw[i]}function a(s){"00"!==(s=o.toBuffer(s)).toString("hex")||r.allowZero||(s=t.allocUnsafe(0)),r.allowLess&&r.length?(s=o.stripZeros(s),n(r.length>=s.length,"The field "+r.name+" must not have more "+r.length+" bytes")):r.allowZero&&0===s.length||!r.length||n(r.length===s.length,"The field "+r.name+" must have byte length of "+r.length),e.raw[i]=s}e._fields.push(r.name),Object.defineProperty(e,r.name,{enumerable:!0,configurable:!0,get:s,set:a}),r.default&&(e[r.name]=r.default),r.alias&&Object.defineProperty(e,r.alias,{enumerable:!1,configurable:!0,set:a,get:s})})),a)if("string"==typeof a&&(a=t.from(i.stripHexPrefix(a),"hex")),t.isBuffer(a)&&(a=s.decode(a)),Array.isArray(a)){if(a.length>e._fields.length)throw new Error("wrong number of fields in data");a.forEach((function(t,r){e[e._fields[r]]=o.toBuffer(t)}))}else{if("object"!=typeof a)throw new Error("invalid data");var u=Object.keys(a);r.forEach((function(t){-1!==u.indexOf(t.name)&&(e[t.name]=a[t.name]),-1!==u.indexOf(t.alias)&&(e[t.alias]=a[t.alias])}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/object.js"}],[2534,{"./secp256k1v3-lib/der":2535,"./secp256k1v3-lib/index":2536,buffer:2081,"ethereum-cryptography/secp256k1":2498},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.ecdhUnsafe=r.ecdh=r.recover=r.verify=r.sign=r.signatureImportLax=r.signatureImport=r.signatureExport=r.signatureNormalize=r.publicKeyCombine=r.publicKeyTweakMul=r.publicKeyTweakAdd=r.publicKeyVerify=r.publicKeyConvert=r.publicKeyCreate=r.privateKeyTweakMul=r.privateKeyTweakAdd=r.privateKeyModInverse=r.privateKeyNegate=r.privateKeyImport=r.privateKeyExport=r.privateKeyVerify=void 0;var n=e("ethereum-cryptography/secp256k1"),i=e("./secp256k1v3-lib/index"),s=e("./secp256k1v3-lib/der");r.privateKeyVerify=function(e){return 32===e.length&&n.privateKeyVerify(Uint8Array.from(e))},r.privateKeyExport=function(e,t){if(32!==e.length)throw new RangeError("private key length is invalid");var r=i.privateKeyExport(e,t);return s.privateKeyExport(e,r,t)},r.privateKeyImport=function(e){if(null!==(e=s.privateKeyImport(e))&&32===e.length&&r.privateKeyVerify(e))return e;throw new Error("couldn't import from DER format")},r.privateKeyNegate=function(e){return t.from(n.privateKeyNegate(Uint8Array.from(e)))},r.privateKeyModInverse=function(e){if(32!==e.length)throw new Error("private key length is invalid");return t.from(i.privateKeyModInverse(Uint8Array.from(e)))},r.privateKeyTweakAdd=function(e,r){return t.from(n.privateKeyTweakAdd(Uint8Array.from(e),r))},r.privateKeyTweakMul=function(e,r){return t.from(n.privateKeyTweakMul(Uint8Array.from(e),Uint8Array.from(r)))},r.publicKeyCreate=function(e,r){return t.from(n.publicKeyCreate(Uint8Array.from(e),r))},r.publicKeyConvert=function(e,r){return t.from(n.publicKeyConvert(Uint8Array.from(e),r))},r.publicKeyVerify=function(e){return(33===e.length||65===e.length)&&n.publicKeyVerify(Uint8Array.from(e))},r.publicKeyTweakAdd=function(e,r,i){return t.from(n.publicKeyTweakAdd(Uint8Array.from(e),Uint8Array.from(r),i))},r.publicKeyTweakMul=function(e,r,i){return t.from(n.publicKeyTweakMul(Uint8Array.from(e),Uint8Array.from(r),i))},r.publicKeyCombine=function(e,r){var i=[];return e.forEach((function(e){i.push(Uint8Array.from(e))})),t.from(n.publicKeyCombine(i,r))},r.signatureNormalize=function(e){return t.from(n.signatureNormalize(Uint8Array.from(e)))},r.signatureExport=function(e){return t.from(n.signatureExport(Uint8Array.from(e)))},r.signatureImport=function(e){return t.from(n.signatureImport(Uint8Array.from(e)))},r.signatureImportLax=function(e){if(0===e.length)throw new RangeError("signature length is invalid");var t=s.signatureImportLax(e);if(null===t)throw new Error("couldn't parse DER signature");return i.signatureImport(t)},r.sign=function(e,r,i){if(null===i)throw new TypeError("options should be an Object");var s=undefined;if(i){if(s={},null===i.data)throw new TypeError("options.data should be a Buffer");if(i.data){if(32!=i.data.length)throw new RangeError("options.data length is invalid");s.data=new Uint8Array(i.data)}if(null===i.noncefn)throw new TypeError("options.noncefn should be a Function");i.noncefn&&(s.noncefn=function(e,r,n,s,o){var a=null!=n?t.from(n):null,u=null!=s?t.from(s):null,c=t.from("");return i.noncefn&&(c=i.noncefn(t.from(e),t.from(r),a,u,o)),new Uint8Array(c)})}var o=n.ecdsaSign(Uint8Array.from(e),Uint8Array.from(r),s);return{signature:t.from(o.signature),recovery:o.recid}},r.verify=function(e,t,r){return n.ecdsaVerify(Uint8Array.from(t),Uint8Array.from(e),r)},r.recover=function(e,r,i,s){return t.from(n.ecdsaRecover(Uint8Array.from(r),i,Uint8Array.from(e),s))},r.ecdh=function(e,r){return t.from(n.ecdh(Uint8Array.from(e),Uint8Array.from(r),{}))},r.ecdhUnsafe=function(e,r,n){if(33!==e.length&&65!==e.length)throw new RangeError("public key length is invalid");if(32!==r.length)throw new RangeError("private key length is invalid");return t.from(i.ecdhUnsafe(Uint8Array.from(e),Uint8Array.from(r),n))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/secp256k1v3-adapter.js"}],[2535,{buffer:2081},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=e.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r.privateKeyExport=function(r,i,s){void 0===s&&(s=!0);var o=e.from(s?t:n);return r.copy(o,s?8:9),i.copy(o,s?181:214),o},r.privateKeyImport=function(e){var t=e.length,r=0;if(t<r+1||48!==e[r])return null;if(t<(r+=1)+1||!(128&e[r]))return null;var n=127&e[r];if(n<1||n>2)return null;if(t<(r+=1)+n)return null;var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);return t<(r+=n)+i||t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2]||t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]?null:e.slice(r+2,r+2+e[r+1])},r.signatureImportLax=function(t){var r=e.alloc(32,0),n=e.alloc(32,0),i=t.length,s=0;if(48!==t[s++])return null;var o=t[s++];if(128&o&&(s+=o-128)>i)return null;if(2!==t[s++])return null;var a=t[s++];if(128&a){if(s+(o=a-128)>i)return null;for(;o>0&&0===t[s];s+=1,o-=1);for(a=0;o>0;s+=1,o-=1)a=(a<<8)+t[s]}if(a>i-s)return null;var u=s;if(s+=a,2!==t[s++])return null;var c=t[s++];if(128&c){if(s+(o=c-128)>i)return null;for(;o>0&&0===t[s];s+=1,o-=1);for(c=0;o>0;s+=1,o-=1)c=(c<<8)+t[s]}if(c>i-s)return null;var h=s;for(s+=c;a>0&&0===t[u];a-=1,u+=1);if(a>32)return null;var l=t.slice(u,u+a);for(l.copy(r,32-l.length);c>0&&0===t[h];c-=1,h+=1);if(c>32)return null;var f=t.slice(h,h+c);return f.copy(n,32-f.length),{r:r,s:n}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/secp256k1v3-lib/der.js"}],[2536,{"bn.js":2037,buffer:2081,elliptic:2315},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=e("bn.js"),i=new(0,e("elliptic").ec)("secp256k1"),s=i.curve;r.privateKeyExport=function(e,t){void 0===t&&(t=!0);var r=new n(e);if(r.ucmp(s.n)>=0)throw new Error("couldn't export to DER format");var a=i.g.mul(r);return o(a.getX(),a.getY(),t)},r.privateKeyModInverse=function(e){var r=new n(e);if(r.ucmp(s.n)>=0||r.isZero())throw new Error("private key range is invalid");return r.invm(s.n).toArrayLike(t,"be",32)},r.signatureImport=function(e){var r=new n(e.r);r.ucmp(s.n)>=0&&(r=new n(0));var i=new n(e.s);return i.ucmp(s.n)>=0&&(i=new n(0)),t.concat([r.toArrayLike(t,"be",32),i.toArrayLike(t,"be",32)])},r.ecdhUnsafe=function(e,t,r){void 0===r&&(r=!0);var a=i.keyFromPublic(e),u=new n(t);if(u.ucmp(s.n)>=0||u.isZero())throw new Error("scalar was invalid (zero or overflow)");var c=a.pub.mul(u);return o(c.getX(),c.getY(),r)};var o=function(e,r,n){var i;return n?((i=t.alloc(33))[0]=r.isOdd()?3:2,e.toArrayLike(t,"be",32).copy(i,1)):((i=t.alloc(65))[0]=4,e.toArrayLike(t,"be",32).copy(i,1),r.toArrayLike(t,"be",32).copy(i,33)),i}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/secp256k1v3-lib/index.js"}],[2537,{"./bytes":2529,"./hash":2531,"./secp256k1v3-adapter":2534,"bn.js":2037,buffer:2081},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;var n=e("./secp256k1v3-adapter"),i=e("bn.js"),s=e("./bytes"),o=e("./hash");function a(e,t){return t?e-(2*t+35):e-27}function u(e){return 0===e||1===e}r.ecsign=function(e,t,r){var i=n.sign(e,t),s=i.recovery;return{r:i.signature.slice(0,32),s:i.signature.slice(32,64),v:r?s+(2*r+35):s+27}},r.ecrecover=function(e,r,i,o,c){var h=t.concat([s.setLength(i,32),s.setLength(o,32)],64),l=a(r,c);if(!u(l))throw new Error("Invalid signature v value");var f=n.recover(e,h,l);return n.publicKeyConvert(f,!1).slice(1)},r.toRpcSig=function(e,r,n,i){if(!u(a(e,i)))throw new Error("Invalid signature v value");return s.bufferToHex(t.concat([s.setLengthLeft(r,32),s.setLengthLeft(n,32),s.toBuffer(e)]))},r.fromRpcSig=function(e){var t=s.toBuffer(e);if(65!==t.length)throw new Error("Invalid signature length");var r=t[64];return r<27&&(r+=27),{v:r,r:t.slice(0,32),s:t.slice(32,64)}},r.isValidSignature=function(e,t,r,n,s){void 0===n&&(n=!0);var o=new i("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),c=new i("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(32!==t.length||32!==r.length)return!1;if(!u(a(e,s)))return!1;var h=new i(t),l=new i(r);return!(h.isZero()||h.gt(c)||l.isZero()||l.gt(c))&&(!n||1!==l.cmp(o))},r.hashPersonalMessage=function(e){var r=t.from("Ethereum Signed Message:\n"+e.length.toString(),"utf-8");return o.keccak(t.concat([r,e]))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/signature.js"}],[2538,{buffer:2081,"is-hex-prefixed":4694,"strip-hex-prefix":5899},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("is-hex-prefixed"),i=e("strip-hex-prefix");function s(e){var t=e;if("string"!=typeof t)throw new Error("[ethjs-util] while padding to even, value must be string, is currently "+typeof t+", while padToEven.");return t.length%2&&(t="0"+t),t}function o(e){return"0x"+e.toString(16)}t.exports={arrayContainsArray:function(e,t,r){if(!0!==Array.isArray(e))throw new Error("[ethjs-util] method arrayContainsArray requires input 'superset' to be an array got type '"+typeof e+"'");if(!0!==Array.isArray(t))throw new Error("[ethjs-util] method arrayContainsArray requires input 'subset' to be an array got type '"+typeof t+"'");return t[Boolean(r)?"some":"every"]((function(t){return e.indexOf(t)>=0}))},intToBuffer:function(e){var t=o(e);return new r(s(t.slice(2)),"hex")},getBinarySize:function(e){if("string"!=typeof e)throw new Error("[ethjs-util] while getting binary size, method getBinarySize requires input 'str' to be type String, got '"+typeof e+"'.");return r.byteLength(e,"utf8")},isHexPrefixed:n,stripHexPrefix:i,padToEven:s,intToHex:o,fromAscii:function(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r).toString(16);t+=n.length<2?"0"+n:n}return"0x"+t},fromUtf8:function(e){return"0x"+s(new r(e,"utf8").toString("hex")).replace(/^0+|0+$/g,"")},toAscii:function(e){var t="",r=0,n=e.length;for("0x"===e.substring(0,2)&&(r=2);r<n;r+=2){var i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t},toUtf8:function(e){return new r(s(i(e).replace(/^0+|0+$/g,"")),"hex").toString("utf8")},getKeys:function(e,t,r){if(!Array.isArray(e))throw new Error("[ethjs-util] method getKeys expecting type Array as 'params' input, got '"+typeof e+"'");if("string"!=typeof t)throw new Error("[ethjs-util] method getKeys expecting type String for input 'key' got '"+typeof t+"'.");for(var n=[],i=0;i<e.length;i++){var s=e[i][t];if(r&&!s)s="";else if("string"!=typeof s)throw new Error("invalid abi");n.push(s)}return n},isHexString:function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethjs-util",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/ethjs-util/lib/index.js"}],[2539,{},function(){with(this)return function(){"use strict";return function(e,t,r){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}}}},{package:"uuid",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/uuid/lib/bytesToUuid.js"}],[254,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});t.exports={names:n}}}},{package:"multihashes",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multihashes/src/constants.js"}],[2540,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var s=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}}}},{package:"uuid",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/uuid/lib/rng-browser.js"}],[2541,{"./lib/bytesToUuid":2539,"./lib/rng":2540},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./lib/rng"),i=e("./lib/bytesToUuid");t.exports=function(e,t,r){var s=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[s+a]=o[a];return t||i(o)}}}},{package:"uuid",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/node_modules/uuid/v4.js"}],[2542,{"./index.js":2527,"aes-js":1675,crypto:2191,"ethereumjs-util":2532,"safe-buffer":5739,scryptsy:5749,utf8:6007},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./index.js"),s=e("ethereumjs-util"),o=e("crypto"),a=e("scryptsy"),u=e("utf8"),c=e("aes-js"),h=e("safe-buffer").Buffer;function l(e,t){if(!e)throw new Error(t||"Assertion failed")}var f={};f.fromEtherWallet=function(e,t){var r,s="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e);if(s.locked){if("string"!=typeof t)throw new Error("Password required");if(t.length<7)throw new Error("Password must be at least 7 characters");var a=s.encrypted?s.private.slice(0,128):s.private;if(a=function(e){var t=h.from(e,"base64");return"Salted__"===t.slice(0,8).toString()?{salt:t.slice(8,16),ciphertext:t.slice(16)}:{ciphertext:t}}(a),!a.salt)throw new Error("Unsupported EtherWallet key format");var c=function(e,t,r){function n(n){var i=o.createHash(r.digest||"md5");i.update(n),i.update(e),i.update(t),n=i.digest();for(var s=1;s<(r.count||1);s++)(i=o.createHash(r.digest||"md5")).update(n),n=i.digest();return n}for(var i=r.keysize||16,s=r.ivsize||16,a=[],u=0;h.concat(a).length<i+s;)a[u]=n(0===u?h.alloc(0):a[u-1]),u++;var c=h.concat(a);return{key:c.slice(0,i),iv:c.slice(i,i+s)}}(h.from(t),a.salt,{keysize:32,ivsize:16});r=function(e,t){return h.concat([e.update(t),e.final()])}(o.createDecipheriv("aes-256-cbc",c.key,c.iv),h.from(a.ciphertext)),r=h.from(u.decode(r.toString()),"hex")}else{if(64!==s.private.length)throw new Error("Invalid private key length");r=h.from(s.private,"hex")}var l=new i(r);if(l.getAddressString()!==s.address)throw new Error("Invalid private key or address");return l},f.fromEtherCamp=function(e){return new i(s.keccak256(h.from(e)))},f.fromKryptoKit=function(e,t){"#"===e[0]&&(e=e.slice(1));var r,n=e[0];if(e=e.slice(1),"d"===n)r=s.sha256(h.from(e));else{if("q"!==n)throw new Error("Unsupported or invalid entropy type");if("string"!=typeof t)throw new Error("Password required");var o=s.sha256(h.from(e.slice(0,30))),u=e.slice(30,46),l=function(e){function t(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}for(var r="",n="",i=0;i<e.length;i++)e[i]<=127?(r+=t(n)+String.fromCharCode(e[i]),n=""):n+="%"+e[i].toString(16);return h.from(r+t(n))}(o),f=a(h.from(t,"utf8"),l,16384,8,1,32),d=new c.ModeOfOperation.ecb(f);if(r=h.concat([h.from(d.decrypt(o.slice(0,16))),h.from(d.decrypt(o.slice(16,32)))]),u.length>0&&u!==s.sha256(s.sha256(r)).slice(0,8).toString("hex"))throw new Error("Failed to decrypt input - possibly invalid passphrase")}return new i(r)},f.fromQuorumWallet=function(e,t){l(e.length>=10),l(t.length>=10);var r=e+t;return r=o.pbkdf2Sync(r,r,2e3,32,"sha256"),new i(r)},t.exports=f}}},{package:"ethereumjs-wallet",file:"/home/gudahtt/projects/metamask-extension/node_modules/ethereumjs-wallet/thirdparty.js"}],[255,{"./constants":254,buffer:2081,multibase:240,varint:6031,"web-encoding":6035},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("multibase"),s=e("varint"),{names:o}=e("./constants"),{TextDecoder:a}=e("web-encoding"),u=new a,c={};for(const e in o)c[o[e]]=e;function h(e){r.decode(e)}r.names=o,r.codes=Object.freeze(c),r.toHexString=function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return(n.isBuffer(e)?e:n.from(e.buffer,e.byteOffset,e.byteLength)).toString("hex")},r.fromHexString=function(e){return n.from(e,"hex")},r.toB58String=function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return u.decode(i.encode("base58btc",e)).slice(1)},r.fromB58String=function(e){const t=e instanceof Uint8Array?u.decode(e):e;return i.decode("z"+t)},r.decode=function(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");let t=n.isBuffer(e)?e:n.from(e.buffer,e.byteOffset,e.byteLength);if(t.length<2)throw new Error("multihash too short. must be > 2 bytes.");const i=s.decode(t);if(!r.isValidCode(i))throw new Error(`multihash unknown function code: 0x${i.toString(16)}`);t=t.slice(s.decode.bytes);const o=s.decode(t);if(o<0)throw new Error(`multihash invalid length: ${o}`);if(t=t.slice(s.decode.bytes),t.length!==o)throw new Error(`multihash length inconsistent: 0x${t.toString("hex")}`);return{code:i,name:c[i],length:o,digest:t}},r.encode=function(e,t,i){if(!e||t===undefined)throw new Error("multihash encode requires at least two args: digest, code");const o=r.coerceCode(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==i&&(i=e.length),i&&e.length!==i)throw new Error("digest length should be equal to specified length.");const a=s.encode(o),u=s.encode(i),c=n.alloc(a.length+u.length+e.length);return c.set(a,0),c.set(u,a.length),c.set(e,a.length+u.length),c},r.coerceCode=function(e){let t=e;if("string"==typeof e){if(o[e]===undefined)throw new Error(`Unrecognized hash function named: ${e}`);t=o[e]}if("number"!=typeof t)throw new Error(`Hash function code should be a number. Got: ${t}`);if(c[t]===undefined&&!r.isAppCode(t))throw new Error(`Unrecognized function code: ${t}`);return t},r.isAppCode=function(e){return e>0&&e<16},r.isValidCode=function(e){return!!r.isAppCode(e)||!!c[e]},r.validate=h,r.prefix=function(e){return h(e),n.from(e.buffer,e.byteOffset,2)}}}},{package:"multihashes",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/multihashes/src/index.js"}],[256,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}},{package:"uint8arrays",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/uint8arrays/concat.js"}],[257,{"multibase/src/constants":259,"web-encoding":6035},function(){with(this)return function(){"use strict";return function(e,t,r){const{names:n}=e("multibase/src/constants"),{TextEncoder:i}=e("web-encoding"),s=new i;t.exports=function(e,t="utf8"){if("utf8"===t||"utf-8"===t)return s.encode(e);if("ascii"===t)return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e);const r=n[t];if(!r)throw new Error("Unknown base");return r.decode(e)}}}},{package:"uint8arrays",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/uint8arrays/from-string.js"}],[258,{"./util":261},function(){with(this)return function(){"use strict";return function(e,t,r){const{encodeText:n}=e("./util");t.exports=class{constructor(e,t,r,i){this.name=e,this.code=t,this.codeBuf=n(this.code),this.alphabet=i,this.codec=r(i)}encode(e){return this.codec.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.codec.decode(e)}}}}},{package:"multibase",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/uint8arrays/node_modules/multibase/src/base.js"}],[2582,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Object.prototype.hasOwnProperty,i="~";function s(){}function o(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,r,n,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,n||e,s),u=i?i+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new s:delete e._events[t]}function c(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(i=!1)),c.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},c.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,o=new Array(s);n<s;n++)o[n]=r[n].fn;return o},c.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},c.prototype.emit=function(e,t,r,n,s,o){var a=i?i+e:e;if(!this._events[a])return!1;var u,c,h=this._events[a],l=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,undefined,!0),l){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,r),!0;case 4:return h.fn.call(h.context,t,r,n),!0;case 5:return h.fn.call(h.context,t,r,n,s),!0;case 6:return h.fn.call(h.context,t,r,n,s,o),!0}for(c=1,u=new Array(l-1);c<l;c++)u[c-1]=arguments[c];h.fn.apply(h.context,u)}else{var f,d=h.length;for(c=0;c<d;c++)switch(h[c].once&&this.removeListener(e,h[c].fn,undefined,!0),l){case 1:h[c].fn.call(h[c].context);break;case 2:h[c].fn.call(h[c].context,t);break;case 3:h[c].fn.call(h[c].context,t,r);break;case 4:h[c].fn.call(h[c].context,t,r,n);break;default:if(!u)for(f=1,u=new Array(l-1);f<l;f++)u[f-1]=arguments[f];h[c].fn.apply(h[c].context,u)}}return!0},c.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},c.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},c.prototype.removeListener=function(e,t,r,n){var s=i?i+e:e;if(!this._events[s])return this;if(!t)return u(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||n&&!o.once||r&&o.context!==r||u(this,s);else{for(var a=0,c=[],h=o.length;a<h;a++)(o[a].fn!==t||n&&!o[a].once||r&&o[a].context!==r)&&c.push(o[a]);c.length?this._events[s]=1===c.length?c[0]:c:u(this,s)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&u(this,t)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,void 0!==t&&(t.exports=c)}}},{package:"eventemitter3",file:"/home/gudahtt/projects/metamask-extension/node_modules/eventemitter3/index.js"}],[259,{"./base.js":258,"./rfc4648":260,"./util":261,"@multiformats/base-x":1456},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("@multiformats/base-x"),i=e("./base.js"),{rfc4648:s}=e("./rfc4648"),{decodeText:o,encodeText:a}=e("./util"),u=[["identity","\0",()=>({encode:o,decode:a}),""],["base2","0",s(1),"01"],["base8","7",s(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",s(4),"0123456789abcdef"],["base16upper","F",s(4),"0123456789ABCDEF"],["base32hex","v",s(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",s(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",s(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",s(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",s(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",s(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",s(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",s(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",s(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],c=u.reduce(((e,t)=>(e[t[0]]=new i(t[0],t[1],t[2],t[3]),e)),{}),h=u.reduce(((e,t)=>(e[t[1]]=c[t[0]],e)),{});t.exports={names:c,codes:h}}}},{package:"multibase",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/uint8arrays/node_modules/multibase/src/constants.js"}],[26,{"../../../../shared/constants/permissions":6190,"./enums":24,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/obs-store":1193,"fast-safe-stringify":4299},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.PermissionLogController=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("@metamask/obs-store"),o=n(e("fast-safe-stringify")),a=e("../../../../shared/constants/permissions"),u=e("./enums");function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){return e.reduce(((e,r)=>h(h({},e),{},{[r]:t})),{})}r.PermissionLogController=class{constructor({restrictedMethods:e,initState:t}){this.restrictedMethods=e,this.store=new s.ObservableStore(h({permissionHistory:{},permissionActivityLog:[]},t))}getActivityLog(){return this.store.getState().permissionActivityLog}updateActivityLog(e){this.store.updateState({permissionActivityLog:e})}getHistory(){return this.store.getState().permissionHistory}updateHistory(e){this.store.updateState({permissionHistory:e})}updateAccountsHistory(e,t){if(0===t.length)return;const r=l(t,Date.now());this.commitNewHistory(e,{eth_accounts:{accounts:r}})}createMiddleware(){return(e,t,r,n)=>{let i,s;const{origin:o,method:a}=e,c=a.startsWith(u.WALLET_PREFIX);if(u.LOG_IGNORE_METHODS.includes(a)||!c&&!this.restrictedMethods.has(a)){if("eth_requestAccounts"!==a)return void r();i=this.logRequest(e,c),s=["eth_accounts"]}else i=this.logRequest(e,c),a===`${u.WALLET_PREFIX}requestPermissions`&&(s=this.getRequestedMethods(e));r((e=>{const r=Date.now();this.logResponse(i,t,r),s&&!t.error&&t.result&&this.logPermissionsHistory(s,o,t.result,r,"eth_requestAccounts"===a),e()}))}}logRequest(e,t){const r={id:e.id,method:e.method,methodType:t?u.LOG_METHOD_TYPES.internal:u.LOG_METHOD_TYPES.restricted,origin:e.origin,request:(0,o.default)(e,null,2),requestTime:Date.now(),response:null,responseTime:null,success:null};return this.commitNewActivity(r),r}logResponse(e,t,r){e&&t&&(e.response=(0,o.default)(t,null,2),e.responseTime=r,e.success=!t.error)}commitNewActivity(e){const t=this.getActivityLog();t.push(e),t.length>u.LOG_LIMIT&&t.shift(),this.updateActivityLog(t)}logPermissionsHistory(e,t,r,n,i){let s,o;if(i){s=r;o={eth_accounts:{accounts:l(s,n),lastApproved:n}}}else o=r.map((e=>("eth_accounts"===e.parentCapability&&(s=this.getAccountsFromPermission(e)),e.parentCapability))).reduce(((t,r)=>{if(e.includes(r))if("eth_accounts"===r){const e=l(s,n);t[r]={lastApproved:n,accounts:e}}else t[r]={lastApproved:n};return t}),{});Object.keys(o).length>0&&this.commitNewHistory(t,o)}commitNewHistory(e,t){const r=this.getHistory(),n=h(h({},r[e]),t),i=r[e]&&r[e].eth_accounts,s=t.eth_accounts;if(i&&s){const e=s.lastApproved||i.lastApproved;n.eth_accounts={lastApproved:e,accounts:h(h({},i.accounts),s.accounts)}}r[e]=n,this.updateHistory(r)}getRequestedMethods(e){return e.params&&e.params[0]&&"object"==typeof e.params[0]&&!Array.isArray(e.params[0])?Object.keys(e.params[0]):null}getAccountsFromPermission(e){if("eth_accounts"!==e.parentCapability||!e.caveats)return[];const t=new Set;for(const r of e.caveats)if(r.type===a.CaveatTypes.restrictReturnedAccounts&&Array.isArray(r.value))for(const e of r.value)t.add(e);return[...t]}}}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/permissions/permission-log.js"}],[260,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={rfc4648:e=>t=>({encode:r=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(r,t,e),decode:r=>((e,t,r)=>{const n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const s=new Uint8Array(i*r/8|0);let o=0,a=0,u=0;for(let t=0;t<i;++t){const i=n[e[t]];if(i===undefined)throw new SyntaxError("Invalid character "+e[t]);a=a<<r|i,o+=r,o>=8&&(o-=8,s[u++]=255&a>>o)}if(o>=r||255&a<<8-o)throw new SyntaxError("Unexpected end of data");return s})(r,t,e)})}}}},{package:"multibase",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/uint8arrays/node_modules/multibase/src/rfc4648.js"}],[261,{"web-encoding":6035},function(){with(this)return function(){"use strict";return function(e,t,r){const{TextEncoder:n,TextDecoder:i}=e("web-encoding"),s=new i,o=new n;t.exports={decodeText:e=>s.decode(e),encodeText:e=>o.encode(e),concat:function(e,t){const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}}},{package:"multibase",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/uint8arrays/node_modules/multibase/src/util.js"}],[262,{"multibase/src/constants":259,"web-encoding":6035},function(){with(this)return function(){"use strict";return function(e,t,r){const{names:n}=e("multibase/src/constants"),{TextDecoder:i}=e("web-encoding"),s=new i("utf8");t.exports=function(e,t="utf8"){if("utf8"===t||"utf-8"===t)return s.decode(e);if("ascii"===t)return function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e);const r=n[t];if(!r)throw new Error("Unknown base");return r.encode(e)}}}},{package:"uint8arrays",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/node_modules/uint8arrays/to-string.js"}],[263,{cids:237},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("cids");r.cidForWeb=e=>{let t=new n(e);0===t.version&&(t=t.toV1());let r=t.toString("base32");if(r.length>63){const e=t.toString("base36");if(e.length<=63)return e;throw new TypeError("CID is longer than DNS limit of 63 characters and is not compatible with public gateways")}return r};r.cidV0ToV1Base32=e=>{let t=new n(e);return 0===t.version&&(t=t.toV1()),t.toString("base32")}}}},{package:"@ensdomains/content-hash",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/src/helpers.js"}],[264,{"./helpers":263,"./profiles":265,multicodec:249,multihashes:255},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multicodec"),i=e("multihashes"),{hexStringToBuffer:s,profiles:o}=e("./profiles"),{cidForWeb:a,cidV0ToV1Base32:u}=e("./helpers");t.exports={helpers:{cidForWeb:a,cidV0ToV1Base32:u},decode:function(e){const t=s(e),r=n.getCodec(t),i=n.rmPrefix(t);let a=o[r];return a||(a=o.default),a.decode(i)},fromIpfs:function(e){return this.encode("ipfs-ns",e)},fromSkylink:function(e){return this.encode("skynet-ns",e)},fromSwarm:function(e){return this.encode("swarm-ns",e)},encode:function(e,t){let r=o[e];r||(r=o.default);const s=r.encode(t);return i.toHexString(n.addPrefix(e,s))},getCodec:function(e){let t=s(e);return n.getCodec(t)}}}}},{package:"@ensdomains/content-hash",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/src/index.js"}],[265,{buffer:2081,cids:237,"js-base64":4717,multihashes:255},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("cids"),i=e("multihashes"),s=e("js-base64"),o=e=>{let t=e.slice(0,2),r=e.slice(2),n="";return n="0x"===t?r:e,i.fromHexString(n)},a=e=>{try{const{multihash:t}=e;if(t.length<38){const e=i.decode(t);if("identity"===e.name&&e.length<36)return!1}return!0}catch(e){return!1}return!1},u={skynet:e=>s.toUint8Array(e),swarm:e=>{const t=i.encode(o(e),"keccak-256");return new n(1,"swarm-manifest",t).bytes},ipfs:e=>new n(e).toV1().bytes,ipns:e=>{const t=new n(e);if(!a(t))throw Error("ipns-ns allows only valid cryptographic libp2p-key identifiers, try using ED25519 pubkey instead");return new n(1,"libp2p-key",t.multihash).bytes},utf8:e=>t.from(e,"utf8")},c={hexMultiHash:e=>{const t=new n(e);return i.decode(t.multihash).digest.toString("hex")},ipfs:e=>{const t=new n(e).toV1();return t.toString("libp2p-key"===t.codec?"base36":"base32")},ipns:e=>{const t=new n(e).toV1();return a(t)?t.toString("base36"):(console.warn("[ensdomains/content-hash] use of non-cryptographic identifiers in ipns-ns is deprecated and will be removed, migrate to ED25519 libp2p-key"),String(i.decode(new n(e).multihash).digest))},utf8:e=>e.toString("utf8"),base64:e=>s.fromUint8Array(e,!0)},h={"skynet-ns":{encode:u.skynet,decode:c.base64},"swarm-ns":{encode:u.swarm,decode:c.hexMultiHash},"ipfs-ns":{encode:u.ipfs,decode:c.ipfs},"ipns-ns":{encode:u.ipns,decode:c.ipns},default:{encode:u.utf8,decode:c.utf8}};r.hexStringToBuffer=o,r.profiles=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ensdomains/content-hash",file:"/home/gudahtt/projects/metamask-extension/node_modules/@ensdomains/content-hash/src/profiles.js"}],[27,{"../../../../shared/constants/permissions":6190,reselect:5729},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getPermittedAccountsByOrigin=r.getChangedAccounts=void 0;var n=e("reselect"),i=e("../../../../shared/constants/permissions");const s=(0,n.createSelector)((e=>e.subjects),(e=>Object.values(e).reduce(((e,t)=>{var r,n;const s=null===(r=t.permissions)||void 0===r||null===(n=r.eth_accounts)||void 0===n?void 0:n.caveats.find((({type:e})=>e===i.CaveatTypes.restrictReturnedAccounts));return s&&e.set(t.origin,s.value),e}),new Map)));r.getPermittedAccountsByOrigin=s;r.getChangedAccounts=(e,t)=>{if(t===undefined)return e;const r=new Map;if(e===t)return r;const n=new Set([...e.keys()]);for(const s of t.keys()){var i;const o=null!==(i=e.get(s))&&void 0!==i?i:[];t.get(s)!==o&&r.set(s,o),n.delete(s)}for(const t of n.keys())r.set(t,e.get(t));return r}}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/permissions/selectors.js"}],[28,{"../../../../shared/constants/permissions":6190,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/controllers":1042},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.unrestrictedMethods=r.getPermissionSpecifications=r.getCaveatSpecifications=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("@metamask/controllers"),o=e("../../../../shared/constants/permissions");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const c=Object.freeze(u({},o.RestrictedMethods)),h=Object.freeze({[o.CaveatTypes.restrictReturnedAccounts]:e=>({type:o.CaveatTypes.restrictReturnedAccounts,value:e})});r.getCaveatSpecifications=({getIdentities:e})=>({[o.CaveatTypes.restrictReturnedAccounts]:{type:o.CaveatTypes.restrictReturnedAccounts,decorator:(e,t)=>async r=>(await e(r)).filter((e=>t.value.includes(e))).slice(0,1),validator:(t,r,n)=>function(e,t){if(!Array.isArray(e)||0===e.length)throw new Error(`${c.eth_accounts} error: Expected non-empty array of Ethereum addresses.`);const r=t();e.forEach((e=>{if(!e||"string"!=typeof e)throw new Error(`${c.eth_accounts} error: Expected an array of Ethereum addresses. Received: "${e}".`);if(!r[e])throw new Error(`${c.eth_accounts} error: Received unrecognized address: "${e}".`)}))}(t.value,e)}});r.getPermissionSpecifications=({getAllAccounts:e,getIdentities:t,captureKeyringTypesWithMissingIdentities:r})=>({[c.eth_accounts]:{permissionType:s.PermissionType.RestrictedMethod,targetKey:c.eth_accounts,allowedCaveats:[o.CaveatTypes.restrictReturnedAccounts],factory:(e,t)=>{if(Array.isArray(e.caveats))throw new Error(`${c.eth_accounts} error: Received unexpected caveats. Any permitted caveats will be added automatically.`);if(!t.approvedAccounts)throw new Error(`${c.eth_accounts} error: No approved accounts specified.`);return(0,s.constructPermission)(u(u({},e),{},{caveats:[h[o.CaveatTypes.restrictReturnedAccounts](t.approvedAccounts)]}))},methodImplementation:async n=>{const i=await e(),s=t();return i.sort(((e,t)=>{if(!s[e])throw r(s,i),new Error(`Missing identity for address: "${e}".`);if(!s[t])throw r(s,i),new Error(`Missing identity for address: "${t}".`);return s[e].lastSelected===s[t].lastSelected?0:s[e].lastSelected===undefined?1:s[t].lastSelected===undefined?-1:s[t].lastSelected-s[e].lastSelected}))},validator:(e,t,r)=>{const{caveats:n}=e;if(!n||1!==n.length||n[0].type!==o.CaveatTypes.restrictReturnedAccounts)throw new Error(`${c.eth_accounts} error: Invalid caveats. There must be a single caveat of type "${o.CaveatTypes.restrictReturnedAccounts}".`)}}});const l=Object.freeze(["eth_blockNumber","eth_call","eth_chainId","eth_coinbase","eth_decrypt","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getEncryptionPublicKey","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleByBlockHashAndIndex","eth_getUncleByBlockNumberAndIndex","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_getWork","eth_hashrate","eth_mining","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_protocolVersion","eth_sendRawTransaction","eth_sendTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","eth_submitHashrate","eth_submitWork","eth_syncing","eth_uninstallFilter","metamask_getProviderState","metamask_watchAsset","net_listening","net_peerCount","net_version","personal_ecRecover","personal_sign","wallet_watchAsset","web3_clientVersion","web3_sha3"]);r.unrestrictedMethods=l}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/permissions/specifications.js"}],[29,{"../../../shared/constants/hardware-wallets":6186,"../../../shared/constants/network":6189,"../../../shared/modules/network.utils":6200,"./network":17,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/obs-store":1193,assert:1700,"eth-sig-util":2457,ethers:2545,loglevel:5182},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("assert"),o=e("@metamask/obs-store"),a=e("eth-sig-util"),u=e("ethers"),c=n(e("loglevel")),h=e("../../../shared/constants/network"),l=e("../../../shared/modules/network.utils"),f=e("../../../shared/constants/hardware-wallets"),d=e("./network");function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r.default=class{constructor(e={}){const t=m({frequentRpcListDetail:[],useBlockie:!1,useNonceField:!1,usePhishDetect:!0,dismissSeedBackUpReminder:!1,useTokenDetection:!1,useCollectibleDetection:!1,openSeaEnabled:!1,advancedGasFee:null,featureFlags:{showIncomingTransactions:!0},knownMethodData:{},currentLocale:e.initLangCode,identities:{},lostIdentities:{},forgottenPassword:!1,preferences:{autoLockTimeLimit:undefined,showFiatInTestnets:!1,showTestNetworks:!1,useNativeCurrencyAsPrimaryCurrency:!0,hideZeroBalanceTokens:!1},ipfsGateway:h.IPFS_DEFAULT_GATEWAY_URL,infuraBlocked:null,ledgerTransportType:window.navigator.hid?f.LEDGER_TRANSPORT_TYPES.WEBHID:f.LEDGER_TRANSPORT_TYPES.U2F,theme:"default"},e.initState);this.network=e.network,this.ethersProvider=new u.ethers.providers.Web3Provider(e.provider),this.store=new o.ObservableStore(t),this.store.setMaxListeners(12),this.openPopup=e.openPopup,this.migrateAddressBookState=e.migrateAddressBookState,this._subscribeToInfuraAvailability(),global.setPreference=(e,t)=>this.setFeatureFlag(e,t)}setPasswordForgotten(e){this.store.updateState({forgottenPassword:e})}setUseBlockie(e){this.store.updateState({useBlockie:e})}setUseNonceField(e){this.store.updateState({useNonceField:e})}setUsePhishDetect(e){this.store.updateState({usePhishDetect:e})}setUseTokenDetection(e){this.store.updateState({useTokenDetection:e})}setUseCollectibleDetection(e){this.store.updateState({useCollectibleDetection:e})}setOpenSeaEnabled(e){this.store.updateState({openSeaEnabled:e})}setAdvancedGasFee(e){this.store.updateState({advancedGasFee:e})}setEIP1559V2Enabled(e){this.store.updateState({eip1559V2Enabled:e})}setTheme(e){this.store.updateState({theme:e})}addKnownMethodData(e,t){const{knownMethodData:r}=this.store.getState();r[e]=t,this.store.updateState({knownMethodData:r})}setCurrentLocale(e){const t=["ar","dv","fa","he","ku"].includes(e)?"rtl":"auto";return this.store.updateState({currentLocale:e,textDirection:t}),t}setAddresses(e){const t=this.store.getState().identities,r=e.reduce(((e,r,n)=>{const i=t[r]||{};return e[r]=m({name:`Account ${n+1}`,address:r},i),e}),{});this.store.updateState({identities:r})}removeAddress(e){const{identities:t}=this.store.getState();if(!t[e])throw new Error(`${e} can't be deleted cause it was not found`);if(delete t[e],this.store.updateState({identities:t}),e===this.getSelectedAddress()){const e=Object.keys(t)[0];this.setSelectedAddress(e)}return e}addAddresses(e){const{identities:t}=this.store.getState();e.forEach((e=>{if(t[e])return;const r=Object.keys(t).length;t[e]={name:`Account ${r+1}`,address:e}})),this.store.updateState({identities:t})}syncAddresses(e){if(!Array.isArray(e)||0===e.length)throw new Error("Expected non-empty array of addresses. Error #11201");const{identities:t,lostIdentities:r}=this.store.getState(),n={};Object.keys(t).forEach((r=>{e.includes(r)||(n[r]=t[r],delete t[r])})),Object.keys(n).length>0&&Object.keys(n).forEach((e=>{r[e]=n[e]})),this.store.updateState({identities:t,lostIdentities:r}),this.addAddresses(e);let i=this.getSelectedAddress();return e.includes(i)||(i=e[0],this.setSelectedAddress(i)),i}setSelectedAddress(e){const t=(0,a.normalize)(e),{identities:r}=this.store.getState(),n=r[t];if(!n)throw new Error(`Identity for '${t} not found`);n.lastSelected=Date.now(),this.store.updateState({identities:r,selectedAddress:t})}getSelectedAddress(){return this.store.getState().selectedAddress}setAccountLabel(e,t){if(!e)throw new Error(`setAccountLabel requires a valid address, got ${String(e)}`);const r=(0,a.normalize)(e),{identities:n}=this.store.getState();return n[r]=n[r]||{},n[r].name=t,this.store.updateState({identities:n}),Promise.resolve(t)}async updateRpc(e){const t=this.getFrequentRpcListDetail(),r=t.findIndex((t=>t.rpcUrl===e.rpcUrl));if(r>-1){const n=t[r],i=m(m({},n),e);if(n.chainId!==i.chainId){let r=n.chainId;if(!r)try{r=await this.ethersProvider.send("net_version"),(0,s.strict)("string"==typeof r)}catch(e){c.default.debug(e),c.default.warn(`Failed to get networkId from ${n.rpcUrl}; skipping address book migration`)}let o=!1;const a=Object.values(h.NETWORK_TYPE_TO_ID_MAP).map((e=>e.networkId)),u=t.filter((t=>t.rpcUrl!==e.rpcUrl));(a.includes(r)||u.some((e=>e.chainId===r)))&&(o=!0),this.migrateAddressBookState(r,i.chainId,o)}t[r]=i,this.store.updateState({frequentRpcListDetail:t})}else{const{rpcUrl:t,chainId:r,ticker:n,nickname:i,rpcPrefs:s={}}=e;this.addToFrequentRpcList(t,r,n,i,s)}}addToFrequentRpcList(e,t,r="ETH",n="",i={}){const s=this.getFrequentRpcListDetail(),o=s.findIndex((t=>t.rpcUrl===e));if(-1!==o&&s.splice(o,1),!(0,l.isPrefixedFormattedHexString)(t))throw new Error(`Invalid chainId: "${t}"`);s.push({rpcUrl:e,chainId:t,ticker:r,nickname:n,rpcPrefs:i}),this.store.updateState({frequentRpcListDetail:s})}removeFromFrequentRpcList(e){const t=this.getFrequentRpcListDetail(),r=t.findIndex((t=>t.rpcUrl===e));return-1!==r&&t.splice(r,1),this.store.updateState({frequentRpcListDetail:t}),Promise.resolve(t)}getFrequentRpcListDetail(){return this.store.getState().frequentRpcListDetail}setFeatureFlag(e,t){const r=m(m({},this.store.getState().featureFlags),{},{[e]:t});return this.store.updateState({featureFlags:r}),Promise.resolve(r)}setPreference(e,t){const r=m(m({},this.getPreferences()),{},{[e]:t});return this.store.updateState({preferences:r}),Promise.resolve(r)}getPreferences(){return this.store.getState().preferences}getIpfsGateway(){return this.store.getState().ipfsGateway}setIpfsGateway(e){return this.store.updateState({ipfsGateway:e}),Promise.resolve(e)}setLedgerTransportPreference(e){return this.store.updateState({ledgerTransportType:e}),e}getLedgerTransportPreference(){return this.store.getState().ledgerTransportType}async setDismissSeedBackUpReminder(e){await this.store.updateState({dismissSeedBackUpReminder:e})}_subscribeToInfuraAvailability(){this.network.on(d.NETWORK_EVENTS.INFURA_IS_BLOCKED,(()=>{this._setInfuraBlocked(!0)})),this.network.on(d.NETWORK_EVENTS.INFURA_IS_UNBLOCKED,(()=>{this._setInfuraBlocked(!1)}))}_setInfuraBlocked(e){const{infuraBlocked:t}=this.store.getState();t!==e&&this.store.updateState({infuraBlocked:e})}}}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/preferences.js"}],[30,{"../../../shared/constants/gas":6185,"../../../shared/constants/swaps":6191,"../../../shared/constants/time":6192,"../../../shared/modules/conversion.utils":6196,"../../../shared/modules/string-utils":6203,"../../../shared/modules/swaps.utils":6204,"../../../ui/helpers/utils/fetch-with-cache":6731,"../../../ui/helpers/utils/token-util":6745,"../../../ui/pages/send/send.utils":6984,"../../../ui/pages/swaps/swaps.util":7093,"./network":17,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/obs-store":1193,"bignumber.js":1960,ethers:2545,"human-standard-token-abi":4385,lodash:5172,loglevel:5182},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("ethers"),o=n(e("loglevel")),a=n(e("bignumber.js")),u=e("@metamask/obs-store"),c=e("lodash"),h=n(e("human-standard-token-abi")),l=e("../../../ui/helpers/utils/token-util"),f=e("../../../ui/pages/send/send.utils"),d=e("../../../shared/modules/conversion.utils"),p=e("../../../shared/constants/swaps"),m=e("../../../shared/constants/gas"),g=e("../../../shared/modules/swaps.utils"),y=e("../../../ui/pages/swaps/swaps.util"),v=n(e("../../../ui/helpers/utils/fetch-with-cache")),w=e("../../../shared/constants/time"),b=e("../../../shared/modules/string-utils"),_=e("./network");function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const A=25e5,T=w.MINUTE,S=10*w.SECOND;function x(e=25e5,t=0,r=0){const n=new a.default(e,10).minus(t,10);return!n.lt(0)&&n.lt(r,16)?`0x${n.toString(16)}`:r}const P={swapsState:{quotes:{},quotesPollingLimitEnabled:!1,fetchParams:null,tokens:null,tradeTxId:null,approveTxId:null,quotesLastFetched:null,customMaxGas:"",customGasPrice:null,customMaxFeePerGas:null,customMaxPriorityFeePerGas:null,swapsUserFeeLevel:"",selectedAggId:null,customApproveTxData:"",errorKey:"",topAggId:null,routeState:"",swapsFeatureIsLive:!0,saveFetchedQuotes:!1,swapsQuoteRefreshTime:T,swapsQuotePrefetchingRefreshTime:T,swapsStxBatchStatusRefreshTime:S,swapsStxGetTransactionsRefreshTime:S,swapsFeatureFlags:{}}};function I(e){if(!Array.isArray(e)||0===e.length)throw new Error("Expected non-empty array param.");const t=[...e];if(t.sort(((e,t)=>{const r=new a.default(e.overallValueOfQuote,10),n=new a.default(t.overallValueOfQuote,10);return r.equals(n)?0:r.lessThan(n)?-1:1})),t.length%2==1){const e=t[(t.length-1)/2].overallValueOfQuote;return M(t.filter((t=>e===t.overallValueOfQuote)))}const r=t.length/2,n=r-1,i=t[r].overallValueOfQuote,s=t[n].overallValueOfQuote,o=t.filter((e=>i===e.overallValueOfQuote)),u=t.filter((e=>s===e.overallValueOfQuote)),c=M(o),h=M(u);return{ethFee:new a.default(c.ethFee,10).plus(h.ethFee,10).dividedBy(2).toString(10),metaMaskFeeInEth:new a.default(c.metaMaskFeeInEth,10).plus(h.metaMaskFeeInEth,10).dividedBy(2).toString(10),ethValueOfTokens:new a.default(c.ethValueOfTokens,10).plus(h.ethValueOfTokens,10).dividedBy(2).toString(10)}}function M(e){const t=e.reduce(((e,t)=>({ethFee:e.ethFee.plus(t.ethFee,10),metaMaskFeeInEth:e.metaMaskFeeInEth.plus(t.metaMaskFeeInEth,10),ethValueOfTokens:e.ethValueOfTokens.plus(t.ethValueOfTokens,10)})),{ethFee:new a.default(0,10),metaMaskFeeInEth:new a.default(0,10),ethValueOfTokens:new a.default(0,10)});return{ethFee:t.ethFee.div(e.length,10).toString(10),metaMaskFeeInEth:t.metaMaskFeeInEth.div(e.length,10).toString(10),ethValueOfTokens:t.ethValueOfTokens.div(e.length,10).toString(10)}}r.default=class{constructor({getBufferedGasLimit:e,networkController:t,provider:r,getProviderConfig:n,getTokenRatesState:i,fetchTradesInfo:o=y.fetchTradesInfo,getCurrentChainId:a,getEIP1559GasFeeEstimates:c}){this.store=new u.ObservableStore({swapsState:k({},P.swapsState)}),this._fetchTradesInfo=o,this._getCurrentChainId=a,this._getEIP1559GasFeeEstimates=c,this.getBufferedGasLimit=e,this.getTokenRatesState=i,this.pollCount=0,this.getProviderConfig=n,this.indexOfNewestCallInFlight=0,this.ethersProvider=new s.ethers.providers.Web3Provider(r),this._currentNetwork=t.store.getState().network,t.on(_.NETWORK_EVENTS.NETWORK_DID_CHANGE,(e=>{"loading"!==e&&e!==this._currentNetwork&&(this._currentNetwork=e,this.ethersProvider=new s.ethers.providers.Web3Provider(r))}))}async fetchSwapsRefreshRates(e){const t=await(0,v.default)((0,y.getBaseApi)("network",e),{method:"GET"},{cacheRefreshTime:6e5}),{refreshRates:r}=t||{};if(!r||"number"!=typeof r.quotes||"number"!=typeof r.quotesPrefetching)throw new Error(`MetaMask - invalid response for refreshRates: ${t}`);return{quotes:1e3*r.quotes,quotesPrefetching:1e3*r.quotesPrefetching,stxGetTransactions:1e3*r.stxGetTransactions,stxBatchStatus:1e3*r.stxBatchStatus,stxStatusDeadline:r.stxStatusDeadline}}async _setSwapsRefreshRates(){var e,t,r,n,i;const s=this._getCurrentChainId();let o;try{o=await this.fetchSwapsRefreshRates(s)}catch(e){console.error("Request for swaps quote refresh time failed: ",e)}const{swapsState:a}=this.store.getState();this.store.updateState({swapsState:k(k({},a),{},{swapsQuoteRefreshTime:(null===(e=o)||void 0===e?void 0:e.quotes)||T,swapsQuotePrefetchingRefreshTime:(null===(t=o)||void 0===t?void 0:t.quotesPrefetching)||T,swapsStxGetTransactionsRefreshTime:(null===(r=o)||void 0===r?void 0:r.stxGetTransactions)||S,swapsStxBatchStatusRefreshTime:(null===(n=o)||void 0===n?void 0:n.stxBatchStatus)||S,swapsStxStatusDeadline:(null===(i=o)||void 0===i?void 0:i.stxStatusDeadline)||180})})}pollForNewQuotes(){const{swapsState:{swapsQuoteRefreshTime:e,swapsQuotePrefetchingRefreshTime:t,quotesPollingLimitEnabled:r}}=this.store.getState(),n=r?e:t;this.pollingTimeout=setTimeout((()=>{var e;const{swapsState:t}=this.store.getState();this.fetchAndSetQuotes(t.fetchParams,null===(e=t.fetchParams)||void 0===e?void 0:e.metaData,!0)}),n)}stopPollingForQuotes(){this.pollingTimeout&&clearTimeout(this.pollingTimeout)}async fetchAndSetQuotes(e,t={},r){const{chainId:n}=t,{swapsState:{quotesPollingLimitEnabled:i,saveFetchedQuotes:s}}=this.store.getState();if(!e)return null;r||(this.pollCount=0),clearTimeout(this.pollingTimeout),r||this.setSwapsErrorKey("");const o=this.indexOfNewestCallInFlight+1;this.indexOfNewestCallInFlight=o,s||this.setSaveFetchedQuotes(!0);let[a]=await Promise.all([this._fetchTradesInfo(e,k({},t)),this._setSwapsRefreshRates()]);const{swapsState:{saveFetchedQuotes:u}}=this.store.getState();if(!u)return[{},null];a=(0,c.mapValues)(a,(e=>k(k({},e),{},{sourceTokenInfo:t.sourceTokenInfo,destinationTokenInfo:t.destinationTokenInfo})));const h=Date.now();let l=!1;if(!(0,g.isSwapsDefaultTokenAddress)(e.sourceToken,n)&&Object.values(a).length){const t=await this._getERC20Allowance(e.sourceToken,e.fromAddress,n),[i]=Object.values(a);if(l=i.approvalNeeded&&t.eq(0)&&"wrappedNative"!==i.aggregator,l){if(!r){const{gasLimit:e}=await this.timedoutGasReturn(i.approvalNeeded);a=(0,c.mapValues)(a,(t=>k(k({},t),{},{approvalNeeded:k(k({},t.approvalNeeded),{},{gas:e||p.DEFAULT_ERC20_APPROVE_GAS})})))}}else a=(0,c.mapValues)(a,(e=>k(k({},e),{},{approvalNeeded:null})))}let f=null;if(l||null!=e&&e.balanceError||(a=await this.getAllQuotesWithGasEstimates(a)),0===Object.values(a).length)this.setSwapsErrorKey(p.QUOTES_NOT_AVAILABLE_ERROR);else{const[e,t]=await this._findTopQuoteAndCalculateSavings(a);f=e,a=t}if(this.indexOfNewestCallInFlight!==o)throw new Error(p.SWAPS_FETCH_ORDER_CONFLICT);const{swapsState:d}=this.store.getState();let{selectedAggId:m}=d;return a[m]||(m=null),this.store.updateState({swapsState:k(k({},d),{},{quotes:a,fetchParams:k(k({},e),{},{metaData:t}),quotesLastFetched:h,selectedAggId:m,topAggId:f})}),i&&(this.pollCount+=1),!i||this.pollCount<4?(this.pollForNewQuotes(),[a,f]):(this.resetPostFetchState(),this.setSwapsErrorKey(p.QUOTES_EXPIRED_ERROR),null)}safeRefetchQuotes(){const{swapsState:e}=this.store.getState();!this.pollingTimeout&&e.fetchParams&&this.fetchAndSetQuotes(e.fetchParams)}setSelectedQuoteAggId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{selectedAggId:e})})}setSwapsTokens(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{tokens:e})})}clearSwapsQuotes(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:k(k({},e),{},{quotes:{}})})}setSwapsErrorKey(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{errorKey:e})})}async getAllQuotesWithGasEstimates(e){const t=await Promise.all(Object.values(e).map((async e=>{const{gasLimit:t,simulationFails:r}=await this.timedoutGasReturn(e.trade);return[t,r,e.aggregator]}))),r={};return t.forEach((([t,n,i])=>{if(t&&!n){const n=x(e[i].maxGas,e[i].estimatedRefund,t);r[i]=k(k({},e[i]),{},{gasEstimate:t,gasEstimateWithRefund:n})}else e[i].approvalNeeded&&(r[i]=e[i])})),r}timedoutGasReturn(e){return new Promise((t=>{let r=!1;const n=setTimeout((()=>{r=!0,t({gasLimit:null,simulationFails:!0})}),5*w.SECOND),i={data:e.data,from:e.from,to:e.to,value:e.value};this.getBufferedGasLimit({txParams:i},1).then((({gasLimit:e,simulationFails:i})=>{r||(clearTimeout(n),t({gasLimit:e,simulationFails:i}))})).catch((e=>{o.default.error(e),r||(clearTimeout(n),t({gasLimit:null,simulationFails:!0}))}))}))}async setInitialGasEstimate(e){const{swapsState:t}=this.store.getState(),r=k({},t.quotes[e]),{gasLimit:n,simulationFails:i}=await this.timedoutGasReturn(r.trade);if(n&&!i){const e=x(r.maxGas,r.estimatedRefund,n);r.gasEstimate=n,r.gasEstimateWithRefund=e}this.store.updateState({swapsState:k(k({},t),{},{quotes:k(k({},t.quotes),{},{[e]:r})})})}setApproveTxId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{approveTxId:e})})}setTradeTxId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{tradeTxId:e})})}setQuotesLastFetched(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{quotesLastFetched:e})})}setSwapsTxGasPrice(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{customGasPrice:e})})}setSwapsTxMaxFeePerGas(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{customMaxFeePerGas:e})})}setSwapsUserFeeLevel(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{swapsUserFeeLevel:e})})}setSwapsQuotesPollingLimitEnabled(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{quotesPollingLimitEnabled:e})})}setSwapsTxMaxFeePriorityPerGas(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{customMaxPriorityFeePerGas:e})})}setSwapsTxGasLimit(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{customMaxGas:e})})}setCustomApproveTxData(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{customApproveTxData:e})})}setBackgroundSwapRouteState(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{routeState:e})})}setSaveFetchedQuotes(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{saveFetchedQuotes:e})})}setSwapsLiveness(e){const{swapsState:t}=this.store.getState(),{swapsFeatureIsLive:r}=e;this.store.updateState({swapsState:k(k({},t),{},{swapsFeatureIsLive:r})})}setSwapsFeatureFlags(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{swapsFeatureFlags:e})})}resetPostFetchState(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:k(k({},P.swapsState),{},{tokens:e.tokens,fetchParams:e.fetchParams,swapsFeatureIsLive:e.swapsFeatureIsLive,swapsQuoteRefreshTime:e.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsQuotePrefetchingRefreshTime,swapsFeatureFlags:e.swapsFeatureFlags})}),clearTimeout(this.pollingTimeout)}resetSwapsState(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:k(k({},P.swapsState),{},{swapsQuoteRefreshTime:e.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsQuotePrefetchingRefreshTime})}),clearTimeout(this.pollingTimeout)}async _findTopQuoteAndCalculateSavings(e={}){const{contractExchangeRates:t}=this.getTokenRatesState(),{swapsState:{customGasPrice:r,customMaxPriorityFeePerGas:n}}=this.store.getState(),i=this._getCurrentChainId();if(!Object.keys(e).length)return{};const s=(0,c.cloneDeep)(e),{gasFeeEstimates:o,gasEstimateType:u}=await this._getEIP1559GasFeeEstimates();let h="0x0";if(u===m.GAS_ESTIMATE_TYPES.FEE_MARKET){const{high:{suggestedMaxPriorityFeePerGas:e},estimatedBaseFee:t}=o;h=(0,d.addCurrencies)(n||(0,d.decGWEIToHexWEI)(e),(0,d.decGWEIToHexWEI)(t),{aBase:16,bBase:16,toNumericBase:"hex",numberOfDecimals:6})}else u===m.GAS_ESTIMATE_TYPES.LEGACY?h=r||(0,d.decGWEIToHexWEI)(o.high):u===m.GAS_ESTIMATE_TYPES.ETH_GASPRICE&&(h=r||(0,d.decGWEIToHexWEI)(o.gasPrice));let p=null,y=null;Object.values(s).forEach((e=>{const{aggregator:r,approvalNeeded:n,averageGas:s,destinationAmount:o=0,destinationToken:u,destinationTokenInfo:c,gasEstimate:m,sourceAmount:v,sourceToken:w,trade:_,fee:E}=e,k=(m?new a.default(m,16):new a.default(s||A,10)).plus((null==n?void 0:n.gas)||"0x0",16).toString(16),T=(0,f.calcGasTotal)(k,h),S=new a.default(T,16).plus(_.value,16),x=(0,d.conversionUtil)(S,{fromCurrency:"ETH",fromDenomination:"WEI",toDenomination:"ETH",fromNumericBase:"BN",numberOfDecimals:6}),P=(0,g.isSwapsDefaultTokenAddress)(w,i)?(0,d.conversionUtil)(S.minus(v,10),{fromCurrency:"ETH",fromDenomination:"WEI",toDenomination:"ETH",fromNumericBase:"BN",numberOfDecimals:6}):x,I=(0,l.calcTokenAmount)(o,c.decimals),M=new a.default(100,10).minus(E,10).div(100),C=I.div(M).minus(I),L=t[Object.keys(t).find((e=>(0,b.isEqualCaseInsensitive)(e,u)))],N=L||1,B=I.times(N.toString(10),10),R=(0,g.isSwapsDefaultTokenAddress)(u,i)?1:L,O=R===undefined?B:B.minus(P,10);e.ethFee=P.toString(10),R!==undefined&&(e.ethValueOfTokens=B.toString(10),e.overallValueOfQuote=O.toString(10),e.metaMaskFeeInEth=C.times(R.toString(10)).toString(10)),(null===y||O.gt(y))&&(p=r,y=O)}));let v=null;if((0,g.isSwapsDefaultTokenAddress)(s[p].destinationToken,i)||Boolean(t[Object.keys(t).find((e=>{var t;return(0,b.isEqualCaseInsensitive)(e,null===(t=s[p])||void 0===t?void 0:t.destinationToken)}))])){const e=s[p];v={};const{ethFee:t,metaMaskFeeInEth:r,ethValueOfTokens:n}=I(Object.values(s));v.performance=new a.default(e.ethValueOfTokens,10).minus(n,10),v.fee=new a.default(t).minus(e.ethFee,10),v.metaMaskFee=e.metaMaskFeeInEth,v.total=v.performance.plus(v.fee).minus(v.metaMaskFee).toString(10),v.performance=v.performance.toString(10),v.fee=v.fee.toString(10),v.medianMetaMaskFee=r,s[p].isBestQuote=!0,s[p].savings=v}return[p,s]}async _getERC20Allowance(e,t,r){const n=new s.ethers.Contract(e,h.default,this.ethersProvider);return await n.allowance(t,p.SWAPS_CHAINID_CONTRACT_ADDRESS_MAP[r])}};const C={getMedianEthValueQuote:I,meansOfQuotesFeesAndValue:M};r.utils=C}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/swaps.js"}],[31,{"../../../development/mock-3box":156,"../lib/createOriginMiddleware":46,"../lib/migrator":61,"../migrations":152,"./network/createMetamaskMiddleware":16,"3box":162,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/obs-store":1193,_process:5420,"eth-json-rpc-middleware":2406,"json-rpc-engine":4727,loglevel:5182},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("@metamask/obs-store"),o=n(e("loglevel")),a=e("json-rpc-engine"),u=e("eth-json-rpc-middleware"),c=n(e("../lib/migrator")),h=n(e("../migrations")),l=n(e("../lib/createOriginMiddleware")),f=n(e("./network/createMetamaskMiddleware"));function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const m=t.env.IN_TEST?e("../../../development/mock-3box"):e("3box");r.default=class{constructor(e={}){const{preferencesController:t,keyringController:r,addressBookController:n,version:i,getKeyringControllerState:o,trackMetaMetricsEvent:a}=e;this.preferencesController=t,this.addressBookController=n,this.keyringController=r,this.provider=this._createProvider({version:i,getAccounts:async({origin:e})=>{if("3Box"!==e)return[];const{isUnlocked:t}=o(),r=await this.keyringController.getAccounts();if(t&&r[0]){return[await this.keyringController.getAppKeyAddress(r[0],"wallet://3box.metamask.io")]}return[]},processPersonalMessage:async e=>{const t=await this.keyringController.getAccounts();return r.signPersonalMessage(p(p({},e),{},{from:t[0]}),{withAppKeyOrigin:"wallet://3box.metamask.io"})}}),this._trackMetaMetricsEvent=a;const u=p(p({threeBoxSyncingAllowed:!1,showRestorePrompt:!0,threeBoxLastUpdated:0},e.initState),{},{threeBoxAddress:null,threeBoxSynced:!1,threeBoxDisabled:!1});this.store=new s.ObservableStore(u),this.registeringUpdates=!1,this.lastMigration=h.default.sort(((e,t)=>e.version-t.version)).slice(-1)[0],u.threeBoxSyncingAllowed&&this.init()}async init(){const e=await this.keyringController.getAccounts();this.address=e[0],this._trackMetaMetricsEvent({event:"3Box Initiated",category:"3Box"}),!this.address||this.box&&this.store.getState().threeBoxSynced||await this.new3Box()}async _update3Box(){try{const{threeBoxSyncingAllowed:e,threeBoxSynced:t}=this.store.getState();if(e&&t){const e={preferences:this.preferencesController.store.getState(),addressBook:this.addressBookController.state,lastUpdated:Date.now(),lastMigration:this.lastMigration};await this.space.private.set("metamaskBackup",JSON.stringify(e)),await this.setShowRestorePromptToFalse()}}catch(e){console.error(e)}}_createProvider(e){const t=(0,f.default)(e),r=new a.JsonRpcEngine;r.push((0,l.default)({origin:"3Box"})),r.push(t);return(0,u.providerFromEngine)(r)}_waitForOnSyncDone(){return new Promise((e=>{this.box.onSyncDone((()=>(o.default.debug("3Box box sync done"),e())))}))}async new3Box(){const e=await this.keyringController.getAccounts();let t;this.address=await this.keyringController.getAppKeyAddress(e[0],"wallet://3box.metamask.io");try{const e=await m.getConfig(this.address);t=e.spaces&&e.spaces.metamask}catch(e){if(!e.message.match(/^Error: Invalid response \(404\)/u))throw this._trackMetaMetricsEvent({event:"3Box Config Error",category:"3Box"}),e;this._trackMetaMetricsEvent({event:"3Box Backup does not exist",category:"3Box"}),t=!1}if(this.getThreeBoxSyncingState()||t){this.store.updateState({threeBoxSynced:!1});let e=!1;const t=setTimeout((()=>{o.default.error("3Box sync timed out after 60000 ms"),e=!0,this.store.updateState({threeBoxDisabled:!0,threeBoxSyncingAllowed:!1})}),6e4);try{this.box=await m.openBox(this.address,this.provider),await this._waitForOnSyncDone(),this.space=await this.box.openSpace("metamask",{onSyncDone:async()=>{const r={threeBoxSynced:!0,threeBoxAddress:this.address};e&&(o.default.info("3Box sync completed after timeout; no longer disabled"),r.threeBoxDisabled=!1),clearTimeout(t),this.store.updateState(r),o.default.debug("3Box space sync done"),this._trackMetaMetricsEvent({event:"3Box Synced",category:"3Box"})}})}catch(e){throw this._trackMetaMetricsEvent({event:"3Box Initiation Error",category:"3Box"}),console.error(e),e}}}async getLastUpdated(){const e=await this.space.private.get("metamaskBackup");return JSON.parse(e||"{}").lastUpdated}async migrateBackedUpState(e){const t=new c.default({migrations:h.default}),{preferences:r,addressBook:n}=JSON.parse(e),i={PreferencesController:r,AddressBookController:n},s=t.generateInitialState(i),o=await t.migrateData(s);return{preferences:o.data.PreferencesController,addressBook:o.data.AddressBookController}}async restoreFromThreeBox(){const e=await this.space.private.get("metamaskBackup"),{preferences:t,addressBook:r}=await this.migrateBackedUpState(e);this.store.updateState({threeBoxLastUpdated:e.lastUpdated}),t&&this.preferencesController.store.updateState(t),r&&this.addressBookController.update(r,!0),this.setShowRestorePromptToFalse(),this._trackMetaMetricsEvent({event:"3Box Restored Data",category:"3Box"})}turnThreeBoxSyncingOn(){this._trackMetaMetricsEvent({event:"3Box Sync Turned On",category:"3Box"}),this._registerUpdates()}turnThreeBoxSyncingOff(){this._trackMetaMetricsEvent({event:"3Box Sync Turned Off",category:"3Box"}),this.box.logout()}setShowRestorePromptToFalse(){this.store.updateState({showRestorePrompt:!1})}setThreeBoxSyncingPermission(e){this.store.getState().threeBoxDisabled||(this.store.updateState({threeBoxSyncingAllowed:e}),e&&this.box&&this.turnThreeBoxSyncingOn(),!e&&this.box&&this.turnThreeBoxSyncingOff())}getThreeBoxSyncingState(){return this.store.getState().threeBoxSyncingAllowed}_registerUpdates(){if(!this.registeringUpdates){const e=this._update3Box.bind(this);this.preferencesController.store.subscribe(e);const t=this._update3Box.bind(this);this.addressBookController.subscribe(t),this.registeringUpdates=!0}}}}).call(this)}).call(this,e("_process"))}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/threebox.js"}],[32,{"../../../../shared/constants/gas":6185,"../../../../shared/constants/network":6189,"../../../../shared/constants/transaction":6193,"../../../../shared/modules/conversion.utils":6196,"../../../../shared/modules/transaction.utils":6205,"../../../../ui/helpers/constants/error-keys":6712,"../../../../ui/helpers/constants/transactions":6716,"../../../../ui/helpers/utils/conversions.util":6730,"../../../../ui/pages/swaps/swaps.util":7093,"../../lib/cleanErrorStack":42,"../../lib/util":81,"../../metamask-controller":82,"./lib/util":34,"./pending-tx-tracker":35,"./tx-gas-utils":36,"./tx-state-manager":37,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@ethereumjs/common":401,"@ethereumjs/tx":405,"@metamask/obs-store":1193,"bignumber.js":1960,"eth-rpc-errors":2455,"ethereumjs-util":2521,"ethjs-query":2570,lodash:5172,loglevel:5182,"nonce-tracker":5296,"safe-event-emitter":5740},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("safe-event-emitter")),o=e("@metamask/obs-store"),a=e("ethereumjs-util"),u=n(e("ethjs-query")),c=e("eth-rpc-errors"),h=n(e("@ethereumjs/common")),l=e("@ethereumjs/tx"),f=n(e("nonce-tracker")),d=n(e("loglevel")),p=n(e("bignumber.js")),m=e("lodash"),g=n(e("../../lib/cleanErrorStack")),y=e("../../lib/util"),v=e("../../../../ui/helpers/constants/error-keys"),w=e("../../../../ui/pages/swaps/swaps.util"),b=e("../../../../ui/helpers/utils/conversions.util"),_=e("../../../../shared/constants/transaction"),E=e("../../../../ui/helpers/constants/transactions"),k=e("../../metamask-controller"),A=e("../../../../shared/constants/gas"),T=e("../../../../shared/modules/conversion.utils"),S=e("../../../../shared/constants/network"),x=e("../../../../shared/modules/transaction.utils"),P=n(e("./tx-state-manager")),I=n(e("./tx-gas-utils")),M=n(e("./pending-tx-tracker")),C=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=L(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}n.default=e,r&&r.set(e,n);return n}(e("./lib/util"));function L(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(L=function(e){return e?r:t})(e)}function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const R=[_.TRANSACTION_TYPES.SWAP,_.TRANSACTION_TYPES.SWAP_APPROVAL],O="failed on-chain";class j extends s.default{constructor(e){super(),this.networkStore=e.networkStore||new o.ObservableStore({}),this._getCurrentChainId=e.getCurrentChainId,this.getProviderConfig=e.getProviderConfig,this._getCurrentNetworkEIP1559Compatibility=e.getCurrentNetworkEIP1559Compatibility,this._getCurrentAccountEIP1559Compatibility=e.getCurrentAccountEIP1559Compatibility,this.preferencesStore=e.preferencesStore||new o.ObservableStore({}),this.provider=e.provider,this.getPermittedAccounts=e.getPermittedAccounts,this.blockTracker=e.blockTracker,this.signEthTx=e.signTransaction,this.inProcessOfSigning=new Set,this._trackMetaMetricsEvent=e.trackMetaMetricsEvent,this._getParticipateInMetrics=e.getParticipateInMetrics,this._getEIP1559GasFeeEstimates=e.getEIP1559GasFeeEstimates,this.createEventFragment=e.createEventFragment,this.updateEventFragment=e.updateEventFragment,this.finalizeEventFragment=e.finalizeEventFragment,this.getEventFragmentById=e.getEventFragmentById,this.getDeviceModel=e.getDeviceModel,this.getAccountType=e.getAccountType,this.getTokenStandardAndDetails=e.getTokenStandardAndDetails,this.memStore=new o.ObservableStore({}),this.query=new u.default(this.provider),this.txGasUtil=new I.default(this.provider),this._mapMethods(),this.txStateManager=new P.default({initState:e.initState,txHistoryLimit:e.txHistoryLimit,getNetwork:this.getNetwork.bind(this),getCurrentChainId:e.getCurrentChainId}),this._onBootCleanUp(),this.store=this.txStateManager.store,this.nonceTracker=new f.default({provider:this.provider,blockTracker:this.blockTracker,getPendingTransactions:(...t)=>[...this.txStateManager.getPendingTransactions(...t),...e.getExternalPendingTransactions(...t)],getConfirmedTransactions:this.txStateManager.getConfirmedTransactions.bind(this.txStateManager)}),this.pendingTxTracker=new M.default({provider:this.provider,nonceTracker:this.nonceTracker,publishTransaction:e=>this.query.sendRawTransaction(e),getPendingTransactions:()=>[...this.txStateManager.getPendingTransactions(),...this.txStateManager.getApprovedTransactions()],approveTransaction:this.approveTransaction.bind(this),getCompletedTransactions:this.txStateManager.getConfirmedTransactions.bind(this.txStateManager)}),this.txStateManager.store.subscribe((()=>this.emit(k.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE))),this._setupListeners(),this._updateMemstore(),this.txStateManager.store.subscribe((()=>this._updateMemstore())),this.networkStore.subscribe((()=>{this._onBootCleanUp(),this._updateMemstore()})),this._updatePendingTxsAfterFirstBlock()}getChainId(){const e=this.networkStore.getState(),t=this._getCurrentChainId(),r=parseInt(t,16);return"loading"===e||Number.isNaN(r)?0:r}async getEIP1559Compatibility(e){const t=await this._getCurrentNetworkEIP1559Compatibility(),r=await this._getCurrentAccountEIP1559Compatibility(e);return t&&r}async getCommonConfiguration(e){const{type:t,nickname:r}=this.getProviderConfig(),n=await this.getEIP1559Compatibility(e)?S.HARDFORKS.LONDON:S.HARDFORKS.BERLIN;if(t!==S.NETWORK_TYPE_RPC)return new h.default({chain:t,hardfork:n});const i=parseInt(this._getCurrentChainId(),16),s=this.networkStore.getState(),o={name:r,chainId:i,networkId:"loading"===s?0:parseInt(s,10)};return h.default.forCustomChain(S.MAINNET,o,n)}addTransaction(e){this.txStateManager.addTransaction(e),this.emit(`${e.id}:unapproved`,e),this._trackTransactionMetricsEvent(e,_.TRANSACTION_EVENTS.ADDED)}wipeTransactions(e){this.txStateManager.wipeTransactions(e)}async newUnapprovedTransaction(e,t={}){d.default.debug(`MetaMaskController newUnapprovedTransaction ${JSON.stringify(e)}`);const r=await this.addUnapprovedTransaction(e,t.origin);return new Promise(((e,t)=>{this.txStateManager.once(`${r.id}:finished`,(r=>{switch(r.status){case _.TRANSACTION_STATUSES.SUBMITTED:return e(r.hash);case _.TRANSACTION_STATUSES.REJECTED:return t((0,g.default)(c.ethErrors.provider.userRejectedRequest("MetaMask Tx Signature: User denied transaction signature.")));case _.TRANSACTION_STATUSES.FAILED:return t((0,g.default)(c.ethErrors.rpc.internal(r.err.message)));default:return t((0,g.default)(c.ethErrors.rpc.internal(`MetaMask Tx Signature: Unknown problem: ${JSON.stringify(r.txParams)}`)))}}))}))}_getTransaction(e){const{transactions:t}=this.store.getState();return t[e]}_checkIfTxStatusIsUnapproved(e){return this.txStateManager.getTransaction(e).status===_.TRANSACTION_STATUSES.UNAPPROVED}_updateTransaction(e,t,r){const n=this.txStateManager.getTransaction(e),i=(0,m.merge)(n,t);this.txStateManager.updateTransaction(i,r)}updatePreviousGasParams(e,{maxFeePerGas:t,maxPriorityFeePerGas:r,gasLimit:n}){const i={previousGas:{maxFeePerGas:t,maxPriorityFeePerGas:r,gasLimit:n}};i.previousGas=(0,m.pickBy)(i.previousGas);const s=`Update Previous Gas for ${e}`;return this._updateTransaction(e,i,s),this._getTransaction(e)}updateEditableParams(e,{data:t,from:r,to:n,value:i,gas:s,gasPrice:o}){if(!this._checkIfTxStatusIsUnapproved(e))throw new Error("Cannot call updateEditableParams on a transaction that is not in an unapproved state");const a={txParams:{data:t,from:r,to:n,value:i,gas:s,gasPrice:o}};a.txParams=(0,m.pickBy)(a.txParams);const u=`Update Editable Params for ${e}`;return this._updateTransaction(e,a,u),this._getTransaction(e)}updateTransactionGasFees(e,{gas:t,gasLimit:r,gasPrice:n,maxPriorityFeePerGas:i,maxFeePerGas:s,estimateUsed:o,estimateSuggested:a,defaultGasEstimates:u,originalGasEstimate:c,userEditedGasLimit:h,userFeeLevel:l}){if(!this._checkIfTxStatusIsUnapproved(e))throw new Error("Cannot call updateTransactionGasFees on a transaction that is not in an unapproved state");let f={txParams:{gas:t,gasLimit:r,gasPrice:n,maxPriorityFeePerGas:i,maxFeePerGas:s},estimateUsed:o,estimateSuggested:a,defaultGasEstimates:u,originalGasEstimate:c,userEditedGasLimit:h,userFeeLevel:l};f.txParams=(0,m.pickBy)(f.txParams),f=(0,m.pickBy)(f);const d=`Update Transaction Gas Fees for ${e}`;return this._updateTransaction(e,f,d),this._getTransaction(e)}updateTransactionEstimatedBaseFee(e,{estimatedBaseFee:t,decEstimatedBaseFee:r}){if(!this._checkIfTxStatusIsUnapproved(e))throw new Error("Cannot call updateTransactionEstimatedBaseFee on a transaction that is not in an unapproved state");let n={estimatedBaseFee:t,decEstimatedBaseFee:r};n=(0,m.pickBy)(n);const i=`Update Transaction Estimated Base Fees for ${e}`;return this._updateTransaction(e,n,i),this._getTransaction(e)}updateSwapApprovalTransaction(e,{type:t,sourceTokenSymbol:r}){if(!this._checkIfTxStatusIsUnapproved(e))throw new Error("Cannot call updateSwapApprovalTransaction on a transaction that is not in an unapproved state");let n={type:t,sourceTokenSymbol:r};n=(0,m.pickBy)(n);const i=`Update Swap Approval Transaction for ${e}`;return this._updateTransaction(e,n,i),this._getTransaction(e)}updateSwapTransaction(e,{sourceTokenSymbol:t,destinationTokenSymbol:r,type:n,destinationTokenDecimals:i,destinationTokenAddress:s,swapMetaData:o,swapTokenValue:a,estimatedBaseFee:u,approvalTxId:c}){if(!this._checkIfTxStatusIsUnapproved(e))throw new Error("Cannot call updateSwapTransaction on a transaction that is not in an unapproved state");let h={sourceTokenSymbol:t,destinationTokenSymbol:r,type:n,destinationTokenDecimals:i,destinationTokenAddress:s,swapMetaData:o,swapTokenValue:a,estimatedBaseFee:u,approvalTxId:c};h=(0,m.pickBy)(h);const l=`Update Swap Transaction for ${e}`;return this._updateTransaction(e,h,l),this._getTransaction(e)}updateTransactionUserSettings(e,{userEditedGasLimit:t,userFeeLevel:r}){if(!this._checkIfTxStatusIsUnapproved(e))throw new Error("Cannot call updateTransactionUserSettings on a transaction that is not in an unapproved state");let n={userEditedGasLimit:t,userFeeLevel:r};n=(0,m.pickBy)(n);const i=`Update User Settings for ${e}`;return this._updateTransaction(e,n,i),this._getTransaction(e)}async addUnapprovedTransaction(e,t,r){if(r!==undefined&&!R.includes(r))throw new Error(`TransactionController - invalid transactionType value: ${r}`);const n=C.normalizeTxParams(e),i=await this.getEIP1559Compatibility();C.validateTxParams(n,i);let s=this.txStateManager.generateTxMeta({txParams:n,origin:t});if("metamask"===t){if(n.from!==this.getSelectedAddress())throw c.ethErrors.rpc.internal({message:"Internally initiated transaction is using invalid account.",data:{origin:t,fromAddress:n.from,selectedAddress:this.getSelectedAddress()}})}else{if(!(await this.getPermittedAccounts(t)).includes(n.from))throw c.ethErrors.provider.unauthorized({data:{origin:t}})}const{type:o,getCodeResponse:a}=await(0,x.determineTransactionType)(e,this.query);s.type=r||o,s.txParams.value=s.txParams.value?(0,y.addHexPrefix)(s.txParams.value):"0x0",this.addTransaction(s),this.emit("newUnapprovedTx",s);try{s=await this.addTxGasDefaults(s,a)}catch(e){throw d.default.warn(e),s=this.txStateManager.getTransaction(s.id),s.loadingDefaults=!1,this.txStateManager.updateTransaction(s,"Failed to calculate gas defaults."),e}return s.loadingDefaults=!1,this.txStateManager.updateTransaction(s,"Added new unapproved transaction."),s}async addTxGasDefaults(e,t){const r=e.txParams.type!==_.TRANSACTION_ENVELOPE_TYPES.LEGACY&&await this.getEIP1559Compatibility(),{gasPrice:n,maxFeePerGas:i,maxPriorityFeePerGas:s}=await this._getDefaultGasFees(e,r),{gasLimit:o,simulationFails:a}=await this._getDefaultGasLimit(e,t);if(e=this.txStateManager.getTransaction(e.id),a&&(e.simulationFails=a),r){const{eip1559V2Enabled:t}=this.preferencesStore.getState(),r=this.getAdvancedGasFee();t&&Boolean(r)&&!R.includes(e.type)?(e.userFeeLevel=A.CUSTOM_GAS_ESTIMATE,e.txParams.maxFeePerGas=(0,T.decGWEIToHexWEI)(r.maxBaseFee),e.txParams.maxPriorityFeePerGas=(0,T.decGWEIToHexWEI)(r.priorityFee)):!e.txParams.gasPrice||e.txParams.maxFeePerGas||e.txParams.maxPriorityFeePerGas?(i&&s&&!e.txParams.maxFeePerGas&&!e.txParams.maxPriorityFeePerGas||"metamask"===e.origin?e.userFeeLevel=A.GAS_RECOMMENDATIONS.MEDIUM:e.userFeeLevel=t?A.PRIORITY_LEVELS.DAPP_SUGGESTED:A.CUSTOM_GAS_ESTIMATE,i&&!e.txParams.maxFeePerGas&&(e.txParams.maxFeePerGas=i),s&&!e.txParams.maxPriorityFeePerGas&&(e.txParams.maxPriorityFeePerGas=s),n&&!e.txParams.maxFeePerGas&&(e.txParams.maxFeePerGas=n),e.txParams.maxFeePerGas&&!e.txParams.maxPriorityFeePerGas&&(e.txParams.maxPriorityFeePerGas=e.txParams.maxFeePerGas)):(e.txParams.maxFeePerGas=e.txParams.gasPrice,e.txParams.maxPriorityFeePerGas=e.txParams.gasPrice,t&&"metamask"!==e.origin?e.userFeeLevel=A.PRIORITY_LEVELS.DAPP_SUGGESTED:e.userFeeLevel=A.CUSTOM_GAS_ESTIMATE),delete e.txParams.gasPrice}else delete e.txParams.maxPriorityFeePerGas,delete e.txParams.maxFeePerGas;return!n||e.txParams.gasPrice||e.txParams.maxPriorityFeePerGas||e.txParams.maxFeePerGas||(e.txParams.gasPrice=n),o&&!e.txParams.gas&&(e.txParams.gas=o,e.originalGasEstimate=o),e.defaultGasEstimates={estimateType:e.userFeeLevel,gas:e.txParams.gas,gasPrice:e.txParams.gasPrice,maxFeePerGas:e.txParams.maxFeePerGas,maxPriorityFeePerGas:e.txParams.maxPriorityFeePerGas},e}async _getDefaultGasFees(e,t){if(!t&&e.txParams.gasPrice||t&&e.txParams.maxFeePerGas&&e.txParams.maxPriorityFeePerGas)return{};try{const{gasFeeEstimates:e,gasEstimateType:r}=await this._getEIP1559GasFeeEstimates();if(t&&r===A.GAS_ESTIMATE_TYPES.FEE_MARKET){const{medium:{suggestedMaxPriorityFeePerGas:t,suggestedMaxFeePerGas:r}={}}=e;if(t&&r)return{maxFeePerGas:(0,T.decGWEIToHexWEI)(r),maxPriorityFeePerGas:(0,T.decGWEIToHexWEI)(t)}}else{if(r===A.GAS_ESTIMATE_TYPES.LEGACY)return{gasPrice:(0,T.decGWEIToHexWEI)(e.medium)};if(r===A.GAS_ESTIMATE_TYPES.ETH_GASPRICE)return{gasPrice:(0,T.decGWEIToHexWEI)(e.gasPrice)}}}catch(e){console.error(e)}const r=await this.query.gasPrice();return{gasPrice:r&&(0,y.addHexPrefix)(r.toString(16))}}async _getDefaultGasLimit(e,t){const r=this._getCurrentChainId(),n=S.CHAIN_ID_TO_GAS_LIMIT_BUFFER_MAP[r],i=(0,y.getChainType)(r);if(e.txParams.gas)return{};if(e.txParams.to&&e.type===_.TRANSACTION_TYPES.SIMPLE_SEND&&"custom"!==i){if(e.txParams.data){const e=new Error("TxGasUtil - Trying to call a function on a non-contract address");throw e.errorKey=v.TRANSACTION_NO_CONTRACT_ERROR_KEY,e.getCodeResponse=t,e}return{gasLimit:A.GAS_LIMITS.SIMPLE}}const{blockGasLimit:s,estimatedGasHex:o,simulationFails:a}=await this.txGasUtil.analyzeGasUsage(e);return{gasLimit:this.txGasUtil.addGasBuffer((0,y.addHexPrefix)(o),s,n),simulationFails:a}}generateNewGasParams(e,t={},r=11){const{txParams:n}=e,i={},s={};var o;t.gasLimit&&(s.gas=null!==(o=null==t?void 0:t.gas)&&void 0!==o?o:A.GAS_LIMITS.SIMPLE);return t.estimateSuggested&&(s.estimateSuggested=t.estimateSuggested),t.estimateUsed&&(s.estimateUsed=t.estimateUsed),(0,x.isEIP1559Transaction)(e)?(i.maxFeePerGas=n.maxFeePerGas,i.maxPriorityFeePerGas=n.maxPriorityFeePerGas,s.maxFeePerGas=(null==t?void 0:t.maxFeePerGas)||(0,y.bnToHex)((0,y.BnMultiplyByFraction)((0,y.hexToBn)(n.maxFeePerGas),r,10)),s.maxPriorityFeePerGas=(null==t?void 0:t.maxPriorityFeePerGas)||(0,y.bnToHex)((0,y.BnMultiplyByFraction)((0,y.hexToBn)(n.maxPriorityFeePerGas),r,10))):(i.gasPrice=n.gasPrice,s.gasPrice=(null==t?void 0:t.gasPrice)||(0,y.bnToHex)((0,y.BnMultiplyByFraction)((0,y.hexToBn)(n.gasPrice),r,10))),{previousGasParams:i,newGasParams:s}}async createCancelTransaction(e,t,{estimatedBaseFee:r}={}){const n=this.txStateManager.getTransaction(e),{txParams:i}=n,{from:s,nonce:o}=i,{previousGasParams:a,newGasParams:u}=this.generateNewGasParams(n,B(B({},t),{},{gasLimit:t.gasLimit||A.GAS_LIMITS.SIMPLE})),c=this.txStateManager.generateTxMeta({txParams:B({from:s,to:s,nonce:o,value:"0x0"},u),previousGasParams:a,loadingDefaults:!1,status:_.TRANSACTION_STATUSES.APPROVED,type:_.TRANSACTION_TYPES.CANCEL});return r&&(c.estimatedBaseFee=r),this.addTransaction(c),await this.approveTransaction(c.id),c}async createSpeedUpTransaction(e,t,{estimatedBaseFee:r}={}){const n=this.txStateManager.getTransaction(e),{txParams:i}=n,{previousGasParams:s,newGasParams:o}=this.generateNewGasParams(n,t),a=this.txStateManager.generateTxMeta({txParams:B(B({},i),o),previousGasParams:s,loadingDefaults:!1,status:_.TRANSACTION_STATUSES.APPROVED,type:_.TRANSACTION_TYPES.RETRY});return r&&(a.estimatedBaseFee=r),this.addTransaction(a),await this.approveTransaction(a.id),a}async updateTransaction(e){this.txStateManager.updateTransaction(e,"confTx: user updated transaction")}async updateAndApproveTransaction(e){this.txStateManager.updateTransaction(e,"confTx: user approved transaction"),await this.approveTransaction(e.id)}async approveTransaction(e){if(this.inProcessOfSigning.has(e))return;let t;this.inProcessOfSigning.add(e);try{this.txStateManager.setTxStatusApproved(e);const r=this.txStateManager.getTransaction(e),n=r.txParams.from;let{customNonceValue:i}=r;i=Number(i),t=await this.nonceTracker.getNonceLock(n);const s=r.previousGasParams?r.txParams.nonce:t.nextNonce,o=0===i?i:i||s;r.txParams.nonce=(0,y.addHexPrefix)(o.toString(16)),r.nonceDetails=t.nonceDetails,i&&(r.nonceDetails.customNonceValue=i),this.txStateManager.updateTransaction(r,"transactions#approveTransaction");const a=await this.signTransaction(e);await this.publishTransaction(e,a),this._trackTransactionMetricsEvent(r,_.TRANSACTION_EVENTS.APPROVED),t.releaseLock()}catch(r){try{this._failTransaction(e,r)}catch(e){d.default.error(e)}throw t&&t.releaseLock(),r}finally{this.inProcessOfSigning.delete(e)}}async approveTransactionsWithSameNonce(e=[]){if(0===e.length)return"";const t=e[0],r=await this.getCommonConfiguration(t.from),n=l.TransactionFactory.fromTxData(t,{common:r}),i=(0,a.bufferToHex)(n.serialize());if(this.inProcessOfSigning.has(i))return"";let s,o;this.inProcessOfSigning.add(i);try{const r=t.from;o=await this.nonceTracker.getNonceLock(r);const n=o.nextNonce;s=await Promise.all(e.map((e=>(e.nonce=(0,y.addHexPrefix)(n.toString(16)),this.signExternalTransaction(e)))))}catch(e){throw d.default.error(e),e}finally{o&&o.releaseLock(),this.inProcessOfSigning.delete(i)}return s}async signExternalTransaction(e){const t=C.normalizeTxParams(e),r=this.getChainId(),n=(0,x.isEIP1559Transaction)({txParams:t})?_.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET:_.TRANSACTION_ENVELOPE_TYPES.LEGACY,i=B(B({},t),{},{type:n,gasLimit:t.gas,chainId:(0,y.addHexPrefix)((0,b.decimalToHex)(r))}),s=i.from,o=await this.getCommonConfiguration(s),u=l.TransactionFactory.fromTxData(i,{common:o}),c=await this.signEthTx(u,s);return(0,a.bufferToHex)(c.serialize())}async signTransaction(e){const t=this.txStateManager.getTransaction(e),r=this.getChainId(),n=(0,x.isEIP1559Transaction)(t)?_.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET:_.TRANSACTION_ENVELOPE_TYPES.LEGACY,i=B(B({},t.txParams),{},{type:n,chainId:r,gasLimit:t.txParams.gas}),s=i.from,o=await this.getCommonConfiguration(i.from),u=l.TransactionFactory.fromTxData(i,{common:o}),c=await this.signEthTx(u,s);t.r=(0,a.bufferToHex)(c.r),t.s=(0,a.bufferToHex)(c.s),t.v=(0,a.bufferToHex)(c.v),this.txStateManager.updateTransaction(t,"transactions#signTransaction: add r, s, v values"),this.txStateManager.setTxStatusSigned(t.id);return(0,a.bufferToHex)(c.serialize())}async publishTransaction(e,t){const r=this.txStateManager.getTransaction(e);if(r.rawTx=t,r.type===_.TRANSACTION_TYPES.SWAP){const e=await this.query.getBalance(r.txParams.from);r.preTxBalance=e.toString(16)}let n;this.txStateManager.updateTransaction(r,"transactions#publishTransaction");try{n=await this.query.sendRawTransaction(t)}catch(e){if(!e.message.toLowerCase().includes("known transaction"))throw e;n=(0,a.keccak)((0,a.toBuffer)((0,y.addHexPrefix)(t),"hex")).toString("hex"),n=(0,y.addHexPrefix)(n)}this.setTxHash(e,n),this.txStateManager.setTxStatusSubmitted(e),this._trackTransactionMetricsEvent(r,_.TRANSACTION_EVENTS.SUBMITTED)}async confirmTransaction(e,t,r,n){const i=this.txStateManager.getTransaction(e);if(i)try{const s=C.normalizeTxReceiptGasUsed(t.gasUsed);i.txReceipt=B(B({},t),{},{gasUsed:s}),r&&(i.baseFeePerGas=r),n&&(i.blockTimestamp=n),this.txStateManager.setTxStatusConfirmed(e),this._markNonceDuplicatesDropped(e);const{submittedTime:o}=i,a={gas_used:s};if(o&&(a.completion_time=this._getTransactionCompletionTime(o)),"0x0"===t.status&&(a.status=O),this._trackTransactionMetricsEvent(i,_.TRANSACTION_EVENTS.FINALIZED,a),this.txStateManager.updateTransaction(i,"transactions#confirmTransaction - add txReceipt"),i.type===_.TRANSACTION_TYPES.SWAP){const t=await this.query.getBalance(i.txParams.from),r=this.txStateManager.getTransaction(e),n=r.approvalTxId?this.txStateManager.getTransaction(r.approvalTxId):null;r.postTxBalance=t.toString(16),this.txStateManager.updateTransaction(r,"transactions#confirmTransaction - add postTxBalance"),this._trackSwapsMetrics(r,n)}}catch(e){d.default.error(e)}}async confirmExternalTransaction(e,t,r){if(await this.txStateManager.addExternalTransaction(e),!e)return;const n=e.id;try{const i=C.normalizeTxReceiptGasUsed(t.gasUsed);e.txReceipt=B(B({},t),{},{gasUsed:i}),r&&(e.baseFeePerGas=r),this.txStateManager.setTxStatusConfirmed(n),this._markNonceDuplicatesDropped(n);const{submittedTime:s}=e,o={gas_used:i};if(s&&(o.completion_time=this._getTransactionCompletionTime(s)),"0x0"===t.status&&(o.status=O),this._trackTransactionMetricsEvent(e,_.TRANSACTION_EVENTS.FINALIZED,o),this.txStateManager.updateTransaction(e,"transactions#confirmTransaction - add txReceipt"),e.type===_.TRANSACTION_TYPES.SWAP){const t=await this.query.getBalance(e.txParams.from),r=this.txStateManager.getTransaction(n),i=r.approvalTxId?this.txStateManager.getTransaction(r.approvalTxId):null;r.postTxBalance=t.toString(16),this.txStateManager.updateTransaction(r,"transactions#confirmTransaction - add postTxBalance"),this._trackSwapsMetrics(r,i)}}catch(e){d.default.error(e)}}async cancelTransaction(e){const t=this.txStateManager.getTransaction(e);this.txStateManager.setTxStatusRejected(e),this._trackTransactionMetricsEvent(t,_.TRANSACTION_EVENTS.REJECTED)}setTxHash(e,t){const r=this.txStateManager.getTransaction(e);r.hash=t,this.txStateManager.updateTransaction(r,"transactions#setTxHash")}async createTransactionEventFragment(e,t){const r=this.txStateManager.getTransaction(e),{properties:n,sensitiveProperties:i}=await this._buildEventFragmentProperties(r);this._createTransactionEventFragment(r,t,n,i)}_mapMethods(){this.getState=()=>this.memStore.getState(),this.getNetwork=()=>this.networkStore.getState(),this.getSelectedAddress=()=>this.preferencesStore.getState().selectedAddress,this.getUnapprovedTxCount=()=>Object.keys(this.txStateManager.getUnapprovedTxList()).length,this.getPendingTxCount=e=>this.txStateManager.getPendingTransactions(e).length,this.getTransactions=e=>this.txStateManager.getTransactions(e),this.getAdvancedGasFee=()=>this.preferencesStore.getState().advancedGasFee}async _updatePendingTxsAfterFirstBlock(){await this.blockTracker.getLatestBlock(),await this.pendingTxTracker.updatePendingTxs()}_onBootCleanUp(){this.txStateManager.getTransactions({searchCriteria:{status:_.TRANSACTION_STATUSES.UNAPPROVED,loadingDefaults:!0}}).forEach((e=>{this.addTxGasDefaults(e).then((e=>{e.loadingDefaults=!1,this.txStateManager.updateTransaction(e,"transactions: gas estimation for tx on boot")})).catch((t=>{const r=this.txStateManager.getTransaction(e.id);r.loadingDefaults=!1,this.txStateManager.updateTransaction(r,"failed to estimate gas during boot cleanup."),this._failTransaction(r.id,t)}))})),this.txStateManager.getTransactions({searchCriteria:{status:_.TRANSACTION_STATUSES.APPROVED}}).forEach((e=>{const t=new Error('Transaction found as "approved" during boot - possibly stuck during signing');this._failTransaction(e.id,t)}))}_setupListeners(){this.txStateManager.on("tx:status-update",this.emit.bind(this,"tx:status-update")),this._setupBlockTrackerListener(),this.pendingTxTracker.on("tx:warning",(e=>{this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:warning")})),this.pendingTxTracker.on("tx:failed",((e,t)=>{this._failTransaction(e,t)})),this.pendingTxTracker.on("tx:confirmed",((e,t,r,n)=>this.confirmTransaction(e,t,r,n))),this.pendingTxTracker.on("tx:dropped",(e=>{this._dropTransaction(e)})),this.pendingTxTracker.on("tx:block-update",((e,t)=>{e.firstRetryBlockNumber||(e.firstRetryBlockNumber=t,this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:block-update"))})),this.pendingTxTracker.on("tx:retry",(e=>{"retryCount"in e||(e.retryCount=0),e.retryCount+=1,this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:retry")}))}_markNonceDuplicatesDropped(e){const t=this.txStateManager.getTransaction(e),{nonce:r,from:n}=t.txParams,i=this.txStateManager.getTransactions({searchCriteria:{nonce:r,from:n}});i.length&&i.forEach((r=>{r.id!==e&&(r.replacedBy=t.hash,this.txStateManager.updateTransaction(t,"transactions/pending-tx-tracker#event: tx:confirmed reference to confirmed txHash with same nonce"),this._dropTransaction(r.id))}))}_setupBlockTrackerListener(){let e=!1;const t=this._onLatestBlock.bind(this),{blockTracker:r,txStateManager:n}=this;function i(){const i=n.getPendingTransactions();!e&&i.length>0?(r.on("latest",t),e=!0):e&&!i.length&&(r.removeListener("latest",t),e=!1)}n.on("tx:status-update",i),i()}async _onLatestBlock(e){try{await this.pendingTxTracker.updatePendingTxs()}catch(e){d.default.error(e)}try{await this.pendingTxTracker.resubmitPendingTxs(e)}catch(e){d.default.error(e)}}_updateMemstore(){const e=this.txStateManager.getUnapprovedTxList(),t=this.txStateManager.getTransactions({limit:100});this.memStore.updateState({unapprovedTxs:e,currentNetworkTxList:t})}_trackSwapsMetrics(e,t){if(this._getParticipateInMetrics()&&e.swapMetaData)if("0x0"===e.txReceipt.status)this._trackMetaMetricsEvent({event:"Swap Failed",sensitiveProperties:B({},e.swapMetaData),category:"swaps"});else{const r=(0,w.getSwapsTokensReceivedFromTxMeta)(e.destinationTokenSymbol,e,e.destinationTokenAddress,e.txParams.from,e.destinationTokenDecimals,t,e.chainId),n=r?`${new p.default(r,10).div(e.swapMetaData.token_to_amount,10).times(100).round(2)}%`:null,i=e.txReceipt.gasUsed&&e.swapMetaData.estimated_gas?`${new p.default(e.txReceipt.gasUsed,16).div(e.swapMetaData.estimated_gas,10).times(100).round(2)}%`:null;this._trackMetaMetricsEvent({event:"Swap Completed",category:"swaps",sensitiveProperties:B(B({},e.swapMetaData),{},{token_to_amount_received:r,quote_vs_executionRatio:n,estimated_vs_used_gasRatio:i})})}}async _buildEventFragmentProperties(e,t){const{type:r,time:n,status:i,chainId:s,origin:o,txParams:{gasPrice:a,gas:u,maxFeePerGas:c,maxPriorityFeePerGas:h,estimateSuggested:l,estimateUsed:f},defaultGasEstimates:d,metamaskNetworkId:p}=e,m="metamask"===o?"user":"dapp",{assetType:g,tokenStandard:y}=await(0,x.determineTransactionAssetType)(e,this.query,this.getTokenStandardAndDetails),v={};if((0,x.isEIP1559Transaction)(e)?(v.max_fee_per_gas=c,v.max_priority_fee_per_gas=h):v.gas_price=a,d){const{estimateType:t}=d;if(t){v.default_estimate=t;let r=e.defaultGasEstimates.maxFeePerGas,n=e.defaultGasEstimates.maxPriorityFeePerGas;if([A.GAS_RECOMMENDATIONS.LOW,A.GAS_RECOMMENDATIONS.MEDIUM,A.GAS_RECOMMENDATIONS.MEDIUM.HIGH].includes(t)){var w,b;const{gasFeeEstimates:e}=await this._getEIP1559GasFeeEstimates();var _,k;if(null!=e&&null!==(w=e[t])&&void 0!==w&&w.suggestedMaxFeePerGas)r=null===(_=e[t])||void 0===_?void 0:_.suggestedMaxFeePerGas,v.default_max_fee_per_gas=r;if(null!=e&&null!==(b=e[t])&&void 0!==b&&b.suggestedMaxPriorityFeePerGas)n=null===(k=e[t])||void 0===k?void 0:k.suggestedMaxPriorityFeePerGas,v.default_max_priority_fee_per_gas=n}}e.defaultGasEstimates.gas&&(v.default_gas=e.defaultGasEstimates.gas),e.defaultGasEstimates.gasPrice&&(v.default_gas_price=e.defaultGasEstimates.gasPrice)}l&&(v.estimate_suggested=l),f&&(v.estimate_used=f);const T=this._getGasValuesInGWEI(v);let S="0";if(e.txParams.maxFeePerGas){const{eip1559V2Enabled:e}=this.preferencesStore.getState();S=e?"2":"1"}return{properties:{chain_id:s,referrer:o,source:m,network:p,type:r,eip_1559_version:S,gas_edit_type:"none",gas_edit_attempted:"none",account_type:await this.getAccountType(this.getSelectedAddress()),device_model:await this.getDeviceModel(this.getSelectedAddress()),asset_type:g,token_standard:y},sensitiveProperties:B(B({status:i,transaction_envelope_type:(0,x.isEIP1559Transaction)(e)?E.TRANSACTION_ENVELOPE_TYPE_NAMES.FEE_MARKET:E.TRANSACTION_ENVELOPE_TYPE_NAMES.LEGACY,first_seen:n,gas_limit:u},T),t)}}_createTransactionEventFragment(e,t,r,n){const i=`transaction-${[_.TRANSACTION_EVENTS.FINALIZED,_.TRANSACTION_EVENTS.SUBMITTED].includes(t)?"submitted":"added"}-${e.id}`;if(void 0===this.getEventFragmentById(i))switch(t){case _.TRANSACTION_EVENTS.ADDED:this.createEventFragment({category:"Transactions",initialEvent:_.TRANSACTION_EVENTS.ADDED,successEvent:_.TRANSACTION_EVENTS.APPROVED,failureEvent:_.TRANSACTION_EVENTS.REJECTED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:i});break;case _.TRANSACTION_EVENTS.APPROVED:case _.TRANSACTION_EVENTS.REJECTED:this.createEventFragment({category:"Transactions",successEvent:_.TRANSACTION_EVENTS.APPROVED,failureEvent:_.TRANSACTION_EVENTS.REJECTED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:i});break;case _.TRANSACTION_EVENTS.SUBMITTED:this.createEventFragment({category:"Transactions",initialEvent:_.TRANSACTION_EVENTS.SUBMITTED,successEvent:_.TRANSACTION_EVENTS.FINALIZED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:i});break;case _.TRANSACTION_EVENTS.FINALIZED:this.createEventFragment({category:"Transactions",successEvent:_.TRANSACTION_EVENTS.FINALIZED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:i})}}async _trackTransactionMetricsEvent(e,t,r={}){if(!e)return;const{properties:n,sensitiveProperties:i}=await this._buildEventFragmentProperties(e,r);let s;switch(this._createTransactionEventFragment(e,t,n,i),t){case _.TRANSACTION_EVENTS.APPROVED:s=`transaction-added-${e.id}`,this.updateEventFragment(s,{properties:n,sensitiveProperties:i}),this.finalizeEventFragment(s);break;case _.TRANSACTION_EVENTS.REJECTED:s=`transaction-added-${e.id}`,this.updateEventFragment(s,{properties:n,sensitiveProperties:i}),this.finalizeEventFragment(s,{abandoned:!0});break;case _.TRANSACTION_EVENTS.FINALIZED:s=`transaction-submitted-${e.id}`,this.updateEventFragment(s,{properties:n,sensitiveProperties:i}),this.finalizeEventFragment(`transaction-submitted-${e.id}`)}}_getTransactionCompletionTime(e){return Math.round((Date.now()-e)/1e3).toString()}_getGasValuesInGWEI(e){const t={};for(const r in e)(0,a.isHexString)(e[r])?t[r]=(0,b.hexWEIToDecGWEI)(e[r]):t[r]=e[r];return t}_failTransaction(e,t){this.txStateManager.setTxStatusFailed(e,t);const r=this.txStateManager.getTransaction(e);this._trackTransactionMetricsEvent(r,_.TRANSACTION_EVENTS.FINALIZED,{error:t.message})}_dropTransaction(e){this.txStateManager.setTxStatusDropped(e);const t=this.txStateManager.getTransaction(e);this._trackTransactionMetricsEvent(t,_.TRANSACTION_EVENTS.FINALIZED)}}r.default=j}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/transactions/index.js"}],[33,{"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"fast-json-patch":4295,lodash:5172},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.generateHistoryEntry=u,r.migrateFromSnapshotsToDiffs=function(e){return e.map(((t,r)=>0===r?t:u(e[r-1],t)))},r.replayHistory=function(e){return(0,o.cloneDeep)(e).reduce(((e,t)=>s.default.applyPatch(e,t).newDocument))},r.snapshotFromTxMeta=function(e){const t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e);return delete t.history,(0,o.cloneDeep)(t)};var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("fast-json-patch")),o=e("lodash");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e,t,r){const n=s.default.compare(e,t);return n[0]&&(r&&(n[0].note=r),n[0].timestamp=Date.now()),n}}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/transactions/lib/tx-state-history-helpers.js"}],[34,{"../../../../../shared/constants/transaction":6193,"../../../../../shared/modules/hexstring-utils":6199,"../../../../../shared/modules/transaction.utils":6205,"../../../lib/util":81,"eth-rpc-errors":2455},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getFinalStates=function(){return[s.TRANSACTION_STATUSES.REJECTED,s.TRANSACTION_STATUSES.CONFIRMED,s.TRANSACTION_STATUSES.FAILED,s.TRANSACTION_STATUSES.DROPPED]},r.normalizeAndValidateTxParams=function(e,t=!0){const r=c(e,t);return d(r),r},r.normalizeTxParams=c,r.normalizeTxReceiptGasUsed=function(e){return"string"==typeof e?e:e.toString(16)},r.validateConfirmedExternalTransaction=void 0,r.validateFrom=p,r.validateRecipient=m,r.validateTxParams=d;var n=e("eth-rpc-errors"),i=e("../../../lib/util"),s=e("../../../../../shared/constants/transaction"),o=e("../../../../../shared/modules/transaction.utils"),a=e("../../../../../shared/modules/hexstring-utils");const u={from:i.addHexPrefix,to:(e,t)=>t?(0,i.addHexPrefix)(e).toLowerCase():(0,i.addHexPrefix)(e),nonce:i.addHexPrefix,value:i.addHexPrefix,data:i.addHexPrefix,gas:i.addHexPrefix,gasPrice:i.addHexPrefix,maxFeePerGas:i.addHexPrefix,maxPriorityFeePerGas:i.addHexPrefix,type:i.addHexPrefix,estimateSuggested:e=>e,estimateUsed:e=>e};function c(e,t=!0){const r={};for(const n in u)e[n]&&(r[n]=u[n](e[n],t));return r}function h(e,t,r){if(void 0!==e[r])throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: specified ${t} but also included ${r}, these cannot be mixed`)}function l(e,t){if("string"!=typeof e[t])throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a string. got: (${e[t]})`)}function f(e,t){switch(t){case"maxFeePerGas":case"maxPriorityFeePerGas":if(e.type&&e.type!==s.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET)throw n.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but including maxFeePerGas and maxPriorityFeePerGas requires type: "${s.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET}"`);break;default:if(e.type&&e.type===s.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET)throw n.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but included a gasPrice instead of maxFeePerGas and maxPriorityFeePerGas`)}}function d(e,t=!0){if(!e||"object"!=typeof e||Array.isArray(e))throw n.ethErrors.rpc.invalidParams("Invalid transaction params: must be an object.");if(!e.to&&!e.data)throw n.ethErrors.rpc.invalidParams('Invalid transaction params: must specify "data" for contract deployments, or "to" (and optionally "data") for all other types of transactions.');if((0,o.isEIP1559Transaction)({txParams:e})&&!t)throw n.ethErrors.rpc.invalidParams("Invalid transaction params: params specify an EIP-1559 transaction but the current network does not support EIP-1559");Object.entries(e).forEach((([t,r])=>{switch(t){case"from":p(e);break;case"to":m(e);break;case"gasPrice":f(e,"gasPrice"),h(e,"gasPrice","maxFeePerGas"),h(e,"gasPrice","maxPriorityFeePerGas"),l(e,"gasPrice");break;case"maxFeePerGas":f(e,"maxFeePerGas"),h(e,"maxFeePerGas","gasPrice"),l(e,"maxFeePerGas");break;case"maxPriorityFeePerGas":f(e,"maxPriorityFeePerGas"),h(e,"maxPriorityFeePerGas","gasPrice"),l(e,"maxPriorityFeePerGas");break;case"value":if(l(e,"value"),r.toString().includes("-"))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value "${r}": not a positive number.`);if(r.toString().includes("."))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": number must be in wei.`);if(!r.match(/^0x[a-fA-F0-9]+$/u))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": not a valid hex string.`);break;case"chainId":if("number"!=typeof r&&"string"!=typeof r)throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a Number or hex string. got: (${r})`);break;default:l(e,t)}}))}function p(e){if("string"!=typeof e.from)throw n.ethErrors.rpc.invalidParams(`Invalid "from" address "${e.from}": not a string.`);if(!(0,a.isValidHexAddress)(e.from,{allowNonPrefixed:!1}))throw n.ethErrors.rpc.invalidParams('Invalid "from" address.')}function m(e){if("0x"===e.to||null===e.to){if(!e.data)throw n.ethErrors.rpc.invalidParams('Invalid "to" address.');delete e.to}else if(e.to!==undefined&&!(0,a.isValidHexAddress)(e.to,{allowNonPrefixed:!1}))throw n.ethErrors.rpc.invalidParams('Invalid "to" address.');return e}r.validateConfirmedExternalTransaction=({txMeta:e,pendingTransactions:t,confirmedTransactions:r}={})=>{if(!e||!e.txParams)throw n.ethErrors.rpc.invalidParams('"txMeta" or "txMeta.txParams" is missing');if(e.status!==s.TRANSACTION_STATUSES.CONFIRMED)throw n.ethErrors.rpc.invalidParams('External transaction status should be "confirmed"');const i=e.txParams.nonce;if(t&&t.length>0){if(t.find((e=>{var t;return(null===(t=e.txParams)||void 0===t?void 0:t.nonce)===i})))throw n.ethErrors.rpc.invalidParams("External transaction nonce should not be in pending txs")}if(r&&r.length>0){if(r.find((e=>{var t;return(null===(t=e.txParams)||void 0===t?void 0:t.nonce)===i})))throw n.ethErrors.rpc.invalidParams("External transaction nonce should not be in confirmed txs")}}}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/transactions/lib/util.js"}],[35,{"../../../../shared/constants/transaction":6193,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"ethjs-query":2570,loglevel:5182,"safe-event-emitter":5740},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("safe-event-emitter")),o=n(e("loglevel")),a=n(e("ethjs-query")),u=e("../../../../shared/constants/transaction");class c extends s.default{constructor(e){super(),(0,i.default)(this,"DROPPED_BUFFER_COUNT",3),(0,i.default)(this,"droppedBlocksBufferByHash",new Map),this.query=e.query||new a.default(e.provider),this.nonceTracker=e.nonceTracker,this.getPendingTransactions=e.getPendingTransactions,this.getCompletedTransactions=e.getCompletedTransactions,this.publishTransaction=e.publishTransaction,this.approveTransaction=e.approveTransaction,this.confirmTransaction=e.confirmTransaction}async updatePendingTxs(){const e=await this.nonceTracker.getGlobalLock();try{const e=this.getPendingTransactions();await Promise.all(e.map((e=>this._checkPendingTx(e))))}catch(e){o.default.error("PendingTransactionTracker - Error updating pending transactions"),o.default.error(e)}e.releaseLock()}async resubmitPendingTxs(e){const t=this.getPendingTransactions();if(t.length)for(const i of t)try{await this._resubmitTx(i,e)}catch(e){var r,n;const t=(null===(r=e.value)||void 0===r||null===(n=r.message)||void 0===n?void 0:n.toLowerCase())||e.message.toLowerCase();if(t.includes("replacement transaction underpriced")||t.includes("known transaction")||t.includes("gas price too low to replace")||t.includes("transaction with the same hash was already imported")||t.includes("gateway timeout")||t.includes("nonce too low"))return;i.warning={error:t,message:"There was an error when resubmitting this transaction."},this.emit("tx:warning",i,e)}}async _resubmitTx(e,t){e.firstRetryBlockNumber||this.emit("tx:block-update",e,t);const r=e.firstRetryBlockNumber||t,n=Number.parseInt(t,16)-Number.parseInt(r,16),i=e.retryCount||0;if(n<Math.min(50,Math.pow(2,i)))return undefined;if(!("rawTx"in e))return this.approveTransaction(e.id);const{rawTx:s}=e,o=await this.publishTransaction(s);return this.emit("tx:retry",e),o}async _checkPendingTx(e){const t=e.hash,r=e.id;if(e.status===u.TRANSACTION_STATUSES.SUBMITTED){if(!t){const e=new Error("We had an error while submitting this transaction, please try again.");return e.name="NoTxHashError",void this.emit("tx:failed",r,e)}if(await this._checkIfNonceIsTaken(e))this.emit("tx:dropped",r);else{try{const e=await this.query.getTransactionReceipt(t);if(null!=e&&e.blockNumber){const{baseFeePerGas:t,timestamp:n}=await this.query.getBlockByHash(null==e?void 0:e.blockHash,!1);return void this.emit("tx:confirmed",r,e,t,n)}}catch(t){return e.warning={error:t.message,message:"There was a problem loading this transaction."},void this.emit("tx:warning",e,t)}await this._checkIfTxWasDropped(e)&&this.emit("tx:dropped",r)}}}async _checkIfTxWasDropped(e){const{hash:t,txParams:{nonce:r,from:n}}=e,i=await this.query.getTransactionCount(n);if(parseInt(r,16)>=i.toNumber())return!1;this.droppedBlocksBufferByHash.has(t)||this.droppedBlocksBufferByHash.set(t,0);const s=this.droppedBlocksBufferByHash.get(t);return s<this.DROPPED_BUFFER_COUNT?(this.droppedBlocksBufferByHash.set(t,s+1),!1):(this.droppedBlocksBufferByHash.delete(t),!0)}async _checkIfNonceIsTaken(e){const t=e.txParams.from;return this.getCompletedTransactions(t).some((t=>!(t.id===e.id)&&t.txParams.nonce===e.txParams.nonce))}}r.default=c}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/transactions/pending-tx-tracker.js"}],[36,{"../../lib/util":81,"@babel/runtime/helpers/interopRequireDefault":195,"ethereumjs-util":2521,"ethjs-query":2570,lodash:5172,loglevel:5182},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("ethjs-query")),s=n(e("loglevel")),o=e("ethereumjs-util"),a=e("lodash"),u=e("../../lib/util");r.default=class{constructor(e){this.query=new i.default(e)}async analyzeGasUsage(e){const t=await this.query.getBlockByNumber("latest",!1),r=(0,u.hexToBn)(t.gasLimit),n=(0,u.BnMultiplyByFraction)(r,19,20);let i,o=(0,u.bnToHex)(n);try{o=await this.estimateTxGas(e)}catch(e){s.default.warn(e),i={reason:e.message,errorKey:e.errorKey,debug:{blockNumber:t.number,blockGasLimit:t.gasLimit}}}return{blockGasLimit:t.gasLimit,estimatedGasHex:o,simulationFails:i}}async estimateTxGas(e){const t=(0,a.cloneDeep)(e.txParams);return delete t.gasPrice,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,await this.query.estimateGas(t)}addGasBuffer(e,t,r=1.5){const n=(0,u.hexToBn)(e),i=(0,u.hexToBn)(t).muln(.9),s=n.muln(r);return n.gt(i)?(0,u.bnToHex)(n):s.lt(i)?(0,u.bnToHex)(s):(0,u.bnToHex)(i)}async getBufferedGasLimit(e,t){const{blockGasLimit:r,estimatedGasHex:n,simulationFails:i}=await this.analyzeGasUsage(e);return{gasLimit:this.addGasBuffer((0,o.addHexPrefix)(n),r,t),simulationFails:i}}}}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/transactions/tx-gas-utils.js"}],[37,{"../../../../shared/constants/transaction":6193,"../../../../shared/modules/random-id":6201,"../../../../shared/modules/transaction.utils":6205,"../../metamask-controller":82,"./lib/tx-state-history-helpers":33,"./lib/util":34,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/obs-store":1193,lodash:5172,loglevel:5182,"safe-event-emitter":5740},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("safe-event-emitter")),o=e("@metamask/obs-store"),a=n(e("loglevel")),u=e("lodash"),c=n(e("../../../../shared/modules/random-id")),h=e("../../../../shared/constants/transaction"),l=e("../../metamask-controller"),f=e("../../../../shared/modules/transaction.utils"),d=e("./lib/tx-state-history-helpers"),p=e("./lib/util");function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class y extends s.default{constructor({initState:e,txHistoryLimit:t,getNetwork:r,getCurrentChainId:n}){super(),this.store=new o.ObservableStore(g({transactions:{}},e)),this.txHistoryLimit=t,this.getNetwork=r,this.getCurrentChainId=n}generateTxMeta(e={}){var t;const r=this.getNetwork(),n=this.getCurrentChainId();if("loading"===r)throw new Error("MetaMask is having trouble connecting to the network");let i=null;return e.txParams&&"string"==typeof e.origin&&"metamask"!==e.origin&&(void 0!==e.txParams.gasPrice?i={gasPrice:e.txParams.gasPrice}:void 0===e.txParams.maxFeePerGas&&void 0===e.txParams.maxPriorityFeePerGas||(i={maxPriorityFeePerGas:e.txParams.maxPriorityFeePerGas,maxFeePerGas:e.txParams.maxFeePerGas}),void 0!==e.txParams.gas&&(i=g(g({},i),{},{gas:e.txParams.gas}))),g({id:(0,c.default)(),time:(new Date).getTime(),status:h.TRANSACTION_STATUSES.UNAPPROVED,metamaskNetworkId:r,originalGasEstimate:null===(t=e.txParams)||void 0===t?void 0:t.gas,userEditedGasLimit:!1,chainId:n,loadingDefaults:!0,dappSuggestedGasFees:i},e)}getUnapprovedTxList(){const e=this.getCurrentChainId(),t=this.getNetwork();return(0,u.pickBy)(this.store.getState().transactions,(r=>r.status===h.TRANSACTION_STATUSES.UNAPPROVED&&(0,f.transactionMatchesNetwork)(r,e,t)))}getApprovedTransactions(e){const t={status:h.TRANSACTION_STATUSES.APPROVED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getPendingTransactions(e){const t={status:h.TRANSACTION_STATUSES.SUBMITTED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getConfirmedTransactions(e){const t={status:h.TRANSACTION_STATUSES.CONFIRMED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}addTransaction(e){e.txParams&&(e.txParams=(0,p.normalizeAndValidateTxParams)(e.txParams,!1)),this.once(`${e.id}:signed`,(()=>{this.removeAllListeners(`${e.id}:rejected`)})),this.once(`${e.id}:rejected`,(()=>{this.removeAllListeners(`${e.id}:signed`)})),e.history=[];const t=(0,d.snapshotFromTxMeta)(e);e.history.push(t);const r=this.getTransactions({filterToCurrentNetwork:!1}),{txHistoryLimit:n}=this,i=new Set,s=r.reverse().filter((e=>{const{nonce:t,from:r}=e.txParams,{chainId:s,metamaskNetworkId:o,status:a}=e,u=`${t}-${null!=s?s:o}-${r}`;return!i.has(u)&&(!(i.size<n-1||!1===(0,p.getFinalStates)().includes(a))||(i.add(u),!1))})).map((e=>e.id));return this._deleteTransactions(s),this._addTransactionsToState([e]),e}addExternalTransaction(e){var t;const r=null==e||null===(t=e.txParams)||void 0===t?void 0:t.from,n=this.getConfirmedTransactions(r),i=this.getPendingTransactions(r);return(0,p.validateConfirmedExternalTransaction)({txMeta:e,pendingTransactions:i,confirmedTransactions:n}),this._addTransactionsToState([e]),e}getTransaction(e){const{transactions:t}=this.store.getState();return t[e]}updateTransaction(e,t){e.txParams&&(e.txParams=(0,p.normalizeAndValidateTxParams)(e.txParams,!1));const r=(0,d.snapshotFromTxMeta)(e),n=(0,d.replayHistory)(e.history),i=(0,d.generateHistoryEntry)(n,r,t);i.length&&e.history.push(i);const s=e.id;this.store.updateState({transactions:g(g({},this.store.getState().transactions),{},{[s]:e})})}getTransactions({searchCriteria:e={},initialList:t,filterToCurrentNetwork:r=!0,limit:n}={}){const i=this.getCurrentChainId(),s=this.getNetwork(),o=(0,u.mapValues)(e,(e=>"function"==typeof e?e:t=>t===e)),a=t?(0,u.keyBy)(t,"id"):this.store.getState().transactions,c=(0,u.sortBy)((0,u.pickBy)(a,(e=>{if(r&&!1===(0,f.transactionMatchesNetwork)(e,i,s))return!1;for(const[t,r]of Object.entries(o))if(t in e.txParams){if(!1===r(e.txParams[t]))return!1}else if(!1===r(e[t]))return!1;return!0})),"time");if(n!==undefined){const e=new Set,t=[];for(let r=c.length-1;r>-1;r--){const i=c[r],{nonce:s}=i.txParams;if(!e.has(s)){if(!(e.size<n))continue;e.add(s)}t.unshift(i)}return t}return c}setTxStatusRejected(e){this._setTransactionStatus(e,h.TRANSACTION_STATUSES.REJECTED),this._deleteTransaction(e)}setTxStatusUnapproved(e){this._setTransactionStatus(e,h.TRANSACTION_STATUSES.UNAPPROVED)}setTxStatusApproved(e){this._setTransactionStatus(e,h.TRANSACTION_STATUSES.APPROVED)}setTxStatusSigned(e){this._setTransactionStatus(e,h.TRANSACTION_STATUSES.SIGNED)}setTxStatusSubmitted(e){const t=this.getTransaction(e);t.submittedTime=(new Date).getTime(),this.updateTransaction(t,"txStateManager - add submitted time stamp"),this._setTransactionStatus(e,h.TRANSACTION_STATUSES.SUBMITTED)}setTxStatusConfirmed(e){this._setTransactionStatus(e,h.TRANSACTION_STATUSES.CONFIRMED)}setTxStatusDropped(e){this._setTransactionStatus(e,h.TRANSACTION_STATUSES.DROPPED)}setTxStatusFailed(e,t){var r;const n=t||new Error("Internal metamask failure"),i=this.getTransaction(e);i.err={message:(null===(r=n.message)||void 0===r?void 0:r.toString())||n.toString(),rpc:n.value,stack:n.stack},this.updateTransaction(i,"transactions:tx-state-manager#fail - add error"),this._setTransactionStatus(e,h.TRANSACTION_STATUSES.FAILED)}wipeTransactions(e){const{transactions:t}=this.store.getState(),r=this.getNetwork(),n=this.getCurrentChainId();this.store.updateState({transactions:(0,u.omitBy)(t,(t=>t.txParams.from===e&&(0,f.transactionMatchesNetwork)(t,n,r)))})}clearUnapprovedTxs(){this.store.updateState({transactions:(0,u.omitBy)(this.store.getState().transactions,(e=>e.status===h.TRANSACTION_STATUSES.UNAPPROVED))})}_setTransactionStatus(e,t){const r=this.getTransaction(e);if(r){r.status=t;try{this.updateTransaction(r,`txStateManager: setting status to ${t}`),this.emit(`${r.id}:${t}`,e),this.emit("tx:status-update",e,t),[h.TRANSACTION_STATUSES.SUBMITTED,h.TRANSACTION_STATUSES.REJECTED,h.TRANSACTION_STATUSES.FAILED].includes(t)&&this.emit(`${r.id}:finished`,r),this.emit(l.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}catch(e){a.default.error(e)}}}_addTransactionsToState(e){this.store.updateState({transactions:e.reduce(((e,t)=>(e[t.id]=t,e)),this.store.getState().transactions)})}_deleteTransaction(e){const{transactions:t}=this.store.getState();delete t[e],this.store.updateState({transactions:t})}_deleteTransactions(e){const{transactions:t}=this.store.getState();e.forEach((e=>{delete t[e]})),this.store.updateState({transactions:t})}}r.default=y}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/controllers/transactions/tx-state-manager.js"}],[38,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={config:{},PreferencesController:{frequentRpcListDetail:[{rpcUrl:"http://localhost:8545",chainId:"0x539",ticker:"ETH",nickname:"Localhost 8545",rpcPrefs:{}}]}};r.default=n}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/first-time-state.js"}],[39,{"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/controllers":1042,"@metamask/obs-store":1193},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("@metamask/obs-store"),o=e("@metamask/controllers");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class c extends s.ObservableStore{constructor({config:e,controllerMessenger:t,state:r,persist:n}){super(r),(0,i.default)(this,"config",{}),this.persist=n,this.controllerMessenger=t,e&&this.updateStructure(e)}updateStructure(e){this.config=e,this.removeAllListeners();for(const t of Object.keys(e)){if(!e[t])throw new Error(`Undefined '${t}'`);const r=e[t];r.subscribe?e[t].subscribe((e=>{this.updateState({[t]:e})})):this.controllerMessenger.subscribe(`${r.name}:stateChange`,(r=>{let n=r;this.persist&&(n=(0,o.getPersistentState)(r,e[t].metadata)),this.updateState({[t]:n})}))}}getFlatState(){if(!this.config)return{};let e={};for(const t of Object.keys(this.config)){const r=this.config[t],n=r.getState?r.getState():r.state;e=u(u({},e),n)}return e}}r.default=c}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/lib/ComposableObservableStore.js"}],[4,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SINGLE_CALL_BALANCES_ADDRESS_ROPSTEN=r.SINGLE_CALL_BALANCES_ADDRESS_RINKEBY=r.SINGLE_CALL_BALANCES_ADDRESS_KOVAN=r.SINGLE_CALL_BALANCES_ADDRESS=void 0;r.SINGLE_CALL_BALANCES_ADDRESS="0xb1f8e55c7f64d203c1400b9d8555d050f94adf39";r.SINGLE_CALL_BALANCES_ADDRESS_RINKEBY="0x9f510b19f1ad66f0dcf6e45559fab0d6752c1db7";r.SINGLE_CALL_BALANCES_ADDRESS_ROPSTEN="0xb8e671734ce5c8d7dfbbea5574fa4cf39f7a54a4";r.SINGLE_CALL_BALANCES_ADDRESS_KOVAN="0xb1d3fbb2f83aecd196f474c16ca5d9cffa0d0ffc"}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/constants/contracts.js"}],[40,{"../../../shared/constants/network":6189,"../constants/contracts":4,"./util":81,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/obs-store":1193,"eth-query":2451,loglevel:5182,pify:5414,"single-call-balance-checker-abi":5836,web3:6108},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("eth-query")),s=e("@metamask/obs-store"),o=n(e("loglevel")),a=n(e("pify")),u=n(e("web3")),c=n(e("single-call-balance-checker-abi")),h=e("../../../shared/constants/network"),l=e("../constants/contracts"),f=e("./util");r.default=class{constructor(e={}){this.store=new s.ObservableStore({accounts:{},currentBlockGasLimit:""}),this._provider=e.provider,this._query=(0,a.default)(new i.default(this._provider)),this._blockTracker=e.blockTracker,this._currentBlockNumber=this._blockTracker.getCurrentBlock(),this._blockTracker.once("latest",(e=>{this._currentBlockNumber=e})),this._updateForBlock=this._updateForBlock.bind(this),this.getCurrentChainId=e.getCurrentChainId,this.web3=new u.default(this._provider)}start(){this._blockTracker.removeListener("latest",this._updateForBlock),this._blockTracker.addListener("latest",this._updateForBlock),this._updateAccounts()}stop(){this._blockTracker.removeListener("latest",this._updateForBlock)}syncWithAddresses(e){const{accounts:t}=this.store.getState(),r=Object.keys(t),n=[];e.forEach((e=>{r.includes(e)||n.push(e)}));const i=[];r.forEach((t=>{e.includes(t)||i.push(t)})),this.addAccounts(n),this.removeAccount(i)}addAccounts(e){const{accounts:t}=this.store.getState();e.forEach((e=>{t[e]={}})),this.store.updateState({accounts:t}),this._currentBlockNumber&&this._updateAccounts()}removeAccount(e){const{accounts:t}=this.store.getState();e.forEach((e=>{delete t[e]})),this.store.updateState({accounts:t})}clearAccounts(){this.store.updateState({accounts:{}})}async _updateForBlock(e){this._currentBlockNumber=e;const t=await this._query.getBlockByNumber(e,!1);if(!t)return;const r=t.gasLimit;this.store.updateState({currentBlockGasLimit:r});try{await this._updateAccounts()}catch(e){o.default.error(e)}}async _updateAccounts(){const{accounts:e}=this.store.getState(),t=Object.keys(e);switch(this.getCurrentChainId()){case h.MAINNET_CHAIN_ID:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS);break;case h.RINKEBY_CHAIN_ID:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS_RINKEBY);break;case h.ROPSTEN_CHAIN_ID:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS_ROPSTEN);break;case h.KOVAN_CHAIN_ID:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS_KOVAN);break;default:await Promise.all(t.map(this._updateAccount.bind(this)))}}async _updateAccount(e){const t={address:e,balance:await this._query.getBalance(e)},{accounts:r}=this.store.getState();r[e]&&(r[e]=t,this.store.updateState({accounts:r}))}async _updateAccountsViaBalanceChecker(e,t){const{accounts:r}=this.store.getState();this.web3.setProvider(this._provider);this.web3.eth.contract(c.default).at(t).balances(e,["0x0"],((t,n)=>{if(t)return o.default.warn("MetaMask - Account Tracker single call balance fetch failed",t),void Promise.all(e.map(this._updateAccount.bind(this)));e.forEach(((e,t)=>{const i=n[t]?(0,f.bnToHex)(n[t]):"0x0";r[e]={address:e,balance:i}})),this.store.updateState({accounts:r})}))}}}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/lib/account-tracker.js"}],[42,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){let{name:t}=e;t=t===undefined?"Error":String(t);let r=e.message;r=r===undefined?"":String(r),""===t?e.stack=e.message:""===r?e.stack=e.name:e.stack||(e.stack=`${e.name}: ${e.message}`);return e}}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/lib/cleanErrorStack.js"}],[4294,{"./helpers":4296,"fast-deep-equal":4297},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("fast-deep-equal"),i=e("./helpers");r.JsonPatchError=i.PatchError,r.deepClone=i._deepClone;var s={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){var n=a(r,this.path);n&&(n=i._deepClone(n));var s=u(r,{op:"remove",path:this.from}).removed;return u(r,{op:"add",path:this.path,value:s}),{newDocument:r,removed:n}},copy:function(e,t,r){var n=a(r,this.from);return u(r,{op:"add",path:this.path,value:i._deepClone(n)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:n(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}},o={add:function(e,t,r){return i.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:s.move,copy:s.copy,test:s.test,_get:s._get};function a(e,t){if(""==t)return e;var r={op:"_get",path:t};return u(e,r),r.value}function u(e,t,u,c,h,f){if(void 0===u&&(u=!1),void 0===c&&(c=!0),void 0===h&&(h=!0),void 0===f&&(f=0),u&&("function"==typeof u?u(t,0,e,t.path):l(t,0)),""===t.path){var d={newDocument:e};if("add"===t.op)return d.newDocument=t.value,d;if("replace"===t.op)return d.newDocument=t.value,d.removed=e,d;if("move"===t.op||"copy"===t.op)return d.newDocument=a(e,t.from),"move"===t.op&&(d.removed=e),d;if("test"===t.op){if(d.test=n(e,t.value),!1===d.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",f,t,e);return d.newDocument=e,d}if("remove"===t.op)return d.removed=e,d.newDocument=null,d;if("_get"===t.op)return t.value=e,d;if(u)throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",f,t,e);return d}c||(e=i._deepClone(e));var p=(t.path||"").split("/"),m=e,g=1,y=p.length,v=undefined,w=void 0,b=void 0;for(b="function"==typeof u?u:l;;){if(w=p[g],h&&"__proto__"==w)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(u&&v===undefined&&(m[w]===undefined?v=p.slice(0,g).join("/"):g==y-1&&(v=t.path),v!==undefined&&b(t,0,e,v)),g++,Array.isArray(m)){if("-"===w)w=m.length;else{if(u&&!i.isInteger(w))throw new r.JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",f,t,e);i.isInteger(w)&&(w=~~w)}if(g>=y){if(u&&"add"===t.op&&w>m.length)throw new r.JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",f,t,e);if(!1===(d=o[t.op].call(t,m,w,e)).test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",f,t,e);return d}}else if(w&&-1!=w.indexOf("~")&&(w=i.unescapePathComponent(w)),g>=y){if(!1===(d=s[t.op].call(t,m,w,e)).test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",f,t,e);return d}m=m[w]}}function c(e,t,n,s,o){if(void 0===s&&(s=!0),void 0===o&&(o=!0),n&&!Array.isArray(t))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");s||(e=i._deepClone(e));for(var a=new Array(t.length),c=0,h=t.length;c<h;c++)a[c]=u(e,t[c],n,!0,o,c),e=a[c].newDocument;return a.newDocument=e,a}function h(e,t,n){var i=u(e,t);if(!1===i.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function l(e,t,n,o){if("object"!=typeof e||null===e||Array.isArray(e))throw new r.JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!s[e.op])throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new r.JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new r.JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new r.JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&e.value===undefined)throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&i.hasUndefined(e.value))throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var a=e.path.split("/").length,u=o.split("/").length;if(a!==u+1&&a!==u)throw new r.JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==o)throw new r.JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var c=f([{op:"_get",path:e.from,value:undefined}],n);if(c&&"OPERATION_PATH_UNRESOLVABLE"===c.name)throw new r.JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function f(e,t,n){try{if(!Array.isArray(e))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)c(i._deepClone(t),i._deepClone(e),n||!0);else{n=n||l;for(var s=0;s<e.length;s++)n(e[s],s,t,undefined)}}catch(e){if(e instanceof r.JsonPatchError)return e;throw e}}r.getValueByPointer=a,r.applyOperation=u,r.applyPatch=c,r.applyReducer=h,r.validator=l,r.validate=f,r.default={JsonPatchError:r.JsonPatchError,deepClone:r.deepClone,getValueByPointer:a,applyOperation:u,applyPatch:c,applyReducer:h,validator:l,validate:f}}}},{package:"fast-json-patch",file:"/home/gudahtt/projects/metamask-extension/node_modules/fast-json-patch/lib/core.js"}],[4295,{"./core":4294,"./helpers":4296},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0});
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var i=e("./helpers"),s=e("./core"),o=e("./core");r.applyOperation=o.applyOperation,r.applyPatch=o.applyPatch,r.applyReducer=o.applyReducer,r.getValueByPointer=o.getValueByPointer,r.validate=o.validate,r.validator=o.validator;var a=e("./helpers");r.JsonPatchError=a.PatchError,r.deepClone=a._deepClone,r.escapePathComponent=a.escapePathComponent,r.unescapePathComponent=a.unescapePathComponent;var u=new WeakMap,c=function(e){this.observers=new Map,this.obj=e},h=function(e,t){this.callback=e,this.observer=t};function l(e,t){t.unobserve()}function f(e,t){var r,n=function(e){return u.get(e)}(e);if(n){var s=function(e,t){return e.observers.get(t)}(n,t);r=s&&s.observer}else n=new c(e),u.set(e,n);if(r)return r;if(r={},n.value=i._deepClone(e),t){r.callback=t,r.next=null;var o=function(){d(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=[],r.object=e,r.unobserve=function(){d(r),clearTimeout(r.next),function(e,t){e.observers.delete(t.callback)}(n,r),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},n.observers.set(t,new h(t,r)),r}function d(e,t){void 0===t&&(t=!1);var r=u.get(e.object);p(r.value,e.object,e.patches,"",t),e.patches.length&&s.applyPatch(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function p(e,t,r,n,s){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var o=i._objectKeys(t),a=i._objectKeys(e),u=!1,c=a.length-1;c>=0;c--){var h=e[f=a[c]];if(!i.hasOwnProperty(t,f)||t[f]===undefined&&h!==undefined&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(s&&r.push({op:"test",path:n+"/"+i.escapePathComponent(f),value:i._deepClone(h)}),r.push({op:"remove",path:n+"/"+i.escapePathComponent(f)}),u=!0):(s&&r.push({op:"test",path:n,value:e}),r.push({op:"replace",path:n,value:t}),!0);else{var l=t[f];"object"==typeof h&&null!=h&&"object"==typeof l&&null!=l?p(h,l,r,n+"/"+i.escapePathComponent(f),s):h!==l&&(!0,s&&r.push({op:"test",path:n+"/"+i.escapePathComponent(f),value:i._deepClone(h)}),r.push({op:"replace",path:n+"/"+i.escapePathComponent(f),value:i._deepClone(l)}))}}if(u||o.length!=a.length)for(c=0;c<o.length;c++){var f=o[c];i.hasOwnProperty(e,f)||t[f]===undefined||r.push({op:"add",path:n+"/"+i.escapePathComponent(f),value:i._deepClone(t[f])})}}}function m(e,t,r){void 0===r&&(r=!1);var n=[];return p(e,t,n,"",r),n}r.unobserve=l,r.observe=f,r.generate=d,r.compare=m;var g=e("./core"),y=e("./helpers");r.default=n({},g,{unobserve:l,observe:f,generate:d,compare:m,JsonPatchError:y.PatchError,deepClone:i._deepClone,escapePathComponent:i.escapePathComponent,unescapePathComponent:y.unescapePathComponent})}}},{package:"fast-json-patch",file:"/home/gudahtt/projects/metamask-extension/node_modules/fast-json-patch/lib/duplex.js"}],[4296,{},function(){with(this)return function(){"use strict";return function(e,t,r){
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s=Object.prototype.hasOwnProperty;function o(e,t){return s.call(e,t)}function a(e){if(Array.isArray(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);t=[];for(var n in e)o(e,n)&&t.push(n);return t}function u(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function c(e,t){var r;for(var n in e)if(o(e,n)){if(e[n]===t)return u(n)+"/";if("object"==typeof e[n]&&""!=(r=c(e[n],t)))return u(n)+"/"+r}return""}function h(e,t){var r=[e];for(var n in t){var i="object"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];void 0!==i&&r.push(n+": "+i)}return r.join("\n")}Object.defineProperty(r,"hasOwnProperty",{value:o}),r._objectKeys=a,r._deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},r.isInteger=function(e){for(var t,r=0,n=e.length;r<n;){if(!((t=e.charCodeAt(r))>=48&&t<=57))return!1;r++}return!0},r.escapePathComponent=u,r.unescapePathComponent=function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")},r._getPathRecursive=c,r.getPath=function(e,t){if(e===t)return"/";var r=c(e,t);if(""===r)throw new Error("Object not found in root");return"/"+r},r.hasUndefined=function e(t){if(t===undefined)return!0;if(t)if(Array.isArray(t)){for(var r=0,n=t.length;r<n;r++)if(e(t[r]))return!0}else if("object"==typeof t){var i=a(t),s=i.length;for(r=0;r<s;r++)if(e(t[i[r]]))return!0}return!1};var l=function(e){function t(t,r,n,i,s){var o=this.constructor,a=e.call(this,h(t,{name:r,index:n,operation:i,tree:s}))||this;return a.name=r,a.index=n,a.operation=i,a.tree=s,Object.setPrototypeOf(a,o.prototype),a.message=h(t,{name:r,index:n,operation:i,tree:s}),a}return i(t,e),t}(Error);r.PatchError=l}}},{package:"fast-json-patch",file:"/home/gudahtt/projects/metamask-extension/node_modules/fast-json-patch/lib/helpers.js"}],[4297,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Array.isArray,i=Object.keys,s=Object.prototype.hasOwnProperty;t.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){var o,a,u,c=n(t),h=n(r);if(c&&h){if((a=t.length)!=r.length)return!1;for(o=a;0!=o--;)if(!e(t[o],r[o]))return!1;return!0}if(c!=h)return!1;var l=t instanceof Date,f=r instanceof Date;if(l!=f)return!1;if(l&&f)return t.getTime()==r.getTime();var d=t instanceof RegExp,p=r instanceof RegExp;if(d!=p)return!1;if(d&&p)return t.toString()==r.toString();var m=i(t);if((a=m.length)!==i(r).length)return!1;for(o=a;0!=o--;)if(!s.call(r,m[o]))return!1;for(o=a;0!=o--;)if(!e(t[u=m[o]],r[u]))return!1;return!0}return t!=t&&r!=r}}}},{package:"fast-deep-equal",file:"/home/gudahtt/projects/metamask-extension/node_modules/fast-json-patch/node_modules/fast-deep-equal/index.js"}],[43,{"@babel/runtime/helpers/interopRequireDefault":195,loglevel:5182},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,n){n((n=>{r.error&&i.default.error("Error in RPC response:\n",r),t.isMetamaskInternal||(i.default.info(`RPC (${e.origin}):`,t,"->",r),n())}))}};var i=n(e("loglevel"))}}},{package:"<root>",file:"/home/gudahtt/projects/metamask-extension/app/scripts/lib/createLoggerMiddleware.js"}],[4300,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){for(var t=n.BASE,r=0,i=e.length;r<i;r++)t^=e.charCodeAt(r),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}n.BASE=2166136261,t.exports=n}}},{package:"fnv1a",file:"/home/gudahtt/projects/metamask-extension/node_modules/fnv1a/index.js"}],[4302,{constants:2152},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("constants")}}},{package:"fs-constants",file:"/home/gudahtt/projects/metamask-extension/node_modules/fs-constants/browser.js"}],[4303,{assert:1700,events:2082,fsm:4304},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("events").EventEmitter,i=e("assert"),s=e("fsm");t.exports=function(e,t){"object"==typeof e&&(t=e,e="START");i.equal(typeof e,"string"),i.equal(typeof t,"object"),i.ok(t[e],"invalid starting state "+e),i.ok(s.validate(t));const r=new n;return o._graph=s.reachable(t),o._emitter=r,o._events=t,o._state=e,o.emit=o,o.on=function(e,t){r.on(e,t)},o;function o(e){const t=o._events[o._state][e];if(!function(e,t,r){if(!t)return!1;if(!e)return!0;const n=r[e];return!(!n||!n[t])&&1===n[t].length}(o._state,t,o._graph)){const t="invalid transition: "+o._state+" -> "+e;return r.emit("error",t)}const n=o._state+":leave",i=t+":enter";return o._state?void(r._events[n]?r.emit(n,s):s()):s();function s(){r._events[i]?r.emit(i,a):a()}function a(){o._state=t,r.emit(t),r.emit("done")}}}}}},{package:"fsm-event",file:"/home/gudahtt/projects/metamask-extension/node_modules/fsm-event/index.js"}],[4304,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e,t){for(var r in e){t(e[r],r,e)}}function i(e){return Object.keys(e).sort()}function s(e,t){return~e.indexOf(t)}function o(e,t){return e.filter((function(e){return s(t,e)}))}r.validate=function(e){Object.keys(e);return n(e,(function(t,r){n(t,(function(t,n){if(!e[t])throw new Error("invalid transition from state:"+r+" to state:"+t+" on event:"+n)}))})),!0};var a=r.reachable=function(e){var t={},r=!1;do{r=!1,n(e,(function(e,i){var s=t[i]=t[i]||{};n(e,(function(e,t){s[e]||(s[e]=[t],r=!0)})),n(e,(function(e,i){n(t[e],(function(e,t){s[t]||(s[t]=[i].concat(e),r=!0)}))}))}))}while(r);return t};r.terminal=r.deadlock=function(e){var t=[];return n(e,(function(e,r){(function(e){for(var t in e)return!1;return!0})(e)&&t.push(r)})),t};r.livelock=function(e,t){var r=a(e),i=[];return n(r,(function(e,r){s(t,r)||n(t,(function(t){e[t]||s(i,r)||i.push(r)}))})),i.sort()};function u(e){var t=[];return n(e,(function(e,r){n(e,(function(e,r){s(t,r)||t.push(r)}))})),t.sort()}r.combine=function(e,t,r,n){var a,c,h={},l=u(e),f=u(t),d=(c=f,(a=l).filter((function(e){return!s(c,e)})).concat(c.filter((function(e){return!s(a,e)}))).sort());return function r(n,s){var a,u=n+"-"+s;h[u]||(h[u]={}),a=h[u];var c=i(e[n]),l=i(t[s]);return o(c,l).forEach((function(i){a[i]=e[n][i]+"-"+t[s][i],h[a[i]]||r(e[n][i],t[s][i])})),o(d,c).forEach((function(t){a[t]=e[n][t]+"-"+s,h[a[t]]||r(e[n][t],s)})),o(d,l).forEach((function(e){a[e]=n+"-"+t[s][e],h[a[e]]||r(n,t[s][e])})),h[u]}(r,n),h}}}},{package:"fsm",file:"/home/gudahtt/projects/metamask-extension/node_modules/fsm/index.js"}],[4308,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(){if("undefined"==typeof window)return null;var e={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}}}},{package:"get-browser-rtc",file:"/home/gudahtt/projects/metamask-extension/node_modules/get-browser-rtc/index.js"}],[4310,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){if(e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}}}},{package:"get-iterator",file:"/home/gudahtt/projects/metamask-extension/node_modules/get-iterator/index.js"}],[4318,{"./types":4319,"cross-fetch/polyfill":4320},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(o,a)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=n[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},o=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]])}return r};Object.defineProperty(r,"__esModule",{value:!0});var a=e("./types"),u=e("./types");r.ClientError=u.ClientError,e("cross-fetch/polyfill");var c=function(){function e(e,t){this.url=e,this.options=t||{}}return e.prototype.rawRequest=function(e,t){return i(this,void 0,void 0,(function(){var r,i,u,c,h,f,d,p,m;return s(this,(function(s){switch(s.label){case 0:return r=this.options,i=r.headers,u=o(r,["headers"]),c=JSON.stringify({query:e,variables:t||undefined}),[4,fetch(this.url,n({method:"POST",headers:Object.assign({"Content-Type":"application/json"},i),body:c},u))];case 1:return[4,l(h=s.sent())];case 2:if(f=s.sent(),h.ok&&!f.errors&&f.data)return d=h.headers,p=h.status,[2,n({},f,{headers:d,status:p})];throw m="string"==typeof f?{error:f}:f,new a.ClientError(n({},m,{status:h.status,headers:h.headers}),{query:e,variables:t})}}))}))},e.prototype.request=function(e,t){return i(this,void 0,void 0,(function(){var r,i,u,c,h,f,d;return s(this,(function(s){switch(s.label){case 0:return r=this.options,i=r.headers,u=o(r,["headers"]),c=JSON.stringify({query:e,variables:t||undefined}),[4,fetch(this.url,n({method:"POST",headers:Object.assign({"Content-Type":"application/json"},i),body:c},u))];case 1:return[4,l(h=s.sent())];case 2:if(f=s.sent(),h.ok&&!f.errors&&f.data)return[2,f.data];throw d="string"==typeof f?{error:f}:f,new a.ClientError(n({},d,{status:h.status}),{query:e,variables:t})}}))}))},e.prototype.setHeaders=function(e){return this.options.headers=e,this},e.prototype.setHeader=function(e,t){var r,n=this.options.headers;return n?n[e]=t:this.options.headers=((r={})[e]=t,r),this},e}();function h(e,t,r){return i(this,void 0,void 0,(function(){return s(this,(function(n){return[2,new c(e).request(t,r)]}))}))}function l(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(r){return(t=e.headers.get("Content-Type"))&&t.startsWith("application/json")?[2,e.json()]:[2,e.text()]}))}))}r.GraphQLClient=c,r.rawRequest=function(e,t,r){return i(this,void 0,void 0,(function(){return s(this,(function(n){return[2,new c(e).rawRequest(t,r)]}))}))},r.request=h,r.default=h}}},{package:"graphql-request",file:"/home/gudahtt/projects/metamask-extension/node_modules/graphql-request/dist/src/index.js"}],[4319,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s=function(e){function t(r,n){var i=this,s=t.extractMessage(r)+": "+JSON.stringify({response:r,request:n});return(i=e.call(this,s)||this).response=r,i.request=n,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(i,t),i}return i(t,e),t.extractMessage=function(e){try{return e.errors[0].message}catch(t){return"GraphQL Error (Code: "+e.status+")"}},t}(Error);r.ClientError=s}}},{package:"graphql-request",file:"/home/gudahtt/projects/metamask-extension/node_modules/graphql-request/dist/src/types.js"}],[4320,{},function(){with(this)return function(){"use strict";return function(e,t,r){!function(e){if(!e.fetch){var t="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,n="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},u=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};p.prototype.append=function(e,t){e=l(e),t=f(t);var r=this.map[e];this.map[e]=r?r+","+t:t},p.prototype.delete=function(e){delete this.map[l(e)]},p.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},p.prototype.set=function(e,t){this.map[l(e)]=f(t)},p.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),d(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),d(e)},r&&(p.prototype[Symbol.iterator]=p.prototype.entries);var c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},w.call(b.prototype),w.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},E.error=function(){var e=new E(null,{status:0,statusText:""});return e.type="error",e};var h=[301,302,303,307,308];E.redirect=function(e,t){if(-1===h.indexOf(t))throw new RangeError("Invalid status code");return new E(null,{status:t,headers:{location:e}})},e.Headers=p,e.Request=b,e.Response=E,e.fetch=function(e,t){return new Promise((function(r,i){var s=new b(e,t),o=new XMLHttpRequest;o.onload=function(){var e,t,n={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}})),t)};n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL");var i="response"in o?o.response:o.responseText;r(new E(i,n))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.open(s.method,s.url,!0),"include"===s.credentials?o.withCredentials=!0:"omit"===s.credentials&&(o.withCredentials=!1),"responseType"in o&&n&&(o.responseType="blob"),s.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),o.send(void 0===s._bodyInit?null:s._bodyInit)}))},e.fetch.polyfill=!0}function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:t===undefined,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function m(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function g(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function y(e){var t=new FileReader,r=g(t);return t.readAsArrayBuffer(e),r}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(n&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(s&&n&&a(e))this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!s||!ArrayBuffer.prototype.isPrototypeOf(e)&&!u(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=v(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n&&(this.blob=function(){var e=m(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?m(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e,t,r,n=m(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=g(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}function b(e,t){var r,n,i=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),c.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function _(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}})),t}function E(e,t){t||(t={}),this.type="default",this.status=t.status===undefined?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)}}},{package:"cross-fetch",file:"/home/gudahtt/projects/metamask-extension/node_modules/graphql-request/node_modules/cross-fetch/dist/browser-polyfill.js"}],[4321,{"./constants":4323,bech32:4329,bs58check:2090,"buffer/":2096,"hash.js/lib/hash/ripemd":4365,"hash.js/lib/hash/sha":4366},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("bech32"),s=n(e("bs58check")),o=e("buffer/"),a=e("hash.js/lib/hash/ripemd"),u=e("hash.js/lib/hash/sha"),c=e("./constants"),h=o.Buffer.from("01","hex"),l=c.BIP_CONSTANTS.PURPOSES,f=c.BIP_CONSTANTS.COINS,d=0,p=169,m=118,g=135,y=136,v=172,w=208,b=240;function _(e,t){return o.Buffer.concat([e,t])}function E(e){var t=o.Buffer.alloc(4);return t.writeUInt32LE(e,0),t}function k(e){var t;return e<253?(t=o.Buffer.alloc(1)).writeUInt8(e,0):e<=65535?((t=o.Buffer.alloc(3)).writeUInt8(253,0),t.writeUInt16LE(e,1)):e<4294967295?((t=o.Buffer.alloc(5)).writeUInt8(254,0),t.writeUInt32LE(e,1)):((t=o.Buffer.alloc(9)).writeUInt8(255,0),t.writeUInt32LE(e>>>0,1),t.writeUInt32LE(e/4294967296|0,5)),t}function A(e,t,r){"number"==typeof e&&(e=e.toString(16));var n=o.Buffer.alloc(8),i=e.length%2==0?e.toString(16):"0".concat(e.toString(16));return o.Buffer.from(i,"hex").reverse().copy(n,0),n.copy(t,r),n}function T(e){var t,r;try{t=s.default.decode(e)[0],r=s.default.decode(e).slice(1)}catch(s){try{var n=i.bech32.decode(e);if("bc"===n.prefix)t=w;else{if("tb"!==n.prefix)throw new Error("Unsupported prefix: must be bc or tb.");t=b}if(0!==n.words[0])throw new Error("Unsupported segwit version: must be 0, got ".concat(n.words[0]));r=o.Buffer.from(i.bech32.fromWords(n.words.slice(1)))}catch(t){throw new Error("Unable to decode address: ".concat(e,": ").concat(t.message))}}return{versionByte:t,pkh:r}}function S(e){if(e.length<2)throw new Error("Path must be >1 index");var t=e[0],r=e[1];if(t===l.BTC_SEGWIT&&r===f.BTC)return w;if(t===l.BTC_SEGWIT&&r===f.BTC_TESTNET)return b;if(t===l.BTC_WRAPPED_SEGWIT&&r===f.BTC)return 5;if(t===l.BTC_WRAPPED_SEGWIT&&r===f.BTC_TESTNET)return 196;if(t===l.BTC_LEGACY&&r===f.BTC)return 0;if(t===l.BTC_LEGACY&&r===f.BTC_TESTNET)return 111;throw new Error("Invalid Bitcoin path provided. Cannot determine address format.")}function x(e){switch(e.signerPath[0]){case l.BTC_LEGACY:return 1;case l.BTC_WRAPPED_SEGWIT:return 3;case l.BTC_SEGWIT:return 4;default:throw new Error("Unsupported path purpose (".concat(e.signerPath[0],"): cannot determine BTC script type."))}}r.default={buildBitcoinTxRequest:function(e){try{var t=e.prevOuts,r=e.recipient,n=e.value,i=e.changePath,s=e.fee;if(!i)throw new Error("No changePath provided.");if(5!==i.length)throw new Error("Please provide a full change path.");var a=o.Buffer.alloc(59+69*t.length),u=0,h=S(i);a.writeUInt8(h,0),u++,a.writeUInt32LE(i.length,u),u+=4;for(var l=0;l<i.length;l++)a.writeUInt32LE(i[l],u),u+=4;a.writeUInt32LE(s,u),u+=4;var f=T(r);a.writeUInt8(f.versionByte,u),u++,f.pkh.copy(a,u),u+=f.pkh.length,A(n,a,u),u+=8,a.writeUInt8(t.length,u),u++;var d=0;return t.forEach((function(e){if(!e.signerPath||5!==e.signerPath.length)throw new Error("Full recipient path not specified ");a.writeUInt32LE(e.signerPath.length,u),u+=4;for(var t=0;t<e.signerPath.length;t++)a.writeUInt32LE(e.signerPath[t],u),u+=4;a.writeUInt32LE(e.index,u),u+=4,A(e.value,a,u),u+=8,d+=e.value;var r=x(e);a.writeUInt8(r,u),u++,o.Buffer.isBuffer(e.txHash)||(e.txHash=o.Buffer.from(e.txHash,"hex")),e.txHash.copy(a,u),u+=e.txHash.length})),{payload:a,schema:c.signingSchema.BTC_TRANSFER,origData:e,changeData:{value:d-(n+s)}}}catch(e){return{err:e}}},serializeTx:function(e){var t=e.inputs,r=e.outputs,n=e.lockTime,i=void 0===n?0:n,s=o.Buffer.alloc(4),c=0,f=function(e){var t=!1;return e.forEach((function(e){e.signerPath[0]!==l.BTC_SEGWIT&&e.signerPath[0]!==l.BTC_WRAPPED_SEGWIT||(t=!0)})),t}(t);s.writeUInt32LE(2,c),c+=4,f&&(s=_(s,o.Buffer.from("00","hex")),s=_(s,o.Buffer.from("01","hex")));var S=k(t.length);s=_(s,S),c+=S.length,t.forEach((function(e){s=_(s,e.hash.reverse()),c+=e.hash.length;var t=E(e.index);s=_(s,t),c+=t.length;var r=x(e);if(3===r){var n=function(e){var t=o.Buffer.alloc(22),r=o.Buffer.from((0,u.sha256)().update(e).digest("hex"),"hex"),n=o.Buffer.from((0,a.ripemd160)().update(r).digest("hex"),"hex");return t.writeUInt8(d,0),t.writeUInt8(n.length,1),n.copy(t,2),t}(e.pubkey),i=k(n.length),l=k((f=o.Buffer.concat([i,n])).length);s=_(s,l),c+=l.length,s=_(s,f),c+=f.length}else if(1===r){var f=function(e,t){var r=k((e=o.Buffer.concat([e,h])).length),n=k(t.length),i=o.Buffer.concat([r,e,n,t]),s=k(i.length);return o.Buffer.concat([s,i])}(e.sig,e.pubkey);s=_(s,f),c+=f.length}else if(4===r){var p=o.Buffer.from("00","hex");s=_(s,p),c+=1}var m=E(4294967295);s=_(s,m),c+=m.length}));var P=k(r.length);if(s=_(s,P),c+=P.length,r.forEach((function(e){var t,r,n=(t=e.value,r=o.Buffer.alloc(8),A(t,r,0),r);s=_(s,n),c+=n.length;var i=function(e){var t=T(e);switch(t.versionByte){case w:case b:return r=t.pkh,(n=o.Buffer.alloc(2+r.length)).writeUInt8(d,0),n.writeUInt8(r.length,1),r.copy(n,2),n;case 5:case 196:return function(e){var t=o.Buffer.alloc(3+e.length),r=0;return t.writeUInt8(p,r),r++,t.writeUInt8(e.length,r),r++,e.copy(t,r),r+=e.length,t.writeUInt8(g,r),r++,t}(t.pkh);case 0:case 111:return function(e){var t=o.Buffer.alloc(5+e.length),r=0;return t.writeUInt8(m,r),r++,t.writeUInt8(p,r),r++,t.writeUInt8(e.length,r),r++,e.copy(t,r),r+=e.length,t.writeUInt8(y,r),r++,t.writeUInt8(v,r),r++,t}(t.pkh);default:throw new Error("Unknown version byte: ".concat(t.versionByte,". Cannot build BTC transaction."))}var r,n}(e.recipient),a=k(i.length);s=_(s,a),c+=a.length,s=_(s,i),c+=i.length})),f){for(var I=[],M=[],C=0;C<t.length;C++)I.push(t[C].sig),M.push(t[C].pubkey);var L=function(e,t){var r=o.Buffer.alloc(0),n=o.Buffer.alloc(1);n.writeUInt8(2,0);for(var i=0;i<e.length;i++){var s=o.Buffer.concat([e[i],h]),a=k(s.length),u=t[i],c=k(u.length);r=o.Buffer.concat([r,n,a,s,c,u])}return r}(I,M);s=_(s,L),c+=L.length}return o.Buffer.concat([s,E(i)]).toString("hex")},getBitcoinAddress:function(e,t){var r=null,n=null;if(t===w?(r="bc",n=0):t===b&&(r="tb",n=0),null!==r&&null!==n){var a=i.bech32.toWords(e);return a.unshift(n),i.bech32.encode(r,a)}return s.default.encode(o.Buffer.concat([o.Buffer.from([t]),e]))},getAddressFormat:S}}}},{package:"gridplus-sdk",file:"/home/gudahtt/projects/metamask-extension/node_modules/gridplus-sdk/dist/bitcoin.js"}],[4322,{"./bitcoin":4321,"./constants":4323,"./ethereum":4324,"./ethereumAbi":4325,"./genericSigning":4326,"./index":4327,"./util":4328,bitwise:2005,"buffer/":2096,"hash.js/lib/hash/sha":4366,superagent:5901},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.Client=void 0;var s=i(e("bitwise")),o=e("buffer/"),a=i(e("superagent")),u=i(e("./bitcoin")),c=e("hash.js/lib/hash/sha"),h=e("./index"),l=e("./constants"),f=i(e("./ethereum")),d=e("./ethereumAbi"),p=e("./genericSigning"),m=e("./util"),g=o.Buffer.alloc(32),y=function(){function e(e){var t=e.baseUrl,r=e.name,n=e.privKey,i=e.stateData,s=e.timeout,o=e.retryCount,a=e.skipRetryOnWrongWallet;if(this.ephemeralPub=null,this.deviceId=null,this.isPaired=!1,this.activeWallets={internal:{uid:g,name:null,capabilities:null,external:!1},external:{uid:g,name:null,capabilities:null,external:!0}},this.skipRetryOnWrongWallet=a||!1,i)this._unpackAndApplyStateData(i);else{if(this.baseUrl=t||l.BASE_URL,r&&(r.length<5||r.length>24))throw new Error("`name` must be 5-24 characters");this.name=r||"Unknown",this.privKey=n||(0,m.randomBytes)(32),this.key=(0,m.getP256KeyPair)(this.privKey),this.retryCount=o||3,this.timeout=s||6e4}}return e.prototype.getStateData=function(){return this._packStateData()},e.prototype.getFwVersion=function(){return this.fwVersion&&this.fwVersion.length>=3?{fix:this.fwVersion[0],minor:this.fwVersion[1],major:this.fwVersion[2]}:null},e.prototype.connect=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t);if("function"==typeof e){if(!r.deviceId)return s("No device ID has been stored. Please connect with your device ID first.");s=e}else r.deviceId=e;var o=r._buildRequest(l.deviceCodes.CONNECT,r.pubKeyBytes());r._request(o,null,(function(e,t){return e?s(e):(r.isPaired=r._handleConnect(t)||!1,!r.isPaired||r._fwVersionGTE(0,14,1)?s(e,r.isPaired):void r.fetchActiveWallet((function(e){return s(e,r.isPaired)})))}))}))},e.prototype.pair=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t),a=r.pubKeyBytes(),u=o.Buffer.alloc(25);if(r.name.length<5||r.name.length>24)return s("Invalid length for name provided. Must be 5-24 characters.");e.length>0&&u.write(r.name);var h=o.Buffer.concat([a,u,o.Buffer.from(e)]),l=o.Buffer.from((0,c.sha256)().update(h).digest("hex"),"hex"),f=r.key.sign(l),d=(0,m.toPaddedDER)(f),p=o.Buffer.concat([u,d]);r._request(p,"FINALIZE_PAIRING",(function(e,t){if(e)return s(e);var n=r._handlePair(t);if(n)return s(n);r.fetchActiveWallet((function(e){return e?s(e):s(null,r.hasActiveWallet())}))}))}))},e.prototype.test=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t);if(!e.payload)return s("First argument must contain `testID` and `payload` fields.");var a=o.Buffer.alloc(506);a.writeUInt32BE(e.testID,0),a.writeUInt16BE(e.payload.length,4),e.payload.copy(a,6),r._request(a,"TEST",(function(e,t){if(e)return s(e);var n=r._handleEncResponse(t,l.decResLengths.test);return null!==n.err?s(n.err):s(null,n.data.slice(65))}))}))},e.prototype.getAddresses=function(e,t){var r=this;return new Promise((function(n,i){var a=(0,m.promisifyCb)(n,i,t),u=e.startPath,c=e.n,h=e.flag,f=void 0===h?0:h;if(u===undefined||c===undefined)return a("Please provide `startPath` and `n` options");if(u.length<2||u.length>5)return a("Path must include between 2 and 5 indices");if(c>10)return a("You may only request ".concat(10," addresses at once."));var d=(0,l.getFwVersionConst)(r.fwVersion);if(!(0,m.isValidAssetPath)(u,d))return a("Parent derivation path is not supported");var p=53;if(d.varAddrPathSzAllowed)p+=1;else if(5!==u.length)return a("Your Lattice firmware only supports derivation paths with 5 indices. Please upgrade.");var g=o.Buffer.alloc(p),y=0,v=r.getActiveWallet();if(null===v)return a("No active wallet.");v.uid.copy(g,y),y+=32,d.varAddrPathSzAllowed&&(g.writeUInt8(u.length,y),y+=1);for(var w=0;w<5;w++)w<=u.length&&g.writeUInt32BE(u[w],y),y+=4;var b,_=0;if(d.addrFlagsAllowed){_=d.getAddressFlags&&d.getAddressFlags.indexOf(f)>-1?f:0;var E=s.default.nibble.read(_),k=s.default.nibble.read(c);b=s.default.byte.write(E.concat(k))}else b=c;return g.writeUInt8(b,y),y++,r._request(g,"GET_ADDRESSES",(function(e,t){if(e)return a(e);var n=r._handleGetAddresses(t,_);return n.err?a(n.err):a(null,n.data)}))}))},e.prototype.sign=function(e,t,r,i){var s=this;return void 0===r&&(r=null),void 0===i&&(i=null),new Promise((function(a,c){var h=(0,m.promisifyCb)(a,c,t),d=e.data;if(!d)return h("You must provide `data`");var g,y,v,w=(0,l.getFwVersionConst)(s.fwVersion);d=n({fwConstants:w},d);var b=null;if(null!==r&&null!==i)b=r.currency,g=r,y=o.Buffer.concat([i,g.extraDataPayloads.shift()]),v=l.signingSchema.EXTRA_DATA;else{b=e.currency;try{var _=w.genericSigning&&w.genericSigning.encodingTypes&&w.genericSigning.encodingTypes.EVM;if("ETH"===b&&_){var E;console.warn("Using the legacy ETH signing path. This will soon be deprecated. "+"Please switch to general signing request.");try{E=f.default.ethConvertLegacyToGenericReq(d)}catch(e){return h("Could not convert legacy request. Please switch to a general signing "+"request. See gridplus-sdk docs for more information.")}d={fwConstants:w,encodingType:l.EXTERNAL.SIGNING.ENCODINGS.EVM,curveType:l.EXTERNAL.SIGNING.CURVES.SECP256K1,hashType:l.EXTERNAL.SIGNING.HASHES.KECCAK256,signerPath:d.signerPath,payload:E},b=null}g="ETH"===b?f.default.buildEthereumTxRequest(d):"ETH_MSG"===b?f.default.buildEthereumMsgRequest(d):"BTC"===b?u.default.buildBitcoinTxRequest(d):(0,p.buildGenericSigningMsgRequest)(d)}catch(e){return h("Error building signing request: ".concat(e.message))}if(g.err!==undefined)return h(g.err);if(g.payload.length>w.reqMaxDataSz)return h("Transaction is too large");y=g.payload,v=g.schema}var k=o.Buffer.alloc(2+w.reqMaxDataSz),A=0,T=g.extraDataPayloads&&Number(g.extraDataPayloads.length>0);k.writeUInt8(T,A),A+=1,k.writeUInt8(v,A),A+=1;var S=s.getActiveWallet();return null===S?h("No active wallet."):(S.uid.copy(k,A),A+=S.uid.length,y.copy(k,A),s._request(k,"SIGN_TRANSACTION",(function(t,n){if(t){if(t)return h(t)}else{if(T){var o=s._handleEncResponse(n,l.decResLengths.sign);return i=o.data.slice(65,73),r||((r=g).currency=b),s.sign(e,h,r,i)}try{var a=s._handleSign(n,b,g);return h(null,a)}catch(t){return h(t.message)}}})))}))},e.prototype.addAbiDefs=function(e,t,r){var n=this;return void 0===r&&(r=null),new Promise((function(i,s){var a,u=(0,m.promisifyCb)(i,s,t),c=e.slice(0,d.MAX_ABI_DEFS);e=e.slice(d.MAX_ABI_DEFS);try{a=(0,d.buildAddAbiPayload)(c)}catch(e){return u(e)}var h=o.Buffer.alloc(a.length+10);return h.writeUInt16LE(e.length,0),null!==r&&r.copy(h,2),a.copy(h,10),n._request(h,"ADD_ABI_DEFS",(function(t,i,s){if(s&&s!==l.responseCodes.RESP_SUCCESS)return u("Error making request.");if(t)return u(t);var o=n._handleEncResponse(i,l.decResLengths.addAbiDefs);if(r=o.data.slice(65,73),0===e.length)return u(null);n.addAbiDefs(e,u,r)}))}))},e.prototype.getAbiRecords=function(e,t,r){var n=this;return new Promise((function(i,s){var a=(0,m.promisifyCb)(i,s,t),u=e.n,c=void 0===u?1:u,h=e.startIdx,f=void 0===h?0:h,p=e.category,g=void 0===p?"":p,y=(0,l.getFwVersionConst)(n.fwVersion);if(c<1)return a("Must request at least one record (n=0)");if(c<0||f<0)return a("Both `n` and `startIdx` must be >=0");if(!y.abiCategorySz)return a("Outdated Lattice firmware. Please update.");if(g.length>=y.abiCategorySz)return a("category must be <".concat(y.abiCategorySz-1," characters, got ").concat(g.length));r||(r={startIdx:f,numRemaining:null,numFetched:null,records:[]});var v=o.Buffer.alloc(4+y.abiCategorySz);return v.writeUInt16LE(f,0),v.writeUInt16LE(c,2),o.Buffer.from(g).copy(v,4),n._request(v,"GET_ABI_RECORDS",(function(t,i){if(t)return a(t);var s=n._handleEncResponse(i,l.decResLengths.getAbiRecords);if(s.err)return a(s.err);var o=65,u=s.data.readUInt32LE(o);o+=4;var c=s.data.readUInt8(o);o+=1,r.numRemaining=u,r.records||(r.records=[]);for(var h=0;h<c;h++){var f=s.data.slice(o,o+d.ABI_DEF_SZ);o+=d.ABI_DEF_SZ,r.records.push((0,d.unpackAbiDef)(f))}return e.n-=c,e.n<1||c<1?(r.numFetched=r.records.length,a(null,r)):(e.startIdx+=c,n.getAbiRecords(e,a,r))}))}))},e.prototype.removeAbiRecords=function(e,t,r){var n=this;return void 0===r&&(r={numRemoved:0,numTried:0}),new Promise((function(i,s){var a=(0,m.promisifyCb)(i,s,t),u=e.sigs,c=(0,l.getFwVersionConst)(n.fwVersion);if(!c.abiMaxRmv)return a("Outdated Lattice firmware. Please update.");if(0===u.length)return a("At least one signature in `sigs` must be provided.");var h=u.slice(r.numTried,r.numTried+c.abiMaxRmv),d=o.Buffer.alloc(1+4*c.abiMaxRmv),p=0;return d.writeUInt8(h.length,p),p+=1,h.forEach((function(e){try{var t=f.default.ensureHexBuffer(e);if(4!==t.length)return a("Signatures must be 4 bytes.");t.copy(d,p),p+=4}catch(e){return a("Error writing signature: ".concat(e.message))}})),n._request(d,"REMOVE_ABI_RECORDS",(function(t,i){if(t)return a(t);var s=n._handleEncResponse(i,l.decResLengths.removeAbiRecords);if(s.err)return a(s.err);var o=65,u=s.data.readUInt8(o);return o+=1,r.numRemoved+=u,r.numTried+=h.length,r.numTried>=e.sigs.length?a(null,r):n.removeAbiRecords(e,a,r)}))}))},e.prototype.addPermissionV0=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t),a=e.currency,u=e.timeWindow,c=e.limit,h=e.decimals,d=e.asset;if(!a||u===undefined||c===undefined||h===undefined||null===u||null===c||null===h)return s("currency, timeWindow, decimals, and limit are all required options.");if(0===u||0===c)return s("Time window and spending limit must be positive.");var p=a;d&&(p+="_".concat(d));var g=o.Buffer.alloc(293);if(o.Buffer.from(p).length>255)return s("Asset name too long.");o.Buffer.from(p).copy(g,0);var y=f.default.ensureHexBuffer(c);return y.length>32?s("Limit too large."):(y.copy(g,32-y.length+256),g.writeUInt32BE(u,288),g.writeUInt8(h,292),r._request(g,"ADD_PERMISSION_V0",(function(e,t){if(!e){var n=r._handleEncResponse(t,l.decResLengths.empty);return n.err?s(n.err):s(null)}if(e)return s(e)})))}))},e.prototype.getKvRecords=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t),a=e.type,u=void 0===a?0:a,c=e.n,h=void 0===c?1:c,f=e.start,d=void 0===f?0:f,p=(0,l.getFwVersionConst)(r.fwVersion);if(!p.kvActionsAllowed)return s("Unsupported. Please update firmware.");if(h<1)return s("You must request at least one record.");if(h>p.kvActionMaxNum)return s("You may only request up to ".concat(p.kvActionMaxNum," records at once."));var g=o.Buffer.alloc(9);return g.writeUInt32LE(u,0),g.writeUInt8(h,4),g.writeUInt32LE(d,5),r._request(g,"GET_KV_RECORDS",(function(e,t){if(!e){var n=r._handleEncResponse(t,l.decResLengths.getKvRecords);if(n.err)return s(n.err);var i=65,o=parseInt(n.data.slice(i,i+4).toString("hex"),16);i+=4;var a=parseInt(n.data.slice(i,i+1).toString("hex"),16);if(i+=1,a>p.kvActionMaxNum)return s("Too many records fetched. Firmware error.");for(var u=[],c=0;c<a;c++){var h={};h.id=parseInt(n.data.slice(i,i+4).toString("hex"),16),i+=4,h.type=parseInt(n.data.slice(i,i+4).toString("hex"),16),i+=4,h.caseSensitive=1===parseInt(n.data.slice(i,i+1).toString("hex"),16),i+=1;var f=parseInt(n.data.slice(i,i+1).toString("hex"),16);i+=1,h.key=n.data.slice(i,i+f-1).toString(),i+=p.kvKeyMaxStrSz+1;var d=parseInt(n.data.slice(i,i+1).toString("hex"),16);i+=1,h.val=n.data.slice(i,i+d-1).toString(),i+=p.kvValMaxStrSz+1,u.push(h)}return s(null,{records:u,total:o,fetched:a})}if(e)return s(e)}))}))},e.prototype.addKvRecords=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t),a=e.type,u=void 0===a?0:a,c=e.records,h=void 0===c?{}:c,f=e.caseSensitive,d=void 0!==f&&f,p=(0,l.getFwVersionConst)(r.fwVersion);if(!p.kvActionsAllowed)return s("Unsupported. Please update firmware.");if("object"!=typeof h||0===Object.keys(h).length)return s("One or more key-value mapping must be provided in `records` param.");if(Object.keys(h).length>p.kvActionMaxNum)return s("Too many keys provided. Please only provide up to ".concat(p.kvActionMaxNum,"."));if(Object.keys(h).length<1)return s("You must provide at least one key to add.");var g=o.Buffer.alloc(1+139*p.kvActionMaxNum);g.writeUInt8(Object.keys(h).length,0);var y=1;try{Object.keys(h).forEach((function(e){if("string"!=typeof e||String(e).length>p.kvKeyMaxStrSz)throw new Error("Key ".concat(e," too large. Must be <=").concat(p.kvKeyMaxStrSz," characters."));if("string"!=typeof h[e]||String(h[e]).length>p.kvValMaxStrSz)throw new Error("Value ".concat(h[e]," too large. Must be <=").concat(p.kvValMaxStrSz," characters."));if(0===String(e).length||0===String(h[e]).length)throw new Error("Keys and values must be >0 characters.");if(!l.ASCII_REGEX.test(e)||!l.ASCII_REGEX.test(h[e]))throw new Error("Unicode characters are not supported.");g.writeUInt32LE(0,y),y+=4,g.writeUInt32LE(u,y),y+=4,g.writeUInt8(d?1:0,y),y+=1,g.writeUInt8(String(e).length+1,y),y+=1,o.Buffer.from(String(e)).copy(g,y),y+=p.kvKeyMaxStrSz+1,g.writeUInt8(String(h[e]).length+1,y),y+=1,o.Buffer.from(String(h[e])).copy(g,y),y+=p.kvValMaxStrSz+1}))}catch(e){return s("Error building request: ".concat(e.message))}return r._request(g,"ADD_KV_RECORDS",(function(e,t){if(!e){var n=r._handleEncResponse(t,l.decResLengths.empty);return n.err?s(n.err):s(null)}if(e)return s(e)}))}))},e.prototype.removeKvRecords=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t),a=e.type,u=void 0===a?0:a,c=e.ids,h=void 0===c?[]:c,f=(0,l.getFwVersionConst)(r.fwVersion);if(!f.kvActionsAllowed)return s("Unsupported. Please update firmware.");if(!Array.isArray(h)||h.length<1)return s("You must include one or more `ids` to removed.");if(h.length>f.kvRemoveMaxNum)return s("Only up to ".concat(f.kvRemoveMaxNum," records may be removed at once."));var d=o.Buffer.alloc(5+4*f.kvRemoveMaxNum);d.writeUInt32LE(u,0),d.writeUInt8(h.length,4);for(var p=0;p<h.length;p++)d.writeUInt32LE(h[p],5+4*p);return r._request(d,"REMOVE_KV_RECORDS",(function(e,t){if(!e){var n=r._handleEncResponse(t,l.decResLengths.empty);return n.err?s(n.err):s(null)}if(e)return s(e)}))}))},e.prototype.fetchActiveWallet=function(e){var t=this;return new Promise((function(r,n){var i=(0,m.promisifyCb)(r,n,e),s=o.Buffer.alloc(0);return t._request(s,"GET_WALLETS",(function(e,r){return e?(t._resetActiveWallets(),i(e)):i(t._handleGetWallets(r))}))}))},e.prototype._getSharedSecret=function(){return o.Buffer.from(this.key.derive(this.ephemeralPub.getPublic()).toArray("be",32))},e.prototype._getEphemId=function(){if(null===this.ephemeralPub)return null;var e=this._getSharedSecret();return o.Buffer.from((0,c.sha256)().update(e).digest("hex"),"hex").slice(0,4)},e.prototype._buildEncRequest=function(e,t){var r=parseInt(this._getEphemId().toString("hex"),16),n=o.Buffer.concat([o.Buffer.from([e]),t]),i=(0,m.checksum)(n),s=o.Buffer.alloc(n.length+4);n.copy(s,0),s.writeUInt32LE(i,n.length);var a=this._getSharedSecret(),u=(0,m.aes256_encrypt)(s,a),c=o.Buffer.alloc(l.ENC_MSG_LEN+4);return c.writeUInt32LE(r,0),u.copy(c,4),this._buildRequest(l.deviceCodes.ENCRYPTED_REQUEST,c)},e.prototype._buildRequest=function(e,t){var r=t&&o.Buffer.isBuffer(t)?t.length+1:1;e===l.deviceCodes.ENCRYPTED_REQUEST&&(r=1+t.length);var n=0,i=o.Buffer.alloc(r+8);n=i.writeUInt8(l.VERSION_BYTE,n),n=i.writeUInt8(l.REQUEST_TYPE_BYTE,n);var s=(0,m.randomBytes)(4);n=i.writeUInt32BE(parseInt("0x".concat(s.toString("hex"))),n),n=i.writeUInt16BE(r,n),n=i.writeUInt8(e,n),r>1&&(n=t.copy(i,n));var a=(0,m.checksum)(i),u=o.Buffer.alloc(i.length+4);return n=i.copy(u),u.writeUInt32BE(a,n),u},e.prototype._request=function(e,t,r,n){var i=this;if(void 0===n&&(n=this.retryCount),!this.deviceId)return r("Device ID is not set. Please set it and try again.");if(t&&l.encReqCodes[t]===undefined)return r("Unknown encrypted request code.");var s=t?this._buildEncRequest(l.encReqCodes[t],e):e,o="".concat(this.baseUrl,"/").concat(this.deviceId);a.default.post(o).timeout(this.timeout).send({data:s}).then((function(s){if(!s||!s.body)return r("Invalid response: ".concat(s));if(200!==s.body.status)return r("Error code ".concat(s.body.status,": ").concat(s.body.message));var o=(0,m.parseLattice1Response)(s.body.message),a=o.responseCode===l.responseCodes.RESP_ERR_DEV_BUSY||o.responseCode===l.responseCodes.RESP_ERR_GCE_TIMEOUT,u=o.responseCode===l.responseCodes.RESP_ERR_WRONG_WALLET,c=o.responseCode===l.responseCodes.RESP_ERR_INVALID_EPHEM_ID,h=n>0;if(h&&a)setTimeout((function(){i._request(e,t,r,n-1)}),3e3);else if(h&&c)i.connect(i.deviceId,(function(s,o){return s?r(s):o?void i._request(e,t,r,n-1):r("Not paired to device.")}));else if(h&&u&&!i.skipRetryOnWrongWallet)i._resetActiveWallets(),i.fetchActiveWallet().then((function(){if(!(e=i._replaceWalletUID(t,e)))return r("Wrong wallet. Failed to switch. Please reconnect.");i._request(e,t,r,0)})).catch((function(e){return r(e)}));else if(o.responseCode||o.err){if(o.err)return r(o.err);r(l.responseMsgs[o.responseCode]||"Unknown request failure")}else r(null,o.data,o.responseCode)})).catch((function(e){var t="ECONNABORTED"===e.code&&"ETIME"===e.errno;return r(t?"Timeout waiting for device. Please ensure it is connected to the internet and try again in a minute.":"Failed to make request to device: ".concat(e.message))}))},e.prototype._handleConnect=function(e){var t=0,r=e.readUInt8(t)===l.messageConstants.PAIRED;t++;var n=e.slice(t,t+65).toString("hex");if(t+=65,this.fwVersion=e.slice(t,t+4),t+=4,this.ephemeralPub=(0,m.getP256KeyPairFromPub)(n),r&&this._fwVersionGTE(0,14,1)){var i=e.slice(t,t+160);t+=160;var s=this._getSharedSecret(),o=(0,m.aes256_decrypt)(i,s);if(0!==o[o.length-2]||0!==o[o.length-1])throw new Error("Failed to connect to Lattice.");this._parseAndAddWallets(o)}return r},e.prototype._handleEncResponse=function(e,t){var r=this._getSharedSecret(),n=e.slice(0,l.ENC_MSG_LEN),i=(0,m.aes256_decrypt)(n,r);t+=65;var s=i.slice(0,t),o=parseInt("0x".concat(i.slice(t,t+4).toString("hex"))),a=(0,m.checksum)(s);if(o!==a)return{err:"Checksum mismatch in response from Lattice (calculated ".concat(a,", wanted ").concat(o,")")};var u=i.slice(0,65).toString("hex");try{return this.ephemeralPub=(0,m.getP256KeyPairFromPub)(u),{err:null,data:i}}catch(e){return{err:"Error handling getAddresses response: ".concat(e.toString())}}},e.prototype._handlePair=function(e){var t=this._handleEncResponse(e,l.decResLengths.empty);return t.err?t.err:(this.isPaired=!0,null)},e.prototype._handleGetAddresses=function(e,t){var r=this._handleEncResponse(e,l.decResLengths.getAddresses);if(null!==r.err)return r;var n=r.data,i=65,s=[],o=h.Constants.GET_ADDR_FLAGS,a=o.ED25519_PUB,u=o.SECP256K1_PUB,c=t===a||t===u;for(c&&(i+=1);i+4<l.decResLengths.getAddresses;)if(c){var f=n.slice(i,i+65),d=f.every((function(e){return 0===e}));d||t!==a?d||s.push(f):s.push(f.slice(0,32)),i+=65}else{var p=n.slice(i,i+l.ADDR_STR_LEN);i+=l.ADDR_STR_LEN;var m=p.indexOf(0);m>0&&s.push(p.slice(0,m).toString())}return{data:s,err:null}},e.prototype._handleGetWallets=function(e){var t=this._handleEncResponse(e,l.decResLengths.getWallets);if(null!==t.err)return t;var r=t.data;return this._parseAndAddWallets(r.slice(65)),this.activeWallets.internal.uid.equals(g)&&this.activeWallets.external.uid.equals(g)?"No active wallet.":null},e.prototype._parseAndAddWallets=function(e){var t=0;this.activeWallets.internal.uid=e.slice(t,t+32),this.activeWallets.internal.capabilities=e.readUInt32BE(t+32),this.activeWallets.internal.name=e.slice(t+36,t+71),t+=71,this.activeWallets.external.uid=e.slice(t,t+32),this.activeWallets.external.capabilities=e.readUInt32BE(t+32),this.activeWallets.external.name=e.slice(t+36,t+71)},e.prototype._handleSign=function(e,t,r){void 0===r&&(r=null);var n=this._handleEncResponse(e,l.decResLengths.sign);if(null!==n.err)return{err:n.err};var i,s=65,a=n.data;if("BTC"===t){var h=u.default.getAddressFormat(r.origData.changePath),d=a.slice(s,s+20);s+=20,i=u.default.getBitcoinAddress(d,h)}if("BTC"===t){for(var g=[],y=[],v=0;s<a.length&&48===a[s];){var w=s,b=s+2+a[s+1];y.push(a.slice(w,b));var _=33*v+825,E=33*(v+1)+825;g.push(a.slice(_,E)),s+=74,v+=1}var k={inputs:[],outputs:[]};k.outputs.push({value:r.origData.value,recipient:r.origData.recipient}),r.changeData.value>0&&k.outputs.push({value:r.changeData.value,recipient:i});for(var A=0;A<y.length;A++)k.inputs.push({hash:r.origData.prevOuts[A].txHash,index:r.origData.prevOuts[A].index,sig:y[A],pubkey:g[A],signerPath:r.origData.prevOuts[A].signerPath});var T=u.default.serializeTx(k),S=T,x=o.Buffer.from((0,c.sha256)().update(o.Buffer.from(S,"hex")).digest("hex"),"hex");return{tx:T,txHash:(0,c.sha256)().update(x).digest("hex"),changeRecipient:i,sigs:y}}if("ETH"===t){var P=(0,m.parseDER)(a.slice(s,s+2+a[s+1]));s+=74;var I=a.slice(s,s+20),M=f.default.buildEthRawTx(r,P,I),C=M.rawTx,L=M.sigWithV;return{tx:"0x".concat(C),txHash:"0x".concat(f.default.hashTransaction(C)),sig:{v:L.v,r:L.r.toString("hex"),s:L.s.toString("hex")},signer:I}}if("ETH_MSG"===t){P=(0,m.parseDER)(a.slice(s,s+2+a[s+1]));s+=74;var N=a.slice(s,s+20),B=f.default.validateEthereumMsgResponse({signer:N,sig:P},r);return{sig:{v:B.v,r:B.r.toString("hex"),s:B.s.toString("hex")},signer:N}}return(0,p.parseGenericSigningResponse)(a,s,r.curveType,r.omitPubkey)},e.prototype._resetActiveWallets=function(){this.activeWallets.internal.uid=g,this.activeWallets.internal.name=null,this.activeWallets.internal.capabilities=null,this.activeWallets.external.uid=g,this.activeWallets.external.name=null,this.activeWallets.external.capabilities=null},e.prototype._replaceWalletUID=function(e,t){var r=this.getActiveWallet();return r?"GET_ADDRESSES"===e?(r.uid.copy(t,0),t):"SIGN_TRANSACTION"===e?(r.uid.copy(t,2),t):null:null},e.prototype._packStateData=function(){try{var e={activeWallets:{internal:{uid:this.activeWallets.internal.uid.toString("hex"),name:this.activeWallets.internal.name.toString(),capabilities:this.activeWallets.internal.capabilities},external:{uid:this.activeWallets.external.uid.toString("hex"),name:this.activeWallets.external.name.toString(),capabilities:this.activeWallets.external.capabilities}},ephemeralPub:this.ephemeralPub.getPublic().encode("hex"),fwVersion:this.fwVersion.toString("hex"),deviceId:this.deviceId,name:this.name,baseUrl:this.baseUrl,privKey:this.privKey.toString("hex"),retryCount:this.retryCount,timeout:this.timeout};return JSON.stringify(e)}catch(e){return console.warn("Could not pack state data."),null}},e.prototype._unpackAndApplyStateData=function(e){try{var t=JSON.parse(e),r={uid:o.Buffer.from(t.activeWallets.internal.uid,"hex"),name:o.Buffer.from(t.activeWallets.internal.name),capabilities:t.activeWallets.internal.capabilities,external:!1},n={uid:o.Buffer.from(t.activeWallets.external.uid,"hex"),name:o.Buffer.from(t.activeWallets.external.name),capabilities:t.activeWallets.external.capabilities,external:!0},i=o.Buffer.from(t.ephemeralPub,"hex"),s=o.Buffer.from(t.fwVersion,"hex"),a=o.Buffer.from(t.privKey,"hex");this.activeWallets.internal=r,this.activeWallets.external=n,this.ephemeralPub=(0,m.getP256KeyPairFromPub)(i),this.fwVersion=s,this.deviceId=t.deviceId,this.name=t.name,this.baseUrl=t.baseUrl,this.privKey=a,this.key=(0,m.getP256KeyPair)(this.privKey),this.retryCount=t.retryCount,this.timeout=t.timeout}catch(e){console.warn("Could not apply state data.")}},e.prototype._fwVersionGTE=function(e,t,r){var n=this.getFwVersion(),i=n.major,s=n.minor,o=n.fix;return i>e||i>=e&&s>t||i>=e&&s>=t&&o>=r},e.prototype.getActiveWallet=function(){return g.equals(this.activeWallets.external.uid)?g.equals(this.activeWallets.internal.uid)?null:this.activeWallets.internal:this.activeWallets.external},e.prototype.hasActiveWallet=function(){return null!==this.getActiveWallet()},e.prototype.pubKeyBytes=function(e){void 0===e&&(e=!1);var t=this.key.getPublic().encode("hex"),r=o.Buffer.from(t,"hex");if(!0===e){var n=r.slice(1,33).reverse(),i=r.slice(33,65).reverse();return o.Buffer.concat([r[0],n,i])}return r},e.prototype.parseAbi=function(e,t,r){return void 0===r&&(r=!1),"etherscan"===e?d.abiParsers[e](t,r):{err:"No ".concat(e," parser available.")}},e}();r.Client=y}}},{package:"gridplus-sdk",file:"/home/gudahtt/projects/metamask-extension/node_modules/gridplus-sdk/dist/client.js"}],[4323,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.ETH_ABI_LATTICE_FW_TYPE_MAP=r.MAX_CHAIN_ID_BYTES=r.HANDLE_LARGER_CHAIN_ID=r.HARDENED_OFFSET=r.VERSION_BYTE=r.REQUEST_TYPE_BYTE=r.signingSchema=r.responseMsgs=r.responseCodes=r.messageConstants=r.ethMsgProtocol=r.encReqCodes=r.deviceCodes=r.decResLengths=r.addressSizes=r.ENC_MSG_LEN=r.BASE_URL=r.BIP_CONSTANTS=r.AES_IV=r.ADDR_STR_LEN=r.getFwVersionConst=r.ASCII_REGEX=r.EXTERNAL=void 0;r.AES_IV=[109,121,115,101,99,114,101,116,112,97,115,115,119,111,114,100];r.ADDR_STR_LEN=129;var s={empty:0,getAddresses:1290,sign:1090,getWallets:142,addAbiDefs:8,getKvRecords:1395,getAbiRecords:1215,removeAbiRecords:1,test:1646};r.decResLengths=s;var o=0;r.ENC_MSG_LEN=o,Object.keys(s).forEach((function(e){s[e]+82>o&&(r.ENC_MSG_LEN=o=s[e]+82)}));r.deviceCodes={CONNECT:1,ENCRYPTED_REQUEST:2};r.encReqCodes={FINALIZE_PAIRING:0,GET_ADDRESSES:1,ADD_PERMISSION:2,SIGN_TRANSACTION:3,GET_WALLETS:4,ADD_PERMISSION_V0:5,ADD_ABI_DEFS:6,GET_KV_RECORDS:7,ADD_KV_RECORDS:8,REMOVE_KV_RECORDS:9,GET_ABI_RECORDS:10,REMOVE_ABI_RECORDS:11,TEST:12};r.messageConstants={NOT_PAIRED:0,PAIRED:1};r.addressSizes={BTC:20,ETH:20};var a={RESP_SUCCESS:0,RESP_ERR_INVALID_MSG:128,RESP_ERR_UNSUPPORTED_VER:129,RESP_ERR_DEV_BUSY:130,RESP_ERR_USER_TIMEOUT:131,RESP_ERR_USER_DECLINED:132,RESP_ERR_PAIR_FAIL:133,RESP_ERR_PAIR_DISABLED:134,RESP_ERR_PERMISSION_DISABLED:135,RESP_ERR_INTERNAL:136,RESP_ERR_GCE_TIMEOUT:137,RESP_ERR_WRONG_WALLET:138,RESP_ERR_DEV_LOCKED:139,RESP_ERR_DISABLED:140,RESP_ERR_ALREADY:141,RESP_ERR_INVALID_EPHEM_ID:142};r.responseCodes=a;var u=((n={})[a.RESP_SUCCESS]=0,n[a.RESP_ERR_INVALID_MSG]="Invalid request",n[a.RESP_ERR_UNSUPPORTED_VER]="Unsupported version",n[a.RESP_ERR_DEV_BUSY]="Device busy",n[a.RESP_ERR_USER_TIMEOUT]="Timeout waiting for user",n[a.RESP_ERR_USER_DECLINED]="Request declined by user",n[a.RESP_ERR_PAIR_FAIL]="Pairing failed",n[a.RESP_ERR_PAIR_DISABLED]="Pairing is currently disabled",n[a.RESP_ERR_PERMISSION_DISABLED]="Automated signing is currently disabled",n[a.RESP_ERR_INTERNAL]="Device error",n[a.RESP_ERR_GCE_TIMEOUT]="Timeout",n[a.RESP_ERR_WRONG_WALLET]="Active wallet does not match request",n[a.RESP_ERR_DEV_LOCKED]="Device locked",n[a.RESP_ERR_DISABLED]="Disabled",n[a.RESP_ERR_ALREADY]="Record already exists. You must first remove it on your device.",n[a.RESP_ERR_INVALID_EPHEM_ID]="Could not find requester. Please reconnect.",n);r.responseMsgs=u;r.signingSchema={BTC_TRANSFER:0,ETH_TRANSFER:1,ERC20_TRANSFER:2,ETH_MSG:3,EXTRA_DATA:4,GENERAL_SIGNING:5};var c=2147483648;r.HARDENED_OFFSET=c;var h={PURPOSES:{ETH:2147483692,BTC_LEGACY:2147483692,BTC_WRAPPED_SEGWIT:2147483697,BTC_SEGWIT:2147483732},COINS:{ETH:2147483708,BTC:c,BTC_TESTNET:2147483649}};r.BIP_CONSTANTS=h;r.REQUEST_TYPE_BYTE=2;r.VERSION_BYTE=1;r.HANDLE_LARGER_CHAIN_ID=255;r.MAX_CHAIN_ID_BYTES=8;r.BASE_URL="https://signing.gridpl.us";var l={address:1,bool:2,uint8:3,uint16:4,uint24:5,uint32:6,uint40:7,uint48:8,uint56:9,uint64:10,uint72:11,uint80:12,uint88:13,uint96:14,uint104:15,uint112:16,uint120:17,uint128:18,uint136:19,uint144:20,uint152:21,uint160:22,uint168:23,uint176:24,uint184:25,uint192:26,uint200:27,uint208:28,uint216:29,uint224:30,uint232:31,uint240:32,uint248:33,uint256:34,int8:35,int16:36,int24:37,int32:38,int40:39,int48:40,int56:41,int64:42,int72:43,int80:44,int88:45,int96:46,int104:47,int112:48,int120:49,int128:50,int136:51,int144:52,int152:53,int160:54,int168:55,int176:56,int184:57,int192:58,int200:59,int208:60,int216:61,int224:62,int232:63,int240:64,int248:65,int256:66,uint:67,bytes1:69,bytes2:70,bytes3:71,bytes4:72,bytes5:73,bytes6:74,bytes7:75,bytes8:76,bytes9:77,bytes10:78,bytes11:79,bytes12:80,bytes13:81,bytes14:82,bytes15:83,bytes16:84,bytes17:85,bytes18:86,bytes19:87,bytes20:88,bytes21:89,bytes22:90,bytes23:91,bytes24:92,bytes25:93,bytes26:94,bytes27:95,bytes28:96,bytes29:97,bytes30:98,bytes31:99,bytes32:100,bytes:101,string:102},f=i(i({},l),{tuple1:103,tuple2:104,tuple3:105,tuple4:106,tuple5:107,tuple6:108,tuple7:109,tuple8:110,tuple9:111,tuple10:112,tuple11:113,tuple12:114,tuple13:115,tuple14:116,tuple15:117,tuple16:118,tuple17:119});r.ETH_ABI_LATTICE_FW_TYPE_MAP=f;var d={SIGN_PERSONAL:{str:"signPersonal",enumIdx:0},TYPED_DATA:{str:"typedData",enumIdx:1,rawDataMaxLen:1629,typeCodes:l}};r.ethMsgProtocol=d,r.EXTERNAL={GET_ADDR_FLAGS:{SECP256K1_PUB:3,ED25519_PUB:4},SIGNING:{HASHES:{NONE:0,KECCAK256:1,SHA256:2},CURVES:{SECP256K1:0,ED25519:1},ENCODINGS:{NONE:1,SOLANA:2,TERRA:3,EVM:4}}},r.getFwVersionConst=function(e){var t={extraDataFrameSz:0,extraDataMaxFrames:0,genericSigning:{}};function n(e,t){return e[2]>t[0]||e[2]===t[0]&&e[1]>t[1]||e[2]===t[0]&&e[1]===t[1]&&e[0]>t[2]||e[2]===t[0]&&e[1]===t[1]&&e[0]===t[2]}var i=0===e.length;return!i&&n(e,[0,10,4])||!i&&n(e,[0,10,0])?(t.reqMaxDataSz=1678,t.ethMaxGasPrice=2e13,t.addrFlagsAllowed=!0):(t.reqMaxDataSz=1152,t.ethMaxGasPrice=5e11,t.addrFlagsAllowed=!1),t.ethMaxDataSz=t.reqMaxDataSz-128,t.ethMaxMsgSz=t.ethMaxDataSz,t.eip712MaxTypeParams=18,!i&&n(e,[0,10,4])&&(t.extraDataFrameSz=1500,t.extraDataMaxFrames=1),!i&&n(e,[0,10,5])&&(t.varAddrPathSzAllowed=!0,t.eip712Supported=!0),!i&&n(e,[0,10,8])&&(t.prehashAllowed=!0),!i&&n(e,[0,10,10])&&(t.ethMsgPreHashAllowed=!0),!i&&n(e,[0,11,0])&&(t.allowedEthTxTypes=[1,2],t.ethMaxDataSz-=10,t.ethMaxMsgSz=t.ethMaxDataSz),!i&&n(e,[0,11,2])&&(t.personalSignHeaderSz=72),!i&&n(e,[0,12,0])&&(t.kvActionsAllowed=!0,t.kvKeyMaxStrSz=63,t.kvValMaxStrSz=63,t.kvActionMaxNum=10,t.kvRemoveMaxNum=100),!i&&n(e,[0,13,0])&&(t.allowBtcLegacyAndSegwitAddrs=!0,t.contractDeployKey="0x08002e0fec8e6acf00835f43c9764f7364fa3f42"),!i&&n(e,[0,14,0])&&(t.abiCategorySz=32,t.abiMaxRmv=200,t.genericSigning.baseReqSz=1552,t.genericSigning.baseDataSz=1519,t.genericSigning.hashTypes=r.EXTERNAL.SIGNING.HASHES,t.genericSigning.curveTypes=r.EXTERNAL.SIGNING.CURVES,t.genericSigning.encodingTypes={NONE:r.EXTERNAL.SIGNING.ENCODINGS.NONE,SOLANA:r.EXTERNAL.SIGNING.ENCODINGS.SOLANA},t.getAddressFlags=[r.EXTERNAL.GET_ADDR_FLAGS.ED25519_PUB,r.EXTERNAL.GET_ADDR_FLAGS.SECP256K1_PUB],t.eip712MaxTypeParams=36),!i&&n(e,[0,14,1])&&(t.genericSigning.encodingTypes.TERRA=r.EXTERNAL.SIGNING.ENCODINGS.TERRA),!i&&n(e,[0,15,0])&&(t.genericSigning.encodingTypes.EVM=r.EXTERNAL.SIGNING.ENCODINGS.EVM,t.ethMaxDataSz=1519),t};r.ASCII_REGEX=/^[\x00-\x7F]+$/}}},{package:"gridplus-sdk",file:"/home/gudahtt/projects/metamask-extension/node_modules/gridplus-sdk/dist/constants.js"}],[4324,{"./constants":4323,"./util":4328,"@ethereumjs/common":401,"@ethereumjs/tx":405,"bignumber.js":4330,borc:2044,"buffer/":2096,"eth-eip712-util-browser":2364,"js-sha3":4719,rlp:4331,"rlp-browser":5736,secp256k1:5750},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("bignumber.js")),u=o(e("borc")),c=e("buffer/"),h=e("eth-eip712-util-browser"),l=e("js-sha3"),f=o(e("rlp-browser")),d=e("rlp"),p=o(e("secp256k1")),m=e("./constants"),g=e("./util"),y=s(e("@ethereumjs/common")),v=e("@ethereumjs/tx");function w(e){for(var t=e[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e}function b(e,t,r,n){void 0===n&&(n={});try{var i=new Uint8Array(e),s=0,o=(0,g.fixLen)(t.r,32);t.r=o;var a=(0,g.fixLen)(t.s,32);t.s=a;var u=new Uint8Array(c.Buffer.concat([o,a])),h=p.default.ecdsaRecover(u,s,i,!1).slice(1);if(_(h)===r.toString("hex"))return t.v=E(s,n),t;if(s=1,_(h=p.default.ecdsaRecover(u,s,i,!1).slice(1))===r.toString("hex"))return t.v=E(s,n),t;throw new Error("Invalid Ethereum signature returned.")}catch(e){throw new Error(e)}}function _(e){return(0,l.keccak256)(e).slice(-40)}function E(e,t){void 0===t&&(t={});var r=t.chainId,n=t.useEIP155,i=t.type;if(1===i||2===i)return(0,g.ensureHexBuffer)(e,!0);if(!1===n||null===r)return c.Buffer.from(new a.default(e).plus(27).toString(16),"hex");var s=A(r),o=new a.default(s.toString("hex"),16);return(0,g.ensureHexBuffer)("0x".concat(o.times(2).plus(35).plus(e).toString(16)))}var k={mainnet:1,roptsten:3,rinkeby:4,kovan:42,goerli:5};function A(e){var t,r;if((t=!0===T(e)?(0,g.ensureHexBuffer)(e):(0,g.ensureHexBuffer)("0x".concat(new a.default(e).toString(16)))).length>8)throw new Error("ChainID provided is too large.");return t.length<=2||4===t.length||8===t.length?t:(3===t.length?(r=c.Buffer.alloc(4)).writeUInt32BE(e):t.length<=8&&(r=c.Buffer.alloc(8),t.copy(r,8-t.length)),r)}function T(e){if("string"!=typeof e)return!1;if("0x"!==e.slice(0,2))return!1;try{return!1===new a.default(e,16).isNaN()}catch(e){return!1}}function S(e,t){var r=t.fwConstants,n=r.ethMaxMsgSz,i=r.extraDataFrameSz,s=r.extraDataMaxFrames,o=n,a=i>0&&s>0,u=[];if(e.length>o){var h=o+s*i;if(!a)throw new Error("Your message is ".concat(e.length," bytes, but can only be a maximum of ").concat(o));if(a&&e.length>h)throw new Error("Your message is ".concat(e.length," bytes, but can only be a maximum of ").concat(h));(0,g.splitFrames)(e.slice(o),i).forEach((function(e){var t=c.Buffer.alloc(4);t.writeUInt32LE(e.length,0),u.push(c.Buffer.concat([t,e]))}))}return u}function x(e,t,r,n){void 0===n&&(n=!1);try{r[t].forEach((function(t){var i=t.type.indexOf("[")>-1,s=i?t.type.slice(0,t.type.indexOf("[")):t.type,o=Object.keys(r).indexOf(s)>-1;if(o&&Array.isArray(e))for(var a=0;a<e.length;a++)e[a][t.name]=x(e[a][t.name],s,r,n);else if(o)e[t.name]=x(e[t.name],s,r,n);else if(Array.isArray(e))for(a=0;a<e.length;a++)if(i)for(var u=0;u<e[a][t.name].length;u++)e[a][t.name][u]=P(e[a][t.name][u],s,n);else e[a][t.name]=P(e[a][t.name],s,n);else if(i)for(a=0;a<e[t.name].length;a++)e[t.name][a]=P(e[t.name][a],s,n);else e[t.name]=P(e[t.name],s,n)}))}catch(e){throw new Error(e.message)}return e}function P(e,t,r){if(void 0===r&&(r=!1),"bytes"===t)e=(0,g.ensureHexBuffer)(e),r&&(e="0x".concat(e.toString("hex")));else if("bytes"===t.slice(0,5)){var n=parseInt(t.slice(5));if((e=(0,g.ensureHexBuffer)(e)).length!==n)throw new Error("Expected ".concat(t," type, but got ").concat(e.length," bytes"));r&&(e="0x".concat(e.toString("hex")))}else if("address"===t){if(0===(e=(0,g.ensureHexBuffer)(e)).length&&(e=c.Buffer.alloc(20)),20!==e.length)throw new Error("Address type must be 20 bytes, but got ".concat(e.length," bytes"));r&&(e="0x".concat(e.toString("hex")))}else if(m.ethMsgProtocol.TYPED_DATA.typeCodes[t]&&(t.indexOf("uint")>-1||t.indexOf("int")>-1)){var i=(0,g.ensureHexBuffer)(e);0===i.length&&(i=c.Buffer.from("00","hex")),e=r?"0x".concat(i.toString("hex")):(new u.default.Encoder).semanticTypes[1][0](i.toString("hex"),16)}else"bool"===t&&(e=!0===e?1:0);return e}function I(e){return c.Buffer.from("Ethereum Signed Message:\n".concat(e.toString()),"utf-8")}function M(e,t){return t?c.Buffer.concat([c.Buffer.from([t]),f.default.encode(e)]):f.default.encode(e)}r.default={buildEthereumMsgRequest:function(e){if(!e.payload||!e.protocol||!e.signerPath)throw new Error("You must provide `payload`, `signerPath`, and `protocol` arguments in the messsage request");if(e.signerPath.length>5||e.signerPath.length<2)throw new Error("Please provide a signer path with 2-5 indices");var t={schema:m.signingSchema.ETH_MSG,payload:null,input:e,msg:null};try{switch(e.protocol){case"signPersonal":return function(e,t){var r=t.fwConstants.ethMaxMsgSz,n=t.fwConstants.varAddrPathSzAllowed,i=24+r+4,s=0;e.payload=c.Buffer.alloc(i),e.payload.writeUInt8(m.ethMsgProtocol.SIGN_PERSONAL,0),s+=1;var o=(0,g.buildSignerPathBuf)(t.signerPath,n);o.copy(e.payload,s),s+=o.length;var a=t.payload,u=!1;if("string"==typeof t.payload)if("0x"===t.payload.slice(0,2))a=(0,g.ensureHexBuffer)(t.payload),u=!1===m.ASCII_REGEX.test(c.Buffer.from(t.payload.slice(2),"hex").toString());else{if(!1===(0,g.isAsciiStr)(t.payload))throw new Error("Currently, the Lattice can only display ASCII strings.");a=c.Buffer.from(t.payload)}else if("boolean"==typeof t.displayHex)u=t.displayHex;else{if(!t.payload.toString)throw new Error("Unsupported input data type");u=!1===m.ASCII_REGEX.test(t.payload.toString())}var h=t.fwConstants,f=r+h.extraDataMaxFrames*h.extraDataFrameSz;h.personalSignHeaderSz&&(f-=h.personalSignHeaderSz);if(h.ethMsgPreHashAllowed&&a.length>f){e.payload.writeUInt8(u,s),s+=1,e.payload.writeUInt16LE(a.length,s),s+=2;var d=c.Buffer.from((0,l.keccak256)(c.Buffer.concat([I(a.length),a])),"hex");d.copy(e.payload,s),e.prehash=d}else{var p=S(a,t);e.extraDataPayloads=p,e.msg=a,e.payload.writeUInt8(u,s),s+=1,e.payload.writeUInt16LE(a.length,s),s+=2,a.copy(e.payload,s)}return e}(t,e);case"eip712":if(!e.fwConstants.eip712Supported)throw new Error("EIP712 is not supported by your Lattice firmware version. Please upgrade.");return function(e,t){try{var r=t.fwConstants,n=r.ethMaxMsgSz,i=r.varAddrPathSzAllowed,s=r.eip712MaxTypeParams,o=m.ethMsgProtocol.TYPED_DATA,a=24+n+4,l=0;e.payload=c.Buffer.alloc(a),e.payload.writeUInt8(o.enumIdx,0),l+=1;var f=(0,g.buildSignerPathBuf)(t.signerPath,i);f.copy(e.payload,l),l+=f.length;var d=JSON.parse(JSON.stringify(t.payload));if(!d.primaryType||!d.types[d.primaryType])throw new Error("primaryType must be specified and the type must be included.");if(!d.message||!d.domain)throw new Error("message and domain must be specified.");if(0>Object.keys(d.types).indexOf("EIP712Domain"))throw new Error("EIP712Domain type must be defined.");t.payload.message=x(JSON.parse(JSON.stringify(d.message)),JSON.parse(JSON.stringify(d.primaryType)),JSON.parse(JSON.stringify(d.types)),!0),t.payload.domain=x(JSON.parse(JSON.stringify(d.domain)),"EIP712Domain",JSON.parse(JSON.stringify(d.types)),!0),d.domain=x(d.domain,"EIP712Domain",d.types,!1),d.message=x(d.message,d.primaryType,d.types,!1);var p=c.Buffer.from(u.default.encode(d)),y=t.fwConstants,v=n+y.extraDataMaxFrames*y.extraDataFrameSz,w=p.length>v;if(Object.keys(d.types).forEach((function(e){d.types[e].length>s&&(w=!0)})),y.ethMsgPreHashAllowed&&w){e.payload.writeUInt16LE(p.length,l),l+=2;var b=h.TypedDataUtils.hash(e.input.payload);b.copy(e.payload,l),e.prehash=b}else{var _=S(p,t);e.extraDataPayloads=_,e.payload.writeUInt16LE(p.length,l),l+=2,p.copy(e.payload,l),l+=p.length,e.payload=e.payload.slice(0,l)}return e}catch(e){return{err:"Failed to build EIP712 request: ".concat(e.message)}}}(t,e);default:throw new Error("Unsupported protocol")}}catch(e){return{err:e.toString()}}},validateEthereumMsgResponse:function(e,t){var r=e.signer,n=e.sig,i=t.input,s=t.msg,o=t.prehash,a=void 0===o?null:o;if("signPersonal"===i.protocol)return b(a||c.Buffer.from((0,l.keccak256)(c.Buffer.concat([I(s.length),s])),"hex"),n,r,{chainId:1,useEIP155:!1});if("eip712"===i.protocol){var u=h.TypedDataUtils.hash(t.input.payload);return b(a||u,n,r,{useEIP155:!1})}throw new Error("Unsupported protocol")},buildEthereumTxRequest:function(e){try{var t=e.chainId,r=void 0===t?1:t,n=e.signerPath,i=e.eip155,s=void 0===i?null:i,o=e.fwConstants,a=e.type,u=void 0===a?null:a,h=o.contractDeployKey,f=o.extraDataFrameSz,d=o.extraDataMaxFrames,p=o.prehashAllowed,y=f>0&&d>0,v=o.ethMaxDataSz,w=o.varAddrPathSzAllowed;if("number"!=typeof r&&!1===T(r)&&(r=k[r]),!r)throw new Error("Unsupported chain ID or name");if(!n)throw new Error("`signerPath` not provided");if(null===e.to&&!h)throw new Error("Contract deployment not supported. Please update your Lattice firmware.");var b=null===e.to&&h,_=o.allowedEthTxTypes&&o.allowedEthTxTypes.indexOf(2)>-1,E=o.allowedEthTxTypes&&o.allowedEthTxTypes.indexOf(1)>-1,S=_&&(2===u||"eip1559"===u),x=E&&(1===u||"eip2930"===u);if(null!==u&&!S&&!x)throw new Error("Unsupported Ethereum transaction type");var P=function(e){switch(e){case 3:case 4:return!1;default:return!0}}(r);null!==s&&"boolean"==typeof s?P=s:(S||x)&&(P=!1),e.value||(e.value=0);var I=[],C=(0,g.ensureHexBuffer)(r),L=(0,g.ensureHexBuffer)(e.nonce),N=void 0,B=(0,g.ensureHexBuffer)(e.gasLimit),R=void 0,O=void 0;b?(R=c.Buffer.alloc(0),O=(0,g.ensureHexBuffer)(h)):(R=(0,g.ensureHexBuffer)(e.to),O=(0,g.ensureHexBuffer)(e.to));var j=(0,g.ensureHexBuffer)(e.value),D=(0,g.ensureHexBuffer)(e.data);(S||x)&&I.push(C),I.push(L);var U=void 0,F=void 0;if(S){if(!e.maxPriorityFeePerGas)throw new Error("EIP1559 transactions must include `maxPriorityFeePerGas`");U=(0,g.ensureHexBuffer)(e.maxPriorityFeePerGas),I.push(U),F=(0,g.ensureHexBuffer)(e.maxFeePerGas),I.push(F),N=F}else N=(0,g.ensureHexBuffer)(e.gasPrice),I.push(N);I.push(B),I.push(R),I.push(j),I.push(D);var K=!1;if(S||x){var V=[];Array.isArray(e.accessList)&&e.accessList.forEach((function(e){var t=[];e.storageKeys.forEach((function(e){t.push((0,g.ensureHexBuffer)(e))})),V.push([(0,g.ensureHexBuffer)(e.address),t]),K=!0})),I.push(V)}else!0===P&&(I.push(C),I.push((0,g.ensureHexBuffer)(null)),I.push((0,g.ensureHexBuffer)(null)));var G=c.Buffer.alloc(v+122),H=0;G.writeUInt8(Number(P),H),H++;var Y=void 0,q=0;if(!0==(1!==(re=A(r)).length||255===re.readUInt8(0))){if((q=(Y=A(r)).length)>m.MAX_CHAIN_ID_BYTES)throw new Error("ChainID provided is too large.");G.writeUInt8(m.HANDLE_LARGER_CHAIN_ID,H),H++}else{if(1!==(Y=(0,g.ensureHexBuffer)(r)).length)throw new Error("Error parsing chainID");Y.copy(G,H),H+=Y.length}var z=(0,g.buildSignerPathBuf)(n,w);if(z.copy(G,H),H+=z.length,L.length>4)throw new Error("Nonce too large");if(L.copy(G,H+(4-L.length)),H+=4,N.length>8)throw new Error("Gas price too large");if(N.copy(G,H+(8-N.length)),H+=8,B.length>4)throw new Error("Gas limit too large");if(B.copy(G,H+(4-B.length)),H+=4,20!==O.length)throw new Error("Invalid `to` address");if(O.copy(G,H),H+=20,j.length>32)throw new Error("Value too large");j.copy(G,H+(32-j.length)),H+=32;var W=!1;if(o.allowedEthTxTypes)if(K&&(W=!0),G.writeUInt8(W?1:0,H),H+=1,S){if(G.writeUInt8(2,H),H+=1,U.length>8)throw new Error("maxPriorityFeePerGasBytes too large");U.copy(G,H+(8-U.length)),H+=8}else x?(G.writeUInt8(1,H),H+=1,H+=8):H+=9;var $=[],Z=null,J=D.length||0,Q=q>0?q+1:0,X=c.Buffer.alloc(J+Q);if(Q>0&&(X.writeUInt8(q,0),Y.copy(X,1)),D.copy(X,Q),J>v){var ee=J+Q,te=v+d*f;if(p&&ee>te)Z=c.Buffer.from((0,l.keccak256)(M(I,u)),"hex");else{if(!y||y&&ee>te)throw new Error("Data field too large (got ".concat(D.length,"; must be <=").concat(te-Q," bytes)"));(0,g.splitFrames)(X.slice(v),f).forEach((function(e){var t=c.Buffer.alloc(4);t.writeUInt32LE(e.length,0),$.push(c.Buffer.concat([t,e]))}))}}else W&&(Z=c.Buffer.from((0,l.keccak256)(M(I,u)),"hex"));return G.writeUInt16BE(D.length,H),H+=2,q>0&&(G.writeUInt8(q,H),H++,Y.copy(G,H),H+=q),Z?(Z.copy(G,H),H+=v):(D.slice(0,v).copy(G,H),H+=v),{rawTx:I,type:u,payload:G.slice(0,H),extraDataPayloads:$,schema:m.signingSchema.ETH_TRANSFER,chainId:r,useEIP155:P,signerPath:n}}catch(e){return{err:e.message}}var re},buildEthRawTx:function(e,t,r){var n=b(c.Buffer.from((0,l.keccak256)(M(e.rawTx,e.type)),"hex"),t,r,e),i=e.useEIP155?e.rawTx.slice(0,-3):e.rawTx;i.push(n.v),i.push(w(n.r)),i.push(w(n.s));var s=f.default.encode(i);return e.type&&(s=c.Buffer.concat([c.Buffer.from([e.type]),s])),{rawTx:s.toString("hex"),sigWithV:n}},hashTransaction:function(e){return(0,l.keccak256)(c.Buffer.from(e,"hex"))},chainIds:k,ensureHexBuffer:g.ensureHexBuffer,ethConvertLegacyToGenericReq:function(e){var t;t=e.chainId&&"01"!==(0,g.ensureHexBuffer)(e.chainId).toString("hex")?y.default.custom({chainId:e.chainId},{hardfork:y.Hardfork.London,eips:[1559,2930]}):new y.default({chain:y.Chain.Mainnet,hardfork:y.Hardfork.London});var r=v.TransactionFactory.fromTxData(e,{common:t});return e.type?r.getMessageToSign(!1):c.Buffer.from((0,d.encode)(r.getMessageToSign(!1)))}}}}},{package:"gridplus-sdk",file:"/home/gudahtt/projects/metamask-extension/node_modules/gridplus-sdk/dist/ethereum.js"}]],[],{});